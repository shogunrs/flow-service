import{x as h,a7 as p}from"./CPKTtwfv.js";import{u as A,a as g}from"./B74M8xGS.js";function i(){const e=p()?.public?.FLOW_API_BASE||"";return String(e||"")}function E(){return!!i()}async function y(t,e={}){const n=i();if(!n)throw new Error("FLOW_API_BASE not set");const r=t.startsWith("http")?t:`${n.replace(/\/$/,"")}${t.startsWith("/")?"":"/"}${t}`,{inc:u,dec:f}=A();u();try{return await $fetch(r,e)}catch(o){try{const s=(e?.method||"GET").toString().toUpperCase(),l=s!=="GET",a=g("api-last-error-toast",()=>0),c=Date.now();if(l&&c-a.value>2e3){a.value=c;const{error:m}=h();console.warn("[Flow] API error for",s,r,o?.message||o),m("Falha de conex√£o com a API. Tente novamente.")}}catch{}throw o}finally{f()}}export{y as apiFetch,i as getApiBase,E as isApiEnabled};
