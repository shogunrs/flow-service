const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./Dbx-Jqc8.js","./CPKTtwfv.js","./entry.CkufVRed.css","./B74M8xGS.js"])))=>i.map(i=>d[i]);
import{q as K,r as oe,H as Te,h as Oe,i as at,c as B,o as j,a as O,t as J,m as ee,C as _e,d as te,F as nt,j as st,B as ie}from"./CPKTtwfv.js";function it(){const l=async(b,w,A)=>{try{const{apiFetch:C}=await K(async()=>{const{apiFetch:I}=await import("./Dbx-Jqc8.js");return{apiFetch:I}},__vite__mapDeps([0,1,2,3]),import.meta.url),M=await C(`/api/v1/users/${b}/files/upload-url`,{method:"POST",body:{filename:w.name,contentType:w.type,fileType:A}});if(!M.success)throw new Error(M.error||"Erro ao obter URL de upload");const U=M.data.uploadUrl,R=M.data.objectKey,H=M.data.publicUrl;if(!(await fetch(U,{method:"PUT",body:w,headers:{"Content-Type":w.type}})).ok)throw new Error("Erro durante upload do arquivo");return await a(b,{objectKey:R,publicUrl:H,filename:w.name,fileType:A,contentType:w.type,fileSize:w.size,isMobileUpload:!1,location:await d()}),{objectKey:R,publicUrl:H,filename:w.name,fileType:A}}catch(C){throw console.error("Upload error:",C),C}},c=async(b,w)=>{try{const{apiFetch:A}=await K(async()=>{const{apiFetch:M}=await import("./Dbx-Jqc8.js");return{apiFetch:M}},__vite__mapDeps([0,1,2,3]),import.meta.url),C=await A(`/api/v1/users/${b}/files/${w}/download-url`);if(!C.success)throw new Error(C.error||"Erro ao obter URL de download");return C.data.downloadUrl}catch(A){throw console.error("Download URL error:",A),A}},a=async(b,w)=>{try{const{apiFetch:A}=await K(async()=>{const{apiFetch:M}=await import("./Dbx-Jqc8.js");return{apiFetch:M}},__vite__mapDeps([0,1,2,3]),import.meta.url),C=await A(`/api/v1/users/${b}/files/confirm-upload`,{method:"POST",body:w});if(!C.success)throw new Error(C.error||"Erro ao confirmar upload")}catch(A){throw console.error("Confirm upload error:",A),A}},d=async()=>new Promise(b=>{"geolocation"in navigator?navigator.geolocation.getCurrentPosition(w=>{const{latitude:A,longitude:C}=w.coords;b(`${A},${C}`)},w=>{console.warn("Geolocation error:",w),b(null)},{timeout:5e3,enableHighAccuracy:!1}):b(null)});return{uploadUserFile:l,getDownloadUrl:c,confirmFileUpload:a,getCurrentLocation:d,getUserFiles:async b=>{try{const{apiFetch:w}=await K(async()=>{const{apiFetch:C}=await import("./Dbx-Jqc8.js");return{apiFetch:C}},__vite__mapDeps([0,1,2,3]),import.meta.url),A=await w(`/api/v1/users/${b}/files`);if(!A.success)throw new Error(A.error||"Erro ao buscar arquivos do usuÃ¡rio");return A.data}catch(w){throw console.error("Get user files error:",w),w}},getUserFileByType:async(b,w)=>{try{const{apiFetch:A}=await K(async()=>{const{apiFetch:M}=await import("./Dbx-Jqc8.js");return{apiFetch:M}},__vite__mapDeps([0,1,2,3]),import.meta.url),C=await A(`/api/v1/users/${b}/files/${w}`);return C.success?C.data:null}catch(A){return console.error("Get user file by type error:",A),null}}}}function ct(l){return l&&l.__esModule&&Object.prototype.hasOwnProperty.call(l,"default")?l.default:l}var ce={exports:{}},Ne;function lt(){return Ne||(Ne=1,(function(l){var c=(function(a){var d=Object.prototype,f=d.hasOwnProperty,h=Object.defineProperty||function(e,r,s){e[r]=s.value},b,w=typeof Symbol=="function"?Symbol:{},A=w.iterator||"@@iterator",C=w.asyncIterator||"@@asyncIterator",M=w.toStringTag||"@@toStringTag";function U(e,r,s){return Object.defineProperty(e,r,{value:s,enumerable:!0,configurable:!0,writable:!0}),e[r]}try{U({},"")}catch{U=function(r,s,S){return r[s]=S}}function R(e,r,s,S){var g=r&&r.prototype instanceof o?r:o,_=Object.create(g.prototype),z=new p(S||[]);return h(_,"_invoke",{value:F(e,s,z)}),_}a.wrap=R;function H(e,r,s){try{return{type:"normal",arg:e.call(r,s)}}catch(S){return{type:"throw",arg:S}}}var re="suspendedStart",I="suspendedYield",G="executing",Y="completed",m={};function o(){}function n(){}function t(){}var y={};U(y,A,function(){return this});var L=Object.getPrototypeOf,x=L&&L(L(u([])));x&&x!==d&&f.call(x,A)&&(y=x);var N=t.prototype=o.prototype=Object.create(y);n.prototype=t,h(N,"constructor",{value:t,configurable:!0}),h(t,"constructor",{value:n,configurable:!0}),n.displayName=U(t,M,"GeneratorFunction");function P(e){["next","throw","return"].forEach(function(r){U(e,r,function(s){return this._invoke(r,s)})})}a.isGeneratorFunction=function(e){var r=typeof e=="function"&&e.constructor;return r?r===n||(r.displayName||r.name)==="GeneratorFunction":!1},a.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,t):(e.__proto__=t,U(e,M,"GeneratorFunction")),e.prototype=Object.create(N),e},a.awrap=function(e){return{__await:e}};function v(e,r){function s(_,z,Z,V){var W=H(e[_],e,z);if(W.type==="throw")V(W.arg);else{var D=W.arg,T=D.value;return T&&typeof T=="object"&&f.call(T,"__await")?r.resolve(T.__await).then(function(q){s("next",q,Z,V)},function(q){s("throw",q,Z,V)}):r.resolve(T).then(function(q){D.value=q,Z(D)},function(q){return s("throw",q,Z,V)})}}var S;function g(_,z){function Z(){return new r(function(V,W){s(_,z,V,W)})}return S=S?S.then(Z,Z):Z()}h(this,"_invoke",{value:g})}P(v.prototype),U(v.prototype,C,function(){return this}),a.AsyncIterator=v,a.async=function(e,r,s,S,g){g===void 0&&(g=Promise);var _=new v(R(e,r,s,S),g);return a.isGeneratorFunction(r)?_:_.next().then(function(z){return z.done?z.value:_.next()})};function F(e,r,s){var S=re;return function(_,z){if(S===G)throw new Error("Generator is already running");if(S===Y){if(_==="throw")throw z;return k()}for(s.method=_,s.arg=z;;){var Z=s.delegate;if(Z){var V=$(Z,s);if(V){if(V===m)continue;return V}}if(s.method==="next")s.sent=s._sent=s.arg;else if(s.method==="throw"){if(S===re)throw S=Y,s.arg;s.dispatchException(s.arg)}else s.method==="return"&&s.abrupt("return",s.arg);S=G;var W=H(e,r,s);if(W.type==="normal"){if(S=s.done?Y:I,W.arg===m)continue;return{value:W.arg,done:s.done}}else W.type==="throw"&&(S=Y,s.method="throw",s.arg=W.arg)}}}function $(e,r){var s=r.method,S=e.iterator[s];if(S===b)return r.delegate=null,s==="throw"&&e.iterator.return&&(r.method="return",r.arg=b,$(e,r),r.method==="throw")||s!=="return"&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+s+"' method")),m;var g=H(S,e.iterator,r.arg);if(g.type==="throw")return r.method="throw",r.arg=g.arg,r.delegate=null,m;var _=g.arg;if(!_)return r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m;if(_.done)r[e.resultName]=_.value,r.next=e.nextLoc,r.method!=="return"&&(r.method="next",r.arg=b);else return _;return r.delegate=null,m}P(N),U(N,M,"Generator"),U(N,A,function(){return this}),U(N,"toString",function(){return"[object Generator]"});function E(e){var r={tryLoc:e[0]};1 in e&&(r.catchLoc=e[1]),2 in e&&(r.finallyLoc=e[2],r.afterLoc=e[3]),this.tryEntries.push(r)}function i(e){var r=e.completion||{};r.type="normal",delete r.arg,e.completion=r}function p(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(E,this),this.reset(!0)}a.keys=function(e){var r=Object(e),s=[];for(var S in r)s.push(S);return s.reverse(),function g(){for(;s.length;){var _=s.pop();if(_ in r)return g.value=_,g.done=!1,g}return g.done=!0,g}};function u(e){if(e){var r=e[A];if(r)return r.call(e);if(typeof e.next=="function")return e;if(!isNaN(e.length)){var s=-1,S=function g(){for(;++s<e.length;)if(f.call(e,s))return g.value=e[s],g.done=!1,g;return g.value=b,g.done=!0,g};return S.next=S}}return{next:k}}a.values=u;function k(){return{value:b,done:!0}}return p.prototype={constructor:p,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=b,this.done=!1,this.delegate=null,this.method="next",this.arg=b,this.tryEntries.forEach(i),!e)for(var r in this)r.charAt(0)==="t"&&f.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=b)},stop:function(){this.done=!0;var e=this.tryEntries[0],r=e.completion;if(r.type==="throw")throw r.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function s(V,W){return _.type="throw",_.arg=e,r.next=V,W&&(r.method="next",r.arg=b),!!W}for(var S=this.tryEntries.length-1;S>=0;--S){var g=this.tryEntries[S],_=g.completion;if(g.tryLoc==="root")return s("end");if(g.tryLoc<=this.prev){var z=f.call(g,"catchLoc"),Z=f.call(g,"finallyLoc");if(z&&Z){if(this.prev<g.catchLoc)return s(g.catchLoc,!0);if(this.prev<g.finallyLoc)return s(g.finallyLoc)}else if(z){if(this.prev<g.catchLoc)return s(g.catchLoc,!0)}else if(Z){if(this.prev<g.finallyLoc)return s(g.finallyLoc)}else throw new Error("try statement without catch or finally")}}},abrupt:function(e,r){for(var s=this.tryEntries.length-1;s>=0;--s){var S=this.tryEntries[s];if(S.tryLoc<=this.prev&&f.call(S,"finallyLoc")&&this.prev<S.finallyLoc){var g=S;break}}g&&(e==="break"||e==="continue")&&g.tryLoc<=r&&r<=g.finallyLoc&&(g=null);var _=g?g.completion:{};return _.type=e,_.arg=r,g?(this.method="next",this.next=g.finallyLoc,m):this.complete(_)},complete:function(e,r){if(e.type==="throw")throw e.arg;return e.type==="break"||e.type==="continue"?this.next=e.arg:e.type==="return"?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):e.type==="normal"&&r&&(this.next=r),m},finish:function(e){for(var r=this.tryEntries.length-1;r>=0;--r){var s=this.tryEntries[r];if(s.finallyLoc===e)return this.complete(s.completion,s.afterLoc),i(s),m}},catch:function(e){for(var r=this.tryEntries.length-1;r>=0;--r){var s=this.tryEntries[r];if(s.tryLoc===e){var S=s.completion;if(S.type==="throw"){var g=S.arg;i(s)}return g}}throw new Error("illegal catch attempt")},delegateYield:function(e,r,s){return this.delegate={iterator:u(e),resultName:r,nextLoc:s},this.method==="next"&&(this.arg=b),m}},a})(l.exports);try{regeneratorRuntime=c}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=c:Function("r","regeneratorRuntime = r")(c)}})(ce)),ce.exports}var le,ke;function De(){return ke||(ke=1,le=(l,c)=>`${l}-${c}-${Math.random().toString(16).slice(3,8)}`),le}var de,Ie;function et(){if(Ie)return de;Ie=1;const l=De();let c=0;return de=({id:a,action:d,payload:f={}})=>{let h=a;return typeof h>"u"&&(h=l("Job",c),c+=1),{id:h,action:d,payload:f}},de}var ne={},Me;function Re(){if(Me)return ne;Me=1;let l=!1;return ne.logging=l,ne.setLogging=c=>{l=c},ne.log=(...c)=>l?console.log.apply(this,c):null,ne}var ue,Fe;function dt(){if(Fe)return ue;Fe=1;const l=et(),{log:c}=Re(),a=De();let d=0;return ue=()=>{const f=a("Scheduler",d),h={},b={};let w=[];d+=1;const A=()=>w.length,C=()=>Object.keys(h).length,M=()=>{if(w.length!==0){const I=Object.keys(h);for(let G=0;G<I.length;G+=1)if(typeof b[I[G]]>"u"){w[0](h[I[G]]);break}}},U=(I,G)=>new Promise((Y,m)=>{const o=l({action:I,payload:G});w.push(async n=>{w.shift(),b[n.id]=o;try{Y(await n[I].apply(this,[...G,o.id]))}catch(t){m(t)}finally{delete b[n.id],M()}}),c(`[${f}]: Add ${o.id} to JobQueue`),c(`[${f}]: JobQueue length=${w.length}`),M()});return{addWorker:I=>(h[I.id]=I,c(`[${f}]: Add ${I.id}`),c(`[${f}]: Number of workers=${C()}`),M(),I.id),addJob:async(I,...G)=>{if(C()===0)throw Error(`[${f}]: You need to have at least one worker before adding jobs`);return U(I,G)},terminate:async()=>{Object.keys(h).forEach(async I=>{await h[I].terminate()}),w=[]},getQueueLen:A,getNumWorkers:C}},ue}function ut(l){throw new Error('Could not dynamically require "'+l+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var fe,$e;function ft(){return $e||($e=1,fe=l=>{const c={};return typeof WorkerGlobalScope<"u"?c.type="webworker":typeof document=="object"?c.type="browser":typeof process=="object"&&typeof ut=="function"&&(c.type="node"),typeof l>"u"?c:c[l]}),fe}var pe,Ue;function pt(){if(Ue)return pe;Ue=1;const c=ft()("type")==="browser"?a=>new URL(a,window.location.href).href:a=>a;return pe=a=>{const d={...a};return["corePath","workerPath","langPath"].forEach(f=>{a[f]&&(d[f]=c(d[f]))}),d},pe}var me,qe;function tt(){return qe||(qe=1,me={TESSERACT_ONLY:0,LSTM_ONLY:1,TESSERACT_LSTM_COMBINED:2,DEFAULT:3}),me}const mt="6.0.1",ht={version:mt};var he,Ge;function gt(){return Ge||(Ge=1,he={workerBlobURL:!0,logger:()=>{}}),he}var ge,Be;function vt(){if(Be)return ge;Be=1;const l=ht.version;return ge={...gt(),workerPath:`https://cdn.jsdelivr.net/npm/tesseract.js@v${l}/dist/worker.min.js`},ge}var ve,je;function yt(){return je||(je=1,ve=({workerPath:l,workerBlobURL:c})=>{let a;if(Blob&&URL&&c){const d=new Blob([`importScripts("${l}");`],{type:"application/javascript"});a=new Worker(URL.createObjectURL(d))}else a=new Worker(l);return a}),ve}var ye,ze;function bt(){return ze||(ze=1,ye=l=>{l.terminate()}),ye}var be,Ze;function wt(){return Ze||(Ze=1,be=(l,c)=>{l.onmessage=({data:a})=>{c(a)}}),be}var we,Ve;function Et(){return Ve||(Ve=1,we=async(l,c)=>{l.postMessage(c)}),we}var Ee,We;function At(){if(We)return Ee;We=1;const l=a=>new Promise((d,f)=>{const h=new FileReader;h.onload=()=>{d(h.result)},h.onerror=({target:{error:{code:b}}})=>{f(Error(`File could not be read! Code=${b}`))},h.readAsArrayBuffer(a)}),c=async a=>{let d=a;if(typeof a>"u")return"undefined";if(typeof a=="string")/data:image\/([a-zA-Z]*);base64,([^"]*)/.test(a)?d=atob(a.split(",")[1]).split("").map(f=>f.charCodeAt(0)):d=await(await fetch(a)).arrayBuffer();else if(typeof HTMLElement<"u"&&a instanceof HTMLElement)a.tagName==="IMG"&&(d=await c(a.src)),a.tagName==="VIDEO"&&(d=await c(a.poster)),a.tagName==="CANVAS"&&await new Promise(f=>{a.toBlob(async h=>{d=await l(h),f()})});else if(typeof OffscreenCanvas<"u"&&a instanceof OffscreenCanvas){const f=await a.convertToBlob();d=await l(f)}else(a instanceof File||a instanceof Blob)&&(d=await l(a));return new Uint8Array(d)};return Ee=c,Ee}var Ae,He;function Lt(){if(He)return Ae;He=1;const l=vt(),c=yt(),a=bt(),d=wt(),f=Et(),h=At();return Ae={defaultOptions:l,spawnWorker:c,terminateWorker:a,onMessage:d,send:f,loadImage:h},Ae}var Le,Je;function ot(){if(Je)return Le;Je=1;const l=pt(),c=et(),{log:a}=Re(),d=De(),f=tt(),{defaultOptions:h,spawnWorker:b,terminateWorker:w,onMessage:A,loadImage:C,send:M}=Lt();let U=0;return Le=async(R="eng",H=f.LSTM_ONLY,re={},I={})=>{const G=d("Worker",U),{logger:Y,errorHandler:m,...o}=l({...h,...re}),n={},t=typeof R=="string"?R.split("+"):R;let y=H,L=I;const x=[f.DEFAULT,f.LSTM_ONLY].includes(H)&&!o.legacyCore;let N,P;const v=new Promise((D,T)=>{P=D,N=T}),F=D=>{N(D.message)};let $=b(o);$.onerror=F,U+=1;const E=({id:D,action:T,payload:q})=>new Promise((Q,X)=>{a(`[${G}]: Start ${D}, action=${T}`);const ae=`${T}-${D}`;n[ae]={resolve:Q,reject:X},M($,{workerId:G,jobId:D,action:T,payload:q})}),i=()=>console.warn("`load` is depreciated and should be removed from code (workers now come pre-loaded)"),p=D=>E(c({id:D,action:"load",payload:{options:{lstmOnly:x,corePath:o.corePath,logging:o.logging}}})),u=(D,T,q)=>E(c({id:q,action:"FS",payload:{method:"writeFile",args:[D,T]}})),k=(D,T)=>E(c({id:T,action:"FS",payload:{method:"readFile",args:[D,{encoding:"utf8"}]}})),e=(D,T)=>E(c({id:T,action:"FS",payload:{method:"unlink",args:[D]}})),r=(D,T,q)=>E(c({id:q,action:"FS",payload:{method:D,args:T}})),s=(D,T)=>E(c({id:T,action:"loadLanguage",payload:{langs:D,options:{langPath:o.langPath,dataPath:o.dataPath,cachePath:o.cachePath,cacheMethod:o.cacheMethod,gzip:o.gzip,lstmOnly:[f.DEFAULT,f.LSTM_ONLY].includes(y)&&!o.legacyLang}}})),S=(D,T,q,Q)=>E(c({id:Q,action:"initialize",payload:{langs:D,oem:T,config:q}})),g=(D="eng",T,q,Q)=>{if(x&&[f.TESSERACT_ONLY,f.TESSERACT_LSTM_COMBINED].includes(T))throw Error("Legacy model requested but code missing.");const X=T||y;y=X;const ae=q||L;L=ae;const se=(typeof D=="string"?D.split("+"):D).filter(rt=>!t.includes(rt));return t.push(...se),se.length>0?s(se,Q).then(()=>S(D,X,ae,Q)):S(D,X,ae,Q)},_=(D={},T)=>E(c({id:T,action:"setParameters",payload:{params:D}})),z=async(D,T={},q={text:!0},Q)=>E(c({id:Q,action:"recognize",payload:{image:await C(D),options:T,output:q}})),Z=async(D,T)=>{if(x)throw Error("`worker.detect` requires Legacy model, which was not loaded.");return E(c({id:T,action:"detect",payload:{image:await C(D)}}))},V=async()=>($!==null&&(w($),$=null),Promise.resolve());A($,({workerId:D,jobId:T,status:q,action:Q,data:X})=>{const ae=`${Q}-${T}`;if(q==="resolve")a(`[${D}]: Complete ${T}`),n[ae].resolve({jobId:T,data:X}),delete n[ae];else if(q==="reject")if(n[ae].reject(X),delete n[ae],Q==="load"&&N(X),m)m(X);else throw Error(X);else q==="progress"&&Y({...X,userJobId:T})});const W={id:G,worker:$,load:i,writeText:u,readText:k,removeFile:e,FS:r,reinitialize:g,setParameters:_,recognize:z,detect:Z,terminate:V};return p().then(()=>s(R)).then(()=>S(R,H,I)).then(()=>P(W)).catch(()=>{}),v},Le}var Se,Ke;function St(){if(Ke)return Se;Ke=1;const l=ot();return Se={recognize:async(d,f,h)=>{const b=await l(f,1,h);return b.recognize(d).finally(async()=>{await b.terminate()})},detect:async(d,f)=>{const h=await l("osd",0,f);return h.detect(d).finally(async()=>{await h.terminate()})}},Se}var Pe,Ye;function Pt(){return Ye||(Ye=1,Pe={AFR:"afr",AMH:"amh",ARA:"ara",ASM:"asm",AZE:"aze",AZE_CYRL:"aze_cyrl",BEL:"bel",BEN:"ben",BOD:"bod",BOS:"bos",BUL:"bul",CAT:"cat",CEB:"ceb",CES:"ces",CHI_SIM:"chi_sim",CHI_TRA:"chi_tra",CHR:"chr",CYM:"cym",DAN:"dan",DEU:"deu",DZO:"dzo",ELL:"ell",ENG:"eng",ENM:"enm",EPO:"epo",EST:"est",EUS:"eus",FAS:"fas",FIN:"fin",FRA:"fra",FRK:"frk",FRM:"frm",GLE:"gle",GLG:"glg",GRC:"grc",GUJ:"guj",HAT:"hat",HEB:"heb",HIN:"hin",HRV:"hrv",HUN:"hun",IKU:"iku",IND:"ind",ISL:"isl",ITA:"ita",ITA_OLD:"ita_old",JAV:"jav",JPN:"jpn",KAN:"kan",KAT:"kat",KAT_OLD:"kat_old",KAZ:"kaz",KHM:"khm",KIR:"kir",KOR:"kor",KUR:"kur",LAO:"lao",LAT:"lat",LAV:"lav",LIT:"lit",MAL:"mal",MAR:"mar",MKD:"mkd",MLT:"mlt",MSA:"msa",MYA:"mya",NEP:"nep",NLD:"nld",NOR:"nor",ORI:"ori",PAN:"pan",POL:"pol",POR:"por",PUS:"pus",RON:"ron",RUS:"rus",SAN:"san",SIN:"sin",SLK:"slk",SLV:"slv",SPA:"spa",SPA_OLD:"spa_old",SQI:"sqi",SRP:"srp",SRP_LATN:"srp_latn",SWA:"swa",SWE:"swe",SYR:"syr",TAM:"tam",TEL:"tel",TGK:"tgk",TGL:"tgl",THA:"tha",TIR:"tir",TUR:"tur",UIG:"uig",UKR:"ukr",URD:"urd",UZB:"uzb",UZB_CYRL:"uzb_cyrl",VIE:"vie",YID:"yid"}),Pe}var xe,Qe;function xt(){return Qe||(Qe=1,xe={OSD_ONLY:"0",AUTO_OSD:"1",AUTO_ONLY:"2",AUTO:"3",SINGLE_COLUMN:"4",SINGLE_BLOCK_VERT_TEXT:"5",SINGLE_BLOCK:"6",SINGLE_LINE:"7",SINGLE_WORD:"8",CIRCLE_WORD:"9",SINGLE_CHAR:"10",SPARSE_TEXT:"11",SPARSE_TEXT_OSD:"12",RAW_LINE:"13"}),xe}var Ce,Xe;function Ct(){if(Xe)return Ce;Xe=1,lt();const l=dt(),c=ot(),a=St(),d=Pt(),f=tt(),h=xt(),{setLogging:b}=Re();return Ce={languages:d,OEM:f,PSM:h,createScheduler:l,createWorker:c,setLogging:b,...a},Ce}var Dt=Ct();const Rt=ct(Dt);function Tt(){return{registerFace:async(d,f)=>{try{const{apiFetch:h}=await K(async()=>{const{apiFetch:w}=await import("./Dbx-Jqc8.js");return{apiFetch:w}},__vite__mapDeps([0,1,2,3]),import.meta.url);return await h(`/api/v1/face-recognition/register/${d}`,{method:"POST",body:f})}catch(h){throw console.error("Error registering face:",h),h}},authenticateByFace:async d=>{try{const{apiFetch:f}=await K(async()=>{const{apiFetch:b}=await import("./Dbx-Jqc8.js");return{apiFetch:b}},__vite__mapDeps([0,1,2,3]),import.meta.url);return await f("/api/v1/face-recognition/authenticate",{method:"POST",body:d})}catch(f){throw console.error("Error authenticating by face:",f),f}},extractFaceEmbedding:async d=>new Promise(f=>{const h=new FileReader;h.onload=()=>{const b=h.result,w=new Uint8Array(b);let A="";for(let C=0;C<Math.min(w.length,100);C++)A+=w[C].toString(16).padStart(2,"0");f(`face_embedding_${A}`)},h.readAsArrayBuffer(d)})}}function Ot(){const l=oe(!1),c=oe(0),a=async(m,o="por")=>{l.value=!0,c.value=0;try{const{data:{text:n,confidence:t}}=await Rt.recognize(m,o,{logger:N=>{N.status==="recognizing text"&&(c.value=Math.round(N.progress*100))}}),y=n.trim(),L=d(y),x=f(y,L);return console.log("ð OCR Analysis:",{documentType:L,confidence:t,extractedData:x,rawText:y.substring(0,200)+"..."}),{text:y,confidence:t,documentType:L,extractedData:x}}catch(n){return console.error("OCR Error:",n),{text:"",confidence:0,documentType:"UNKNOWN"}}finally{l.value=!1,c.value=0}},d=m=>{const o=m.toLowerCase();return o.includes("carteira nacional")||o.includes("habilitacao")||o.includes("habilitaÃ§Ã£o")||o.includes("cnh")||o.includes("condutor")||o.includes("categoria")||o.includes("validade")?(console.log("ð Documento detectado: CNH"),"CNH"):o.includes("carteira de identidade")||o.includes("identidade civil")||o.includes("registro geral")||o.includes("documento de identidade")||o.includes("rg")&&!o.includes("orgao")?(console.log("ð Documento detectado: RG"),"RG"):o.includes("receita federal")||o.includes("cadastro de pessoa")||o.includes("pessoa fisica")||o.includes("cpf")&&o.includes("brasil")?(console.log("ð Documento detectado: CPF"),"CPF"):o.includes("pessoa juridica")||o.includes("cnpj")||o.includes("razao social")||o.includes("empresarial")?(console.log("ð¢ Documento detectado: CNPJ"),"CNPJ"):(console.log("â Tipo de documento nÃ£o identificado"),"UNKNOWN")},f=(m,o)=>{switch(o){case"CNH":return h(m);case"RG":return b(m);case"CPF":return w(m);case"CNPJ":return A(m);default:return C(m)}},h=m=>{console.log("ð Processando CNH brasileira:",m.substring(0,100)+"...");const o=m.replace(/\n+/g," ").replace(/\s+/g," "),n=m.split(`
`).map(p=>p.trim()).filter(p=>p.length>0),t={};console.log("ð Linhas detectadas na CNH:",n.slice(0,15)),console.log('ð EstratÃ©gia simplificada: buscando linha "NOME" + prÃ³xima linha...'),console.log("ð TODAS as linhas para debug:"),n.forEach((p,u)=>{console.log(`Linha ${u+1}: "${p}"`)});for(let p=0;p<n.length-1;p++){const u=n[p],k=n[p+1];if(!(!u||!k)&&u.toLowerCase().includes("nome")){console.log(`â Encontrou "NOME" na linha ${p+1}: "${u}"`),console.log(`ð PrÃ³xima linha: "${k}"`);let e=k.trim();if(e=e.replace(/[|\[\]0-9\/\-\(\)\.]+/g," "),e=e.replace(/[^A-ZÃÃÃÃÃÃÃÃÃÃÃa-zÃ¡Ã Ã¢Ã£Ã©ÃªÃ­Ã´ÃµÃºÃ§\s]/g," "),e=e.replace(/\s+/g," ").trim(),console.log(`ð§¹ Nome apÃ³s limpeza: "${e}"`),e.length>=3&&e.split(" ").length>=1){t.nomeCompleto=e,t.nome=e,t.sobrenome="",console.log("ð¤ Nome completo extraÃ­do (estratÃ©gia simples):",e),console.log("ð¤ Nome (completo):",t.nome),console.log("ð¤ Sobrenome:",t.sobrenome);break}else console.log(`â Linha seguinte nÃ£o parece ser um nome vÃ¡lido: "${e}"`)}}if(!t.nomeCompleto){console.log("ð EstratÃ©gia 2: buscando nome em mÃºltiplas linhas consecutivas...");for(let p=0;p<n.length-2;p++){const u=n[p],k=n[p+1],e=n[p+2];if(!(!u||!k)&&u.toLowerCase().includes("nome")){console.log(`â Encontrou "NOME" na linha ${p+1}: "${u}"`);let r="";if(k&&k.trim().length>0){let s=k.trim();s=s.replace(/[|\[\]0-9\/\-\(\)\.]+/g," "),s=s.replace(/[^A-ZÃÃÃÃÃÃÃÃÃÃÃa-zÃ¡Ã Ã¢Ã£Ã©ÃªÃ­Ã´ÃµÃºÃ§\s]/g," "),s=s.replace(/\s+/g," ").trim(),s.length>0&&(r+=s+" ")}if(e&&e.trim().length>0){let s=e.trim();s=s.replace(/[|\[\]0-9\/\-\(\)\.]+/g," "),s=s.replace(/[^A-ZÃÃÃÃÃÃÃÃÃÃÃa-zÃ¡Ã Ã¢Ã£Ã©ÃªÃ­Ã´ÃµÃºÃ§\s]/g," "),s=s.replace(/\s+/g," ").trim(),s.length>0&&!s.match(/\d/)&&s.length<50&&(r+=s+" ")}if(r=r.trim(),console.log(`ð§¹ Nome combinado apÃ³s limpeza: "${r}"`),r.length>=3){t.nomeCompleto=r,t.nome=r,t.sobrenome="",console.log("ð¤ Nome completo extraÃ­do (estratÃ©gia mÃºltiplas linhas):",r),console.log("ð¤ Nome (completo):",t.nome),console.log("ð¤ Sobrenome:",t.sobrenome);break}}}}if(!t.nomeCompleto){console.log("ð EstratÃ©gia 3: buscando nome na mesma linha...");const p=[/NOME[:\s]+([A-ZÃÃÃÃÃÃÃÃÃÃÃ\s]{3,80})/i,/PORTADOR[:\s]+([A-ZÃÃÃÃÃÃÃÃÃÃÃ\s]{3,80})/i,/CONDUTOR[:\s]+([A-ZÃÃÃÃÃÃÃÃÃÃÃ\s]{3,80})/i];for(const u of p){const k=o.match(u);if(k){const e=k[1]?.trim();if(e&&e.split(" ").length>=2){t.nomeCompleto=e,t.nome=e,t.sobrenome="",console.log("ð¤ Nome completo extraÃ­do (fallback inline):",e),console.log("ð¤ Nome (completo):",t.nome),console.log("ð¤ Sobrenome:",t.sobrenome);break}}}}const y=[/(\d{2}\/\d{2}\/\d{4})/g,/(?:NASCIMENTO[:\s]+)?(\d{2}\/\d{2}\/\d{4})/i,/(?:NASC[:\s]+)?(\d{2}\/\d{2}\/\d{4})/i];for(const p of y){const u=o.match(p);if(u){t.dataNascimento=u[1]||u[0],console.log("ð Data nascimento:",t.dataNascimento);break}}const L=[/(?:NASCIMENTO[:\s]+).*?([A-ZÃÃÃÃÃÃÃÃÃÃÃ\s\-]{3,40}[-\/\s]?[A-Z]{2})/i,/(?:LOCAL[:\s]+NASC[:\s]+)([A-ZÃÃÃÃÃÃÃÃÃÃÃ\s\-]{3,40}[-\/\s]?[A-Z]{2})/i,/(?:NATURALIDADE[:\s]+)([A-ZÃÃÃÃÃÃÃÃÃÃÃ\s\-]{3,40}[-\/\s]?[A-Z]{2})/i,/([A-ZÃÃÃÃÃÃÃÃÃÃÃ\s]{3,30}[-\/\s][A-Z]{2})\b/];for(const p of L){const u=o.match(p);if(u){t.localNascimento=u[1]?.trim(),console.log("ð Local nascimento:",t.localNascimento);break}}const x=o.match(/\d{2}\/\d{2}\/\d{4}/g)||[];console.log("ð Todas as datas encontradas:",x);const N=[/(?:EMISSÃO[:\s]+)(\d{2}\/\d{2}\/\d{4})/i,/(?:EMITIDO[:\s]+)(\d{2}\/\d{2}\/\d{4})/i,/(?:DATA[:\s]+EMISSÃO[:\s]+)(\d{2}\/\d{2}\/\d{4})/i,/(?:4A[:\s]+)(\d{2}\/\d{2}\/\d{4})/i],P=[/(?:VALIDADE[:\s]+)(\d{2}\/\d{2}\/\d{4})/i,/(?:VÃLIDA[:\s]+ATÃ[:\s]+)(\d{2}\/\d{2}\/\d{4})/i,/(?:VENCIMENTO[:\s]+)(\d{2}\/\d{2}\/\d{4})/i,/(?:VENC[:\s]+)(\d{2}\/\d{2}\/\d{4})/i,/(?:4B[:\s]+)(\d{2}\/\d{2}\/\d{4})/i];for(const p of N){const u=o.match(p);if(u){t.dataEmissao=u[1],console.log("ð Data emissÃ£o (contexto):",t.dataEmissao);break}}for(const p of P){const u=o.match(p);if(u){t.validadeCnh=u[1],console.log("ð Validade CNH (contexto):",t.validadeCnh);break}}if((!t.dataEmissao||!t.validadeCnh)&&x.length>=2){console.log("ð Usando lÃ³gica posicional para datas...");let p=x;if(t.dataNascimento&&(p=x.filter(u=>u!==t.dataNascimento)),p.length>=2){const u=p.sort((k,e)=>{const[r,s,S]=k.split("/").map(Number),[g,_,z]=e.split("/").map(Number),Z=new Date(S,s-1,r),V=new Date(z,_-1,g);return Z.getTime()-V.getTime()});t.dataEmissao||(t.dataEmissao=u[0],console.log("ð Data emissÃ£o (posicional):",t.dataEmissao)),!t.validadeCnh&&u.length>1&&(t.validadeCnh=u[u.length-1],console.log("ð Validade CNH (posicional):",t.validadeCnh))}}const v=[/(?:RG[:\s]+)(\d{1,2}\.?\d{3}\.?\d{3}[-\.]?\w{1,2})/i,/(?:IDENTIDADE[:\s]+)(\d{1,2}\.?\d{3}\.?\d{3}[-\.]?\w{1,2})/i,/(?:DOC[:\s]+IDENTIDADE[:\s]+)(\d{1,2}\.?\d{3}\.?\d{3}[-\.]?\w{1,2})/i,/(?:4C[:\s]+)(\d{1,2}\.?\d{3}\.?\d{3}[-\.]?\w{1,2})/i];for(const p of v){const u=o.match(p);if(u){t.rg=u[1],t.numeroIdentidade=u[1],console.log("ð RG/Identidade (explÃ­cito):",t.rg);break}}if(!t.rg){const p=[/\b(\d{1,2}\.?\d{3}\.?\d{3}[-\.]?\w{1,2})\b/,/\b(\d{2}\.\d{3}\.\d{3}-\w)\b/,/\b(\d{8,9}[-]?\w)\b/];for(const u of p){const k=o.match(new RegExp(u.source,"g"));if(k){for(const e of k)if(!e.match(/^\d{11}$/)&&!e.match(/^\d{3}\.\d{3}\.\d{3}-\d{2}$/)&&!e.match(/^\d{2}\/\d{2}\/\d{4}$/)&&e.length<=12){t.rg=e,t.numeroIdentidade=e,console.log("ð RG/Identidade (genÃ©rico):",t.rg);break}if(t.rg)break}}}const F=[/\b(SSP[\s\/\-]*[A-Z]{2})\b/i,/\b(DETRAN[\s\/\-]*[A-Z]{2})\b/i,/\b(SESP[\s\/\-]*[A-Z]{2})\b/i,/\b(PC[\s\/\-]*[A-Z]{2})\b/i,/\b(IIRGD[\s\/\-]*[A-Z]{2})\b/i];for(const p of F){const u=o.match(p);if(u){t.orgaoExpedidor=u[1]?.toUpperCase(),t.orgaoEmissor=t.orgaoExpedidor,console.log("ðï¸ ÃrgÃ£o emissor:",t.orgaoExpedidor);break}}const $=o.match(/\b\d{3}\.?\d{3}\.?\d{3}[-\.]?\d{2}\b/);$&&(t.cpf=$[0].replace(/[^\d]/g,"").replace(/(\d{3})(\d{3})(\d{3})(\d{2})/,"$1.$2.$3-$4"),console.log("ð CPF:",t.cpf));const E=[/\b(\d{11})\b/,/(?:CNH|REGISTRO|HABILITACAO)[:\s]*(\d{11})/i,/(?:N[ÂºÂº]?[\s]*REGISTRO)[:\s]*(\d{11})/i,/(?:NUMERO)[:\s]*(\d{11})/i];for(const p of E){const u=o.match(p);if(u){t.numeroCnh=u[1],console.log("ð NÃºmero CNH:",t.numeroCnh);break}}o.toLowerCase().includes("brasil")&&(t.nacionalidade="BRASILEIRA",console.log("ð§ð· Nacionalidade:",t.nacionalidade));const i={};for(let p=0;p<n.length;p++){const u=n[p];if(u&&(u.toLowerCase().includes("filiacao")||u.toLowerCase().includes("filiaÃ§Ã£o")||u.toLowerCase().includes("pai")||u.toLowerCase().includes("mae")||u.toLowerCase().includes("mÃ£e"))){for(let k=p+1;k<=Math.min(p+3,n.length-1);k++){const e=n[k];if(e&&e.match(/^[A-ZÃÃÃÃÃÃÃÃÃÃÃ\s]{6,60}$/)&&!e.match(/\d/)){if(!i.pai)i.pai=e.trim(),console.log("ð¨ Nome do pai:",i.pai);else if(!i.mae){i.mae=e.trim(),console.log("ð© Nome da mÃ£e:",i.mae);break}}}break}}if(!i.pai||!i.mae){const p=[/(?:PAI[:\s]+)([A-ZÃÃÃÃÃÃÃÃÃÃÃ\s]{6,60})/i,/(?:FILIACAO[:\s]+)([A-ZÃÃÃÃÃÃÃÃÃÃÃ\s]{6,60})/i],u=[/(?:MAE[:\s]+)([A-ZÃÃÃÃÃÃÃÃÃÃÃ\s]{6,60})/i,/(?:MÃE[:\s]+)([A-ZÃÃÃÃÃÃÃÃÃÃÃ\s]{6,60})/i];for(const k of p){const e=o.match(k);if(e&&!i.pai){i.pai=e[1]?.trim(),console.log("ð¨ Nome do pai (padrÃ£o):",i.pai);break}}for(const k of u){const e=o.match(k);if(e&&!i.mae){i.mae=e[1]?.trim(),console.log("ð© Nome da mÃ£e (padrÃ£o):",i.mae);break}}}return(i.pai||i.mae)&&(t.filiacao=i),console.log("â CNH brasileira processada:",t),t},b=m=>{console.log("ð Processando RG:",m.substring(0,100)+"...");const o=m.replace(/\n+/g," ").replace(/\s+/g," "),n={},t=[/\b\d{2}\.?\d{3}\.?\d{3}-?\d{1}\b/,/\b\d{1,2}\.?\d{3}\.?\d{3}-?\w{1,2}\b/,/(?:RG[:\s]*)(\d{1,2}\.?\d{3}\.?\d{3}-?\w{1,2})/i,/(?:IDENTIDADE[:\s]*)(\d{1,2}\.?\d{3}\.?\d{3}-?\w{1,2})/i];for(const P of t){const v=o.match(P);if(v){n.rg=v[1]||v[0],n.numeroIdentidade=n.rg,console.log("ð RG:",n.rg);break}}const y=[/(?:NOME[:\s]+)([A-ZÃÃÃÃÃÃÃÃÃÃÃ\s]{3,60})/i,/(?:PORTADOR[:\s]+)([A-ZÃÃÃÃÃÃÃÃÃÃÃ\s]{3,60})/i];for(const P of y){const v=o.match(P);if(v){const F=v[1]?.trim();if(F){n.nomeCompleto=F;const $=F.split(" ");n.nome=$[0],$.length>1&&(n.sobrenome=$.slice(1).join(" "))}console.log("ð¤ Nome:",n.nomeCompleto);break}}const L=o.match(/\b\d{3}\.?\d{3}\.?\d{3}-?\d{2}\b/);L&&(n.cpf=L[0].replace(/[^\d]/g,"").replace(/(\d{3})(\d{3})(\d{3})(\d{2})/,"$1.$2.$3-$4"),console.log("ð CPF:",n.cpf));const x=[/(?:EMISSÃO[:\s]+)?(\d{2}\/\d{2}\/\d{4})/i,/(?:DATA[:\s]+)?(\d{2}\/\d{2}\/\d{4})/i];for(const P of x){const v=o.match(P);if(v){n.dataEmissao=v[1],console.log("ð Data emissÃ£o:",n.dataEmissao);break}}const N=[/\b(SSP[\s\/]*[A-Z]{2})\b/i,/\b(DETRAN[\s\/]*[A-Z]{2})\b/i,/\b(SESP[\s\/]*[A-Z]{2})\b/i,/\b(PC[\s\/]*[A-Z]{2})\b/i,/\b(SSP)\b/i];for(const P of N){const v=o.match(P);if(v){n.orgaoExpedidor=v[1]?.toUpperCase(),n.orgaoEmissor=n.orgaoExpedidor,console.log("ðï¸ ÃrgÃ£o:",n.orgaoExpedidor);break}}return console.log("â RG processado:",n),n},w=m=>{console.log("ð Processando CPF:",m.substring(0,100)+"...");const o=m.split(`
`).map(t=>t.trim()),n={};for(const t of o)if(t.match(/^\d{3}\.\d{3}\.\d{3}-\d{2}$/)){n.cpf=t,console.log("ð CPF:",n.cpf);break}for(let t=0;t<o.length;t++){const y=o[t];if(y&&y.includes("CPF")&&t>0){const L=o[t-1];if(L&&L.match(/^[A-ZÃÃÃÃÃÃÃÃÃÃÃ\s]+$/)){n.nomeCompleto=L;const x=L.split(" ");n.nome=x[0],x.length>1&&(n.sobrenome=x.slice(1).join(" ")),console.log("ð¤ Nome:",n.nomeCompleto);break}}}return console.log("â CPF processado:",n),n},A=m=>{console.log("ð¢ Processando CNPJ:",m.substring(0,100)+"...");const o=m.replace(/\n+/g," ").replace(/\s+/g," "),n={},t=o.match(/\b\d{2}\.?\d{3}\.?\d{3}\/?\d{4}-?\d{2}\b/);t&&(n.cnpj=t[0].replace(/[^\d]/g,"").replace(/(\d{2})(\d{3})(\d{3})(\d{4})(\d{2})/,"$1.$2.$3/$4-$5"),console.log("ð¢ CNPJ:",n.cnpj));const y=[/(?:RAZAO[:\s]+SOCIAL[:\s]+)([A-ZÃÃÃÃÃÃÃÃÃÃÃ\s]{3,60})/i,/(?:EMPRESA[:\s]+)([A-ZÃÃÃÃÃÃÃÃÃÃÃ\s]{3,60})/i];for(const L of y){const x=o.match(L);if(x){n.razaoSocial=x[1]?.trim(),console.log("ð¢ RazÃ£o Social:",n.razaoSocial);break}}return console.log("â CNPJ processado:",n),n},C=m=>(console.log("â Processando documento genÃ©rico:",m.substring(0,100)+"..."),M(m)),M=m=>{const o=m.replace(/\n+/g," ").replace(/\s+/g," "),n={},t=o.match(/\b\d{3}\.?\d{3}\.?\d{3}-?\d{2}\b/);t&&(n.cpf=t[0].replace(/[^\d]/g,"").replace(/(\d{3})(\d{3})(\d{3})(\d{2})/,"$1.$2.$3-$4"));const y=[/\b\d{2}\.?\d{3}\.?\d{3}-?\d{1}\b/,/\b\d{1,2}\.?\d{3}\.?\d{3}-?\w{1,2}\b/,/RG[:\s]*(\d{1,2}\.?\d{3}\.?\d{3}-?\w{1,2})/i];for(const P of y){const v=o.match(P);if(v){n.rg=v[0].replace(/^RG[:\s]*/i,"");break}}const L=[/(?:NOME[:\s]+)([A-ZÃÃÃÃÃÃÃÃÃÃÃ\s]{2,50})/i,/(?:PORTADOR[:\s]+)([A-ZÃÃÃÃÃÃÃÃÃÃÃ\s]{2,50})/i,/\b([A-ZÃÃÃÃÃÃÃÃÃÃÃ]{2,}\s+[A-ZÃÃÃÃÃÃÃÃÃÃÃ\s]{2,50})\b/];for(const P of L){const v=o.match(P);if(v){const F=v[1].trim();if(F.length>5&&!F.match(/\d/)&&F.split(" ").length>=2){n.nome=F;break}}}const x=[/(?:EMISSÃO[:\s]+)?(\d{2}\/\d{2}\/\d{4})/i,/(?:DATA[:\s]+)?(\d{2}\/\d{2}\/\d{4})/i];for(const P of x){const v=o.match(P);if(v){n.dataEmissao=v[1];break}}const N=[/\b(SSP[\/\s]*[A-Z]{2})\b/i,/\b(DETRAN[\/\s]*[A-Z]{2})\b/i,/\b(SESP[\/\s]*[A-Z]{2})\b/i,/\b(PC[\/\s]*[A-Z]{2})\b/i];for(const P of N){const v=o.match(P);if(v){n.orgaoExpedidor=v[1]?.toUpperCase();break}}return n},U=async m=>{const o=await a(m);if(o.extractedData){const n=o.text.toLowerCase();if(n.includes("receita federal")||n.includes("cpf")||n.includes("cadastro")){const t=H(o.text);o.extractedData={...o.extractedData,...t}}}return o},R=async m=>{const o=await a(m);if(o.extractedData){const n=o.text.toLowerCase();if(n.includes("carteira de identidade")||n.includes("identidade civil")||n.includes("rg")){const t=re(o.text);o.extractedData={...o.extractedData,...t}}}return o},H=m=>{const o={},n=m.split(`
`).map(t=>t.trim());for(const t of n)if(t.match(/^\d{3}\.\d{3}\.\d{3}-\d{2}$/)){o.cpf=t;break}for(let t=0;t<n.length;t++)if(n[t].includes("CPF")&&t>0){const L=n[t-1];if(L.match(/^[A-ZÃÃÃÃÃÃÃÃÃÃÃ\s]+$/)){o.nome=L;break}}return o},re=m=>{const o={},n=m.split(`
`).map(t=>t.trim());for(let t=0;t<n.length;t++){const y=n[t];if(y&&y.toUpperCase().includes("NOME")&&t+1<n.length){const L=n[t+1];L&&(o.nome=L.replace(/[^A-ZÃÃÃÃÃÃÃÃÃÃÃ\s]/g,"").trim())}y&&y.match(/\d{2}\.\d{3}\.\d{3}-\d/)&&(o.rg=y.match(/\d{2}\.\d{3}\.\d{3}-\d/)?.[0])}return o},I=async m=>{try{return new Promise(o=>{const n=document.createElement("canvas"),t=n.getContext("2d"),y=new Image;y.onload=()=>{n.width=y.width,n.height=y.height,t?.drawImage(y,0,0);const L=Math.floor(y.width*.25),x=Math.floor(y.height*.3),N=y.width-L-Math.floor(y.width*.05),P=Math.floor(y.height*.1),v=document.createElement("canvas"),F=v.getContext("2d");if(v.width=L,v.height=x,F&&t){const $=t.getImageData(N,P,L,x);F.putImageData($,0,0);const E=v.toDataURL("image/jpeg",.8);o(E)}else o(null)},y.onerror=()=>o(null),y.src=URL.createObjectURL(m)})}catch(o){return console.error("Erro ao extrair foto do documento:",o),null}},G=async(m,o,n)=>{const t=[],y=[];let L=0,x=null,N=null;try{if(x=await I(n),x){const P=await fetch(x).then($=>$.blob()),v=new File([P],"document_photo.jpg",{type:"image/jpeg"}),{extractFaceEmbedding:F}=Tt();N=await F(v)}if(o.extractedData){const P=o.extractedData.nome?.toLowerCase().trim(),v=m.nome.toLowerCase().trim();if(P&&v){const F=Y(v,P);F>.8?L+=40:F>.6?(y.push(`Nome no documento (${P}) pode nÃ£o corresponder ao informado (${v})`),L+=20):t.push(`Nome no documento (${P}) nÃ£o corresponde ao informado (${v})`)}if(m.cpf&&o.extractedData.cpf){const F=o.extractedData.cpf.replace(/[^\d]/g,""),$=m.cpf.replace(/[^\d]/g,"");F===$?L+=30:t.push(`CPF no documento (${o.extractedData.cpf}) nÃ£o corresponde ao informado (${m.cpf})`)}(o.extractedData.dataEmissao||o.extractedData.validadeCnh)&&(L+=15),x?L+=15:y.push("NÃ£o foi possÃ­vel extrair a foto do documento para validaÃ§Ã£o facial")}return{isValid:t.length===0&&L>=60,errors:t,warnings:y,extractedPhoto:x||void 0,faceEmbedding:N||void 0,confidenceScore:L}}catch(P){return console.error("Erro na validaÃ§Ã£o do documento:",P),{isValid:!1,errors:["Erro interno na validaÃ§Ã£o do documento"],warnings:[],confidenceScore:0}}},Y=(m,o)=>{const n=P=>P.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase().replace(/[^a-z\s]/g,"").trim(),t=n(m),y=n(o);if(t.includes(y)||y.includes(t))return .9;const L=t.split(" "),x=y.split(" ");let N=0;for(const P of L)for(const v of x)if(P===v||P.length>3&&v.length>3&&(P.includes(v)||v.includes(P))){N++;break}return N/Math.max(L.length,x.length)};return{extractText:a,extractFromCPF:U,extractFromRG:R,extractPhotoFromDocument:I,validateDocumentData:G,isProcessing:Te(l),progress:Te(c)}}const _t={class:"space-y-2"},Nt={class:"text-[12px] text-slate-300"},kt=["accept"],It={key:0},Mt={class:"text-xs text-slate-400 mt-1"},Ft={key:1,class:"py-2"},$t={class:"w-full bg-slate-700 rounded-full h-2 mt-2"},Ut={class:"text-xs text-slate-400 mt-1"},qt={key:2,class:"py-2"},Gt={class:"w-full bg-slate-700 rounded-full h-2 mt-2"},Bt={key:3,class:"py-2"},jt={class:"text-sm text-slate-300 truncate"},zt={class:"text-xs text-slate-400"},Zt={key:0,class:"mt-2 p-2 bg-blue-900/20 border border-blue-700/30 rounded text-xs"},Vt={key:0,class:"mb-2 flex items-center space-x-2"},Wt=["src"],Ht={class:"space-y-1"},Jt={key:0,class:"text-slate-300"},Kt={key:1,class:"text-slate-300"},Yt={key:2,class:"text-slate-300"},Qt={key:3,class:"text-slate-300"},Xt={key:4,class:"text-slate-300"},eo={key:1,class:"mt-2 pt-2 border-t border-blue-700/30"},to={key:0,class:"text-green-400"},oo={key:1,class:"text-red-400"},ro={key:2,class:"mt-1"},ao={class:"text-slate-500 mt-1"},no={key:4,class:"mt-2 text-red-400 text-xs"},so={key:5,class:"mt-2 text-green-400 text-xs"},lo={__name:"UserFileUpload",props:{label:{type:String,required:!0},accept:{type:String,default:"image/*,application/pdf"},maxSize:{type:Number,default:5*1024*1024},modelValue:{type:String,default:""},userId:{type:String,required:!1},fileType:{type:String,required:!0,validator:l=>["profileImage","cpfImage","rgImage","cnpjImage","enderecoImage","telefoneImage","bancoImage","pixImage","PROFILE_PHOTO","ADDRESS_PROOF","DOCUMENT","RG","CNH","IDENTITY"].includes(l)},enableOcr:{type:Boolean,default:!1},temporaryMode:{type:Boolean,default:!1},sessionId:{type:String,required:!1},formData:{type:Object,default:()=>({}),validator:l=>typeof l=="object"}},emits:["update:modelValue","file-selected","file-uploaded","ocr-result"],setup(l,{emit:c}){const a=l,d=c,f=oe(),h=oe(null),b=oe(!1),w=oe(0),A=oe(""),C=oe(""),M=oe(!1),U=oe(0),R=oe(null),{uploadUserFile:H}=it(),{extractFromCPF:re,extractFromRG:I,extractText:G,validateDocumentData:Y,isProcessing:m,progress:o}=Ot();Oe(m,E=>{M.value=E}),Oe(o,E=>{U.value=E});const n=at(()=>a.accept.includes("image/*")?"Aceita imagens (JPG, PNG, etc.) e PDFs":"Tipos aceitos: "+a.accept);function t(){b.value||f.value?.click()}function y(E){const i=E.target.files[0];i&&x(i)}function L(E){const i=E.dataTransfer.files[0];i&&x(i)}async function x(E){if(A.value="",C.value="",E.size>a.maxSize){A.value=`Arquivo muito grande. MÃ¡ximo: ${v(a.maxSize)}`;return}if(!a.accept.split(",").map(u=>u.trim()).some(u=>u==="image/*"?E.type.startsWith("image/"):u==="application/*"?E.type.startsWith("application/"):E.type===u)){A.value="Tipo de arquivo nÃ£o permitido";return}h.value=E,d("file-selected",E),a.enableOcr&&F(E)&&await $(E),N(E)}async function N(E){b.value=!0,w.value=0;try{w.value=25;let i;if(a.userId)i=await H(a.userId,E,a.fileType);else{A.value="UsuÃ¡rio deve ser salvo antes de enviar arquivos. Preencha nome e email vÃ¡lidos.";return}C.value="Arquivo enviado com sucesso!",w.value=75,w.value=100,d("update:modelValue",i.publicUrl),d("file-uploaded",i)}catch(i){console.error("Upload error:",i),A.value=i.message||"Erro ao fazer upload do arquivo",h.value=null}finally{b.value=!1}}function P(){h.value=null,A.value="",C.value="",d("update:modelValue",""),f.value&&(f.value.value="")}function v(E){if(E===0)return"0 Bytes";const i=1024,p=["Bytes","KB","MB","GB"],u=Math.floor(Math.log(E)/Math.log(i));return parseFloat((E/Math.pow(i,u)).toFixed(2))+" "+p[u]}function F(E){return["cpfImage","rgImage","cnpjImage","profileImage","enderecoImage","telefoneImage","bancoImage"].includes(a.fileType)&&(E.type.startsWith("image/")||E.type==="application/pdf")}async function $(E){try{R.value=null,A.value="";let i;switch(a.fileType){case"cpfImage":i=await re(E);break;case"rgImage":i=await I(E);break;case"cnpjImage":i=await G(E);break;default:i=await G(E)}if(i&&i.extractedData){R.value=i;let p=null;if(a.formData&&(a.formData.nome||a.formData.email)){console.log("ð Iniciando validaÃ§Ã£o cruzada dos dados...");try{p=await Y(a.formData,i,E),console.log("â Resultado da validaÃ§Ã£o:",p),p.isValid?C.value=`â Documento vÃ¡lido! ConfianÃ§a: ${p.confidenceScore}%`:A.value=`â Problemas na validaÃ§Ã£o: ${p.errors.join(", ")}`,p.warnings.length>0&&console.warn("â ï¸ Warnings:",p.warnings)}catch(u){console.error("Erro na validaÃ§Ã£o cruzada:",u)}}if(d("ocr-result",{fileType:a.fileType,extractedData:i.extractedData,confidence:i.confidence,fullText:i.text,validation:p,extractedPhoto:p?.extractedPhoto}),!p){const u=Object.keys(i.extractedData).length;u>0&&(C.value=`OCR: ${u} campo(s) extraÃ­do(s) automaticamente`)}}else console.warn("OCR nÃ£o encontrou dados estruturados")}catch(i){console.error("Erro no processamento OCR:",i)}}return(E,i)=>(j(),B("div",_t,[O("label",Nt,J(l.label),1),O("div",{class:"border-2 border-dashed border-slate-600 rounded-lg p-4 text-center cursor-pointer hover:border-slate-500 transition-colors",onClick:t,onDragover:i[0]||(i[0]=ie(()=>{},["prevent"])),onDrop:ie(L,["prevent"])},[O("input",{ref_key:"fileInput",ref:f,type:"file",accept:l.accept,class:"hidden",onChange:y},null,40,kt),!h.value&&!b.value?(j(),B("div",It,[i[1]||(i[1]=O("i",{class:"fa-solid fa-cloud-arrow-up text-2xl text-slate-400 mb-2"},null,-1)),i[2]||(i[2]=O("p",{class:"text-sm text-slate-300"}," Clique para selecionar ou arraste o arquivo aqui ",-1)),O("p",Mt,J(n.value),1)])):M.value?(j(),B("div",Ft,[i[3]||(i[3]=O("i",{class:"fa-solid fa-brain text-xl text-blue-500 mb-2"},null,-1)),i[4]||(i[4]=O("p",{class:"text-sm text-slate-300"},"Extraindo dados do documento...",-1)),O("div",$t,[O("div",{class:"bg-blue-500 h-2 rounded-full transition-all duration-300",style:_e({width:U.value+"%"})},null,4)]),O("p",Ut,J(U.value)+"% concluÃ­do",1)])):b.value?(j(),B("div",qt,[i[5]||(i[5]=O("i",{class:"fa-solid fa-spinner fa-spin text-xl text-orange-500 mb-2"},null,-1)),i[6]||(i[6]=O("p",{class:"text-sm text-slate-300"},"Enviando arquivo...",-1)),O("div",Gt,[O("div",{class:"bg-orange-500 h-2 rounded-full transition-all duration-300",style:_e({width:w.value+"%"})},null,4)])])):h.value?(j(),B("div",Bt,[i[18]||(i[18]=O("i",{class:"fa-solid fa-file text-xl text-green-500 mb-2"},null,-1)),O("p",jt,J(h.value.name),1),O("p",zt,J(v(h.value.size)),1),R.value&&R.value.extractedData?(j(),B("div",Zt,[i[16]||(i[16]=O("p",{class:"text-blue-400 font-medium mb-1"},[O("i",{class:"fa-solid fa-magic-wand-sparkles mr-1"}),te(" Dados extraÃ­dos automaticamente: ")],-1)),R.value.extractedPhoto?(j(),B("div",Vt,[O("img",{src:R.value.extractedPhoto,alt:"Foto extraÃ­da do documento",class:"w-16 h-16 object-cover rounded border border-blue-700/50"},null,8,Wt),i[7]||(i[7]=O("div",{class:"text-xs"},[O("p",{class:"text-green-400"},[O("i",{class:"fa-solid fa-camera mr-1"}),te(" Foto extraÃ­da para validaÃ§Ã£o facial ")])],-1))])):ee("",!0),O("div",Ht,[R.value.extractedData.nome?(j(),B("div",Jt,[i[8]||(i[8]=O("span",{class:"text-slate-400"},"Nome:",-1)),te(" "+J(R.value.extractedData.nome),1)])):ee("",!0),R.value.extractedData.cpf?(j(),B("div",Kt,[i[9]||(i[9]=O("span",{class:"text-slate-400"},"CPF:",-1)),te(" "+J(R.value.extractedData.cpf),1)])):ee("",!0),R.value.extractedData.rg?(j(),B("div",Yt,[i[10]||(i[10]=O("span",{class:"text-slate-400"},"RG:",-1)),te(" "+J(R.value.extractedData.rg),1)])):ee("",!0),R.value.extractedData.orgaoExpedidor?(j(),B("div",Qt,[i[11]||(i[11]=O("span",{class:"text-slate-400"},"ÃrgÃ£o:",-1)),te(" "+J(R.value.extractedData.orgaoExpedidor),1)])):ee("",!0),R.value.extractedData.dataEmissao?(j(),B("div",Xt,[i[12]||(i[12]=O("span",{class:"text-slate-400"},"EmissÃ£o:",-1)),te(" "+J(R.value.extractedData.dataEmissao),1)])):ee("",!0)]),R.value.validation?(j(),B("div",eo,[R.value.validation.isValid?(j(),B("div",to,[i[13]||(i[13]=O("i",{class:"fa-solid fa-check-circle mr-1"},null,-1)),te(" Documento validado ("+J(R.value.validation.confidenceScore)+"% confianÃ§a) ",1)])):(j(),B("div",oo,[...i[14]||(i[14]=[O("i",{class:"fa-solid fa-exclamation-triangle mr-1"},null,-1),te(" ValidaÃ§Ã£o falhou ",-1)])])),R.value.validation.warnings.length>0?(j(),B("div",ro,[(j(!0),B(nt,null,st(R.value.validation.warnings,p=>(j(),B("div",{key:p,class:"text-yellow-400 text-xs"},[i[15]||(i[15]=O("i",{class:"fa-solid fa-warning mr-1"},null,-1)),te(" "+J(p),1)]))),128))])):ee("",!0)])):ee("",!0),O("p",ao,"ConfianÃ§a OCR: "+J(Math.round(R.value.confidence))+"%",1)])):ee("",!0),O("button",{class:"mt-2 text-red-400 hover:text-red-300 text-xs",onClick:ie(P,["stop"])},[...i[17]||(i[17]=[O("i",{class:"fa-solid fa-trash mr-1"},null,-1),te(" Remover ",-1)])])])):ee("",!0),A.value?(j(),B("div",no,J(A.value),1)):ee("",!0),C.value?(j(),B("div",so,[i[19]||(i[19]=O("i",{class:"fa-solid fa-check mr-1"},null,-1)),te(" "+J(C.value),1)])):ee("",!0)],32)]))}};function uo(){return{getCurrentLocation:()=>new Promise((a,d)=>{if(!navigator.geolocation){d(new Error("GeolocalizaÃ§Ã£o nÃ£o Ã© suportada pelo navegador"));return}navigator.geolocation.getCurrentPosition(f=>{a({latitude:f.coords.latitude,longitude:f.coords.longitude,accuracy:f.coords.accuracy})},f=>{let h="Erro ao obter localizaÃ§Ã£o";switch(f.code){case f.PERMISSION_DENIED:h="PermissÃ£o de geolocalizaÃ§Ã£o negada";break;case f.POSITION_UNAVAILABLE:h="LocalizaÃ§Ã£o indisponÃ­vel";break;case f.TIMEOUT:h="Timeout ao obter localizaÃ§Ã£o";break}d(new Error(h))},{enableHighAccuracy:!0,timeout:15e3,maximumAge:6e4})}),formatLocation:a=>`${a.latitude},${a.longitude}`}}async function fo(){const{apiFetch:l}=await K(async()=>{const{apiFetch:c}=await import("./Dbx-Jqc8.js");return{apiFetch:c}},__vite__mapDeps([0,1,2,3]),import.meta.url);try{return await l("/api/v1/users")||[]}catch(c){return console.error("Error fetching users:",c),[]}}async function po(l){const{apiFetch:c}=await K(async()=>{const{apiFetch:a}=await import("./Dbx-Jqc8.js");return{apiFetch:a}},__vite__mapDeps([0,1,2,3]),import.meta.url);try{return await c("/api/v1/users",{method:"POST",body:l})}catch(a){throw console.error("Error creating user:",a),a}}async function mo(l,c){const{apiFetch:a}=await K(async()=>{const{apiFetch:d}=await import("./Dbx-Jqc8.js");return{apiFetch:d}},__vite__mapDeps([0,1,2,3]),import.meta.url);try{return await a(`/api/v1/users/${l}`,{method:"PUT",body:c})}catch(d){throw console.error("Error updating user:",d),d}}async function ho(l){const{apiFetch:c}=await K(async()=>{const{apiFetch:a}=await import("./Dbx-Jqc8.js");return{apiFetch:a}},__vite__mapDeps([0,1,2,3]),import.meta.url);try{return await c(`/api/v1/users/${l}`,{method:"DELETE"}),!0}catch(a){return console.error("Error deleting user:",a),!1}}async function go(l,c){const{apiFetch:a}=await K(async()=>{const{apiFetch:d}=await import("./Dbx-Jqc8.js");return{apiFetch:d}},__vite__mapDeps([0,1,2,3]),import.meta.url);try{const d=new URLSearchParams({email:l});return c&&d.append("excludeUserId",c),(await a(`/api/v1/users/check-email?${d}`))?.available||!1}catch(d){return console.error("Error checking email availability:",d),!1}}async function vo(l,c){const{apiFetch:a}=await K(async()=>{const{apiFetch:d}=await import("./Dbx-Jqc8.js");return{apiFetch:d}},__vite__mapDeps([0,1,2,3]),import.meta.url);try{return await a("/api/v1/users/create-basic",{method:"POST",body:{name:l,email:c,password:"temp123"}})}catch(d){throw console.error("Error creating basic user:",d),d}}export{lo as _,Tt as a,mo as b,po as c,ho as d,go as e,fo as f,vo as g,uo as u};
