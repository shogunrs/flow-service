const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./B3Fs0kR7.js","./qcAyaCsh.js","./entry.DO5d1tXt.css","./3xuymguz.js","./BH6je_ft.js","./CV9EyYCX.js","./BlnrnVG4.js"])))=>i.map(i=>d[i]);
import{f as dl,r as x,L as ul,_ as qe,y as q,g as Ze,G as pe,c as i,l as w,o as l,a as e,H as oe,t as I,J as de,b as Y,w as ve,j as ke,q as M,F as se,k as ce,d as T,i as ee,m as ue,N as cl,T as ha,O as xa,e as ya,P as pl,C as rt,B as rc,Q as $a,v as jt,h as wa,R as Se,I as ze,S as ia,U as ra,A as Ve,u as vl,s as fl,M as ml,V as gl,W as bl,X as hl,z as xt,Y as xl,Z as yl,n as Qe}from"./qcAyaCsh.js";import{isApiEnabled as te,apiFetch as Ie,getApiBase as $l}from"./BH6je_ft.js";import{c as ka,e as wl}from"./3xuymguz.js";import{u as ea}from"./BlnrnVG4.js";/* empty css        */import{f as da}from"./BA3JyHsk.js";import{f as kl,a as ua}from"./CGbtcE1L.js";import"./CV9EyYCX.js";const _a=r=>`pipeline_proposals__${r}`;function _l(r,S){try{return r?JSON.parse(r):S}catch{return S}}function $t(r){if(te())try{return[]}catch{return[]}if(typeof localStorage>"u")return[];const S=ka(r);return _l(localStorage.getItem(_a(S)),[])}function it(r,S){if(te()||typeof localStorage>"u")return;const c=ka(r);localStorage.setItem(_a(c),JSON.stringify(S||[]))}async function Lt(r){if(!te())return[];try{return(await Ie(`/api/v1/processes/${encodeURIComponent(r)}/proposals`)||[]).map(c=>({id:c.id,name:c.name,amount:Number(c.amount||0),stageId:c.stageId,status:c.status||"Pendente",isArchived:!!c.archived,stageEnteredAt:c.stageEnteredAt,details:c.details||{},createdBy:c.createdBy,organizationId:c.organizationId,isPublic:c.isPublic,visibleToUsers:c.visibleToUsers||[],externalNotifications:c.externalNotifications||[]}))}catch{return[]}}async function ca(r,S){if(!te())return null;try{const c={name:S.name,amount:S.amount,stageId:S.stageId,status:S.status};S.details&&Object.keys(S.details).length>0&&(c.details=S.details),typeof S.isPublic=="boolean"&&(c.isPublic=S.isPublic),S.visibleToUsers&&(c.visibleToUsers=S.visibleToUsers),S.externalNotifications&&(c.externalNotifications=S.externalNotifications);const _={};S.createdBy&&(_["X-User-ID"]=S.createdBy),S.organizationId&&(_["X-Organization-ID"]=S.organizationId);const m=await Ie(`/api/v1/processes/${encodeURIComponent(r)}/proposals`,{method:"POST",body:c,headers:_});return{id:m.id,name:m.name,amount:Number(m.amount||0),stageId:m.stageId,status:m.status||"Pendente",isArchived:!!m.archived,stageEnteredAt:m.stageEnteredAt,details:m.details||{},createdBy:m.createdBy,organizationId:m.organizationId,isPublic:m.isPublic,visibleToUsers:m.visibleToUsers||[],externalNotifications:m.externalNotifications||[]}}catch{return null}}async function Vl(r,S){if(!te())return{};try{return await Ie(`/api/v1/processes/${encodeURIComponent(r)}/proposals/${encodeURIComponent(S)}/forms`)}catch{return{}}}async function pa(r,S,c,_){if(!te())return _||{};try{return await Ie(`/api/v1/processes/${encodeURIComponent(r)}/proposals/${encodeURIComponent(S)}/forms/${encodeURIComponent(c)}`,{method:"PUT",body:{values:_||{}},silent:!0})}catch{return _||{}}}async function Gt(r,S,c){if(!te())return null;try{const _={};c.stageId&&(_.stageId=c.stageId),typeof c.amount=="number"&&(_.amount=c.amount),c.status&&(_.status=c.status),c.name&&(_.name=c.name);const m=await Ie(`/api/v1/processes/${encodeURIComponent(r)}/proposals/${encodeURIComponent(String(S))}`,{method:"PUT",body:_,silent:!0});return{id:m.id,name:m.name,amount:Number(m.amount||0),stageId:m.stageId,status:m.status||"Pendente",isArchived:!!m.archived,stageEnteredAt:m.stageEnteredAt,details:m.details||{}}}catch{return null}}async function Il(r,S){if(!te())return!1;try{return await Ie(`/api/v1/processes/${encodeURIComponent(r)}/proposals/${encodeURIComponent(String(S))}`,{method:"DELETE"}),!0}catch{return!1}}function Cl(r){const{public:{FLOW_API_BASE:S}}=dl(),{user:c}=ea(),_=S,m=x([]),k=x(!1),v=async()=>{if(!_||!r){m.value=[];return}k.value=!0;try{const y={};c.value?.id&&(y["X-User-ID"]=c.value.id),c.value?.organizationId&&(y["X-Organization-ID"]=c.value.organizationId);const s=await $fetch(`${_}/api/v1/processes/${encodeURIComponent(r)}/proposals`,{headers:y});m.value=(s||[]).map(d=>({id:d.id,name:d.name,amount:Number(d.amount||0),stageId:d.stageId,status:d.status||"Pendente",isArchived:!!d.archived,stageEnteredAt:d.stageEnteredAt,details:d.details||{},createdBy:d.createdBy,organizationId:d.organizationId,isPublic:d.isPublic,visibleToUsers:d.visibleToUsers||[],externalNotifications:d.externalNotifications||[]}))}catch(y){console.error("Erro ao carregar propostas:",y),m.value=[]}finally{k.value=!1}};return v(),{proposals:m,loading:ul(k),refresh:v}}function va(r,S){const c=r.filter(y=>!y.isArchived),_=c.length,m=c.reduce((y,s)=>y+(s.amount||0),0),k=_>0?m/_:0,v={};return c.forEach(y=>{y.stageId&&(v[y.stageId]=(v[y.stageId]||0)+1)}),{totalProposals:_,totalAmount:m,averageAmount:k,proposalsByStage:v,processKey:S}}function Sl(r){const S=$l(),c=x(null),_=x(!1),k=async()=>{if(!r){c.value=null;return}_.value=!0;try{if(te()&&S){const s=await $fetch(`${S}/api/v1/processes/${encodeURIComponent(r)}/proposals/stats`);c.value=s}else{const s=$t(r);c.value=va(s,r)}}catch(s){console.warn("Erro ao carregar estatísticas da API, usando cálculo local:",s);const d=$t(r);c.value=va(d,r)}finally{_.value=!1}},v=s=>s==null||isNaN(s)?"R$ 0,00":new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(s);return{stats:c,loading:_,refresh:k,formatCurrency:v,formatCompactCurrency:s=>s==null||isNaN(s)?"R$ 0,00":s>=1e6?new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL",notation:"compact",maximumFractionDigits:1}).format(s):v(s)}}const Pl={key:0,class:"flex items-center gap-3"},Al={key:0,class:"flex items-center gap-4"},Fl={class:"flex items-center gap-1.5"},El={class:"text-xs"},Bl={class:"text-white font-semibold ml-1"},Ul={class:"flex items-center gap-1.5"},Dl={class:"text-xs"},Nl={class:"text-white font-semibold ml-1"},Ml={key:0,class:"flex items-center gap-1.5"},zl={class:"text-xs"},ql={class:"text-white font-semibold ml-1"},Rl={key:1,class:"flex items-center gap-2"},Tl={__name:"FinancialStats",props:{pipelineKey:{type:String,required:!0},isFinancialProcess:{type:Boolean,default:!1},proposals:{type:Array,default:()=>[]}},setup(r,{expose:S}){const c=r,{stats:_,loading:m,refresh:k,formatCompactCurrency:v}=Sl(c.pipelineKey),y=q(()=>{if(!c.proposals?.length)return null;const $=c.proposals.filter(z=>!z.isArchived),U=$.length,G=$.reduce((z,L)=>z+(L.amount||0),0),j=U>0?G/U:0,H={};return $.forEach(z=>{z.stageId&&(H[z.stageId]=(H[z.stageId]||0)+1)}),{totalProposals:U,totalAmount:G,averageAmount:j,proposalsByStage:H,processKey:c.pipelineKey}}),s=q(()=>_.value&&(_.value.totalProposals>0||_.value.totalAmount>0)?_.value:y.value),d=q(()=>c.isFinancialProcess&&c.pipelineKey);return Ze(()=>{d.value&&k()}),pe(()=>c.pipelineKey,()=>{d.value&&k()}),pe(()=>c.isFinancialProcess,$=>{$&&c.pipelineKey&&k()}),S({refresh:k}),($,U)=>d.value?(l(),i("div",Pl,[U[7]||(U[7]=e("div",{class:"flex items-center gap-1.5 px-2 py-1 bg-emerald-600/20 border border-emerald-500/30 rounded-md"},[e("i",{class:"fa-solid fa-dollar-sign text-emerald-400 text-xs animate-pulse",style:{filter:"drop-shadow(0 0 4px rgba(34, 197, 94, 0.6))"}}),e("span",{class:"text-emerald-300 text-xs font-medium"},"Financeiro")],-1)),s.value&&!oe(m)?(l(),i("div",Al,[e("div",Fl,[U[1]||(U[1]=e("div",{class:"w-2 h-2 rounded-full bg-blue-400 animate-pulse"},null,-1)),e("div",El,[U[0]||(U[0]=e("span",{class:"text-slate-400"},"Pipeline:",-1)),e("span",Bl,I(oe(v)(s.value?.totalAmount||0)),1)])]),e("div",Ul,[U[3]||(U[3]=e("div",{class:"w-2 h-2 rounded-full bg-indigo-400"},null,-1)),e("div",Dl,[U[2]||(U[2]=e("span",{class:"text-slate-400"},"Propostas:",-1)),e("span",Nl,I(s.value?.totalProposals||0),1)])]),(s.value?.totalProposals||0)>0?(l(),i("div",Ml,[U[5]||(U[5]=e("div",{class:"w-2 h-2 rounded-full bg-amber-400"},null,-1)),e("div",zl,[U[4]||(U[4]=e("span",{class:"text-slate-400"},"Média:",-1)),e("span",ql,I(oe(v)(s.value?.averageAmount||0)),1)])])):w("",!0)])):oe(m)?(l(),i("div",Rl,[...U[6]||(U[6]=[e("div",{class:"w-4 h-4 border-2 border-slate-600 border-t-emerald-400 rounded-full animate-spin"},null,-1),e("span",{class:"text-slate-400 text-xs"},"Carregando...",-1)])])):w("",!0)])):w("",!0)}},Ol=qe(Tl,[["__scopeId","data-v-498e36cc"]]),jl={key:0,class:"fixed inset-0 z-50 flex items-center justify-center"},Ll={class:"flex items-center justify-between px-3 py-2 border-b border-slate-700/60 bg-gradient-to-r from-purple-900/60 to-indigo-900/40 relative overflow-hidden"},Gl={class:"flex items-center gap-2 relative z-10"},Jl={class:"text-[13px] font-semibold tracking-wide text-purple-100"},Kl={key:0,class:"px-3 py-2 bg-gradient-to-r from-emerald-900/40 to-green-900/40 border-b border-slate-700/60"},Wl={class:"flex items-center gap-2 text-xs"},Hl={class:"text-emerald-200"},Xl={class:"text-[10px] text-emerald-300 mt-1"},Yl={key:1,class:"mt-2 grid grid-cols-3 gap-2"},Ql=["href"],Zl=["src","alt"],es=["href"],ts={key:0,class:"flex justify-start"},as={class:"border-t border-slate-700/60 p-2 flex items-center gap-2 bg-slate-900/30"},ls=["multiple","accept"],ss=["placeholder","onKeydown"],os=["disabled"],ns={key:1,class:"px-3 pb-2"},is={class:"grid grid-cols-4 gap-2"},rs=["src","alt"],ds={key:1,class:"w-full h-20 text-[11px] p-2 rounded-xl border border-slate-700 bg-slate-700/40 flex items-center justify-center text-center break-all shadow"},us=["onClick"],cs={__name:"ChatModal",props:{show:{type:Boolean,default:!1},title:{type:String,default:"ConsorIA"},messages:{type:Array,default:()=>[]},typing:{type:Boolean,default:!1},size:{type:String,default:"sm"},placeholder:{type:String,default:"Pergunte sobre seu consórcio…"},accept:{type:String,default:"image/*,application/pdf,application/*,text/*"},allowFileUpload:{type:Boolean,default:!0},allowPaste:{type:Boolean,default:!0},allowDrop:{type:Boolean,default:!0},allowMultiple:{type:Boolean,default:!0}},emits:["update:show","send","close"],setup(r,{expose:S,emit:c}){const _=r,m=c,k=x(""),v=x([]),y=x(null),s=x(null),d=x({hasKnowledge:!1,fileName:"",size:0,preview:""}),$=q({get:()=>_.show,set:A=>m("update:show",A)}),U=q(()=>{switch(_.size){case"xs":return"sm:max-w-[20rem] md:max-w-sm";case"md":return"sm:max-w-md md:max-w-lg";case"lg":return"sm:max-w-lg md:max-w-xl";default:return"sm:max-w-sm md:max-w-md"}});pe(()=>_.messages?.length,()=>G()),pe(()=>_.show,A=>{A&&n()});function G(){requestAnimationFrame(()=>{const A=y.value;A&&(A.scrollTop=A.scrollHeight)})}function j(){m("update:show",!1),m("close")}function H(){s.value?.click()}function z(A){const E=Array.from(A?.target?.files||[]);ae(E),A?.target&&(A.target.value="")}function L(A){const P=Array.from(A.clipboardData?.items||[]).filter(F=>F.kind==="file").map(F=>F.getAsFile()).filter(Boolean);P.length&&ae(P)}function K(A){const E=Array.from(A.dataTransfer?.files||[]);E.length&&ae(E)}function ae(A){A.forEach(E=>{if(E.name.toLowerCase().endsWith(".md")){f(E);return}try{const P=URL.createObjectURL(E);v.value.push({name:E.name,type:E.type||"application/octet-stream",url:P,size:E.size||0})}catch{}}),G()}function R(A){const E=v.value[A];E?.url&&URL.revokeObjectURL(E.url),v.value.splice(A,1)}function p(){const A=k.value.trim();!A&&v.value.length===0||(m("send",{text:A,attachments:[...v.value]}),k.value="",v.value.forEach(E=>E.url&&URL.revokeObjectURL(E.url)),v.value=[],G())}async function n(){try{const A=await $fetch("/api/ai-knowledge",{method:"POST",body:{action:"get"}});d.value={hasKnowledge:A.hasKnowledge,fileName:A.fileName||"",size:A.size||0,preview:A.preview||""}}catch(A){console.error("Erro ao carregar status da base de conhecimento:",A)}}async function f(A){try{const E=new FormData;E.append("file",A);const P=await $fetch("/api/ai-knowledge",{method:"POST",body:E});P.success&&(d.value={hasKnowledge:!0,fileName:P.fileName,size:P.size,preview:P.preview||A.name.substring(0,100)+"..."},m("send",{text:`📖 Documentação "${A.name}" carregada com sucesso! Agora posso responder perguntas baseadas neste conteúdo.`,attachments:[],isSystem:!0}))}catch(E){console.error("Erro ao enviar arquivo MD:",E),m("send",{text:`❌ Erro ao carregar documentação "${A.name}". Tente novamente.`,attachments:[],isSystem:!0})}}async function V(){try{await $fetch("/api/ai-knowledge",{method:"POST",body:{action:"clear"}}),d.value={hasKnowledge:!1,fileName:"",size:0,preview:""},m("send",{text:"🗑️ Base de conhecimento limpa. Agora responderei apenas com meu conhecimento geral.",attachments:[],isSystem:!0})}catch(A){console.error("Erro ao limpar base de conhecimento:",A)}}return S({openPicker:H,nextTickScroll:G}),(A,E)=>(l(),de(xa,{to:"body"},[Y(ha,{name:"fade"},{default:ve(()=>[$.value?(l(),i("div",jl,[e("div",{class:"absolute inset-0 bg-black/60 backdrop-blur-[2px]",onClick:j}),e("div",{class:M(["relative z-10 bg-slate-800/90 text-white overflow-hidden flex flex-col w-full h-full rounded-none sm:w-auto sm:h-auto sm:max-h-[85vh] sm:rounded-2xl border border-slate-700/60 shadow-2xl backdrop-blur-md",U.value])},[e("div",Ll,[E[6]||(E[6]=e("div",{class:"absolute inset-0 bg-gradient-to-r from-purple-600/10 to-indigo-600/10 animate-pulse"},null,-1)),e("div",Gl,[E[4]||(E[4]=e("div",{class:"relative"},[e("i",{class:"fa-solid fa-robot text-purple-400 text-base drop-shadow animate-pulse"}),e("div",{class:"absolute inset-0 rounded-full bg-purple-400/20 blur-sm animate-ping"})],-1)),e("h3",Jl,I(r.title),1)]),e("button",{class:"text-slate-300 hover:text-white p-1 rounded-lg hover:bg-white/5 transition-colors",onClick:j,"aria-label":"Fechar"},[...E[5]||(E[5]=[e("i",{class:"fa-solid fa-xmark text-sm"},null,-1)])])]),d.value.hasKnowledge?(l(),i("div",Kl,[e("div",Wl,[E[8]||(E[8]=e("i",{class:"fa-solid fa-book text-emerald-400"},null,-1)),e("span",Hl," 📖 "+I(d.value.fileName)+" carregado ",1),e("button",{onClick:V,class:"ml-auto text-emerald-300 hover:text-emerald-100 text-[10px]",title:"Limpar documentação"},[...E[7]||(E[7]=[e("i",{class:"fa-solid fa-trash"},null,-1)])])]),e("div",Xl,I(d.value.size)+" caracteres · "+I(d.value.preview),1)])):w("",!0),e("div",{ref_key:"chatScrollRef",ref:y,class:M(["flex-1 overflow-y-auto px-3 py-2 space-y-2",{"drag-target":r.allowDrop}]),onDragover:E[0]||(E[0]=ke(P=>r.allowDrop&&!0,["prevent"])),onDrop:E[1]||(E[1]=ke(P=>r.allowDrop&&K,["prevent"]))},[(l(!0),i(se,null,ce(r.messages,(P,F)=>(l(),i("div",{key:F,class:M(["flex",P.role==="user"?"justify-end":"justify-start"])},[e("div",{class:M(["rounded-2xl px-3 py-2 max-w-[80%] text-[12px] leading-snug shadow-md",P.role==="user"?"bg-gradient-to-br from-purple-600 to-indigo-600 text-white shadow-lg shadow-purple-500/25":"bg-gradient-to-br from-slate-700/80 to-slate-800/80 text-slate-100 border border-slate-600/40"])},[P.content&&P.content.length?(l(),i(se,{key:0},[T(I(P.content),1)],64)):w("",!0),P.attachments?.length?(l(),i("div",Yl,[(l(!0),i(se,null,ce(P.attachments,(D,fe)=>(l(),i(se,{key:fe},[D.type?.startsWith("image/")?(l(),i("a",{key:0,href:D.url,target:"_blank",rel:"noreferrer",class:"block"},[e("img",{src:D.url,alt:D.name,class:"w-full h-20 object-cover rounded-xl shadow"},null,8,Zl)],8,Ql)):(l(),i("a",{key:1,href:D.url,target:"_blank",rel:"noreferrer",class:"text-[11px] underline break-all"},I(D.name||D.url),9,es))],64))),128))])):w("",!0)],2)],2))),128)),r.typing?(l(),i("div",ts,[...E[9]||(E[9]=[e("div",{class:"rounded-2xl px-3 py-2 max-w-[80%] bg-gradient-to-br from-slate-700/70 to-slate-800/70 border border-slate-600/30 shadow-md text-[12px] text-slate-200 flex items-center gap-1"},[e("span",null,"escrevendo"),e("span",{class:"typing-dots","aria-hidden":"true"},[e("span",{class:"dot"}),e("span",{class:"dot"}),e("span",{class:"dot"})])],-1)])])):w("",!0)],34),e("div",as,[r.allowFileUpload?(l(),i("input",{key:0,ref_key:"chatFileInput",ref:s,type:"file",class:"hidden",multiple:r.allowMultiple,accept:r.accept,onChange:z},null,40,ls)):w("",!0),r.allowFileUpload?(l(),i("button",{key:1,class:"bg-slate-700/70 hover:bg-slate-700 text-slate-200 px-2 h-9 rounded-lg text-xs shadow",title:"Anexar arquivos (arquivos .md serão carregados como documentação)",onClick:H},[...E[10]||(E[10]=[e("i",{class:"fa-solid fa-paperclip"},null,-1)])])):w("",!0),ee(e("input",{"onUpdate:modelValue":E[2]||(E[2]=P=>k.value=P),type:"text",class:"flex-1 bg-slate-700/70 border border-slate-600/60 rounded-xl h-9 px-3 text-[13px] outline-none focus:ring-[1.5px] focus:ring-purple-400/60 focus:border-purple-400/50 shadow-inner",placeholder:r.placeholder,onKeydown:cl(ke(p,["prevent"]),["enter"]),onPaste:E[3]||(E[3]=P=>r.allowPaste?L:void 0)},null,40,ss),[[ue,k.value]]),e("button",{class:"bg-gradient-to-r from-purple-600 to-indigo-600 hover:from-purple-500 hover:to-indigo-500 text-white px-3 h-9 rounded-lg text-sm disabled:opacity-50 shadow-lg transition-all duration-300 hover:shadow-purple-500/25 hover:scale-105",disabled:!k.value.trim()&&v.value.length===0,onClick:p}," Enviar ",8,os)]),v.value.length?(l(),i("div",ns,[E[12]||(E[12]=e("div",{class:"text-[11px] text-slate-400 mb-1"}," Anexos prontos para enviar ",-1)),e("div",is,[(l(!0),i(se,null,ce(v.value,(P,F)=>(l(),i("div",{key:F,class:"relative group"},[P.type.startsWith("image/")?(l(),i("img",{key:0,src:P.url,alt:P.name,class:"w-full h-20 object-cover rounded-xl border border-slate-700 shadow"},null,8,rs)):(l(),i("div",ds,I(P.name),1)),e("button",{class:"absolute -top-2 -right-2 bg-slate-800 border border-slate-600 text-white rounded-full w-5 h-5 opacity-80 hover:opacity-100 shadow",onClick:D=>R(F),"aria-label":"Remover anexo"},[...E[11]||(E[11]=[e("i",{class:"fa-solid fa-xmark text-[10px]"},null,-1)])],8,us)]))),128))])])):w("",!0)],2)])):w("",!0)]),_:1})]))}},ps=qe(cs,[["__scopeId","data-v-49707361"]]),vs=["for"],fs=["id","disabled","required"],ms={key:0,value:""},gs=["value"],bs={key:1,class:"select-error"},hs=ya({__name:"BaseSelect",props:{modelValue:{},options:{default:()=>[]},label:{},placeholder:{default:"Selecione"},size:{default:"xs"},disabled:{type:Boolean,default:!1},required:{type:Boolean,default:!1},errorMessage:{default:""}},emits:["update:modelValue"],setup(r,{emit:S}){const c=r,_=S,m=pl(),k=q({get:()=>c.modelValue??"",set:d=>_("update:modelValue",d)}),v=q(()=>[]),y=q(()=>[`select-container--${c.size}`]),s=q(()=>[`select-field--${c.size}`]);return(d,$)=>(l(),i("div",{class:M(["select-wrapper",v.value])},[d.label?(l(),i("label",{key:0,for:oe(m),class:"select-label"},I(d.label),9,vs)):w("",!0),e("div",{class:M(["select-container",y.value])},[ee(e("select",{id:oe(m),class:M(["select-field",s.value]),disabled:d.disabled,required:d.required,"onUpdate:modelValue":$[0]||($[0]=U=>k.value=U)},[d.placeholder?(l(),i("option",ms,I(d.placeholder),1)):w("",!0),(l(!0),i(se,null,ce(d.options,U=>(l(),i("option",{key:String(U.value),value:U.value},I(U.label),9,gs))),128))],10,fs),[[rt,k.value]])],2),d.errorMessage?(l(),i("p",bs,I(d.errorMessage),1)):w("",!0)],2))}}),Wt=qe(hs,[["__scopeId","data-v-35c5ab89"]]);const xs={class:"fd-wrapper"},ys={key:0,class:"fd-label"},$s=["multiple","accept"],ws={key:1,class:"fd-list"},ks={class:"fd-name"},_s={class:"fd-size"},Vs=["onClick"],Is={key:2,class:"fd-error"},Cs=ya({__name:"FileDrop",props:{label:{default:""},multiple:{type:Boolean,default:!0},accept:{default:""},error:{default:""}},emits:["files"],setup(r,{emit:S}){const c=r,_=S,m=x(null),k=x(!1),v=x([]),y=()=>m.value?.click(),s=z=>{const L=z.target;L.files&&(G(Array.from(L.files)),L.value="")},d=()=>k.value=!0,$=()=>k.value=!1,U=z=>{k.value=!1;const L=z.dataTransfer?.files;L&&G(Array.from(L))};function G(z){const L=c.multiple?[...v.value,...z]:z.length?[z[0]]:[];v.value=L,_("files",L)}const j=z=>{v.value.splice(z,1),_("files",v.value)},H=z=>{if(!z)return"0 B";const L=["B","KB","MB","GB"],K=Math.floor(Math.log(z)/Math.log(1024));return`${(z/Math.pow(1024,K)).toFixed(1)} ${L[K]}`};return(z,L)=>(l(),i("div",xs,[z.label?(l(),i("label",ys,I(z.label),1)):w("",!0),e("div",{class:M(["fd-area",{"fd-area--drag":oe(k)}]),onDragover:ke(d,["prevent"]),onDragleave:ke($,["prevent"]),onDrop:ke(U,["prevent"]),onClick:y},[$a(z.$slots,"icon",{},()=>[L[0]||(L[0]=e("i",{class:"fa-solid fa-cloud-arrow-up text-2xl text-slate-400"},null,-1))],!0),L[1]||(L[1]=e("div",{class:"fd-text"},[e("span",{class:"fd-title font-medium"},"Arraste e solte seus arquivos"),e("span",{class:"fd-sub"},"ou clique para selecionar")],-1)),e("input",{ref_key:"input",ref:m,type:"file",class:"hidden",multiple:z.multiple,accept:z.accept,onChange:s},null,40,$s)],34),oe(v).length?(l(),i("ul",ws,[(l(!0),i(se,null,ce(oe(v),(K,ae)=>(l(),i("li",{key:ae,class:"fd-item"},[e("span",ks,I(K.name),1),e("span",_s,I(H(K.size)),1),e("button",{type:"button",class:"fd-remove",onClick:ke(R=>j(ae),["stop"])}," Remover ",8,Vs)]))),128))])):w("",!0),z.error?(l(),i("p",Is,I(z.error),1)):w("",!0)]))}}),fa=qe(Cs,[["__scopeId","data-v-3d4a8ba3"]]),Ss=["for"],Ps={key:0,class:"text-red-500"},As=["id","placeholder","required","disabled"],Fs={class:"input-suffix"},Es={key:0,class:"fa-solid fa-check text-green-500 input-icon"},Bs={key:1,class:"fa-solid fa-times text-red-500 input-icon"},Us={key:2,class:"fa-solid fa-spinner fa-spin text-slate-400 input-icon"},Ds={key:1,class:"input-help"},Ns={key:0,class:"input-error"},Ms={key:1,class:"text-[10px] text-slate-400 mt-1"},zs={class:"space-y-0.5"},qs={key:0,class:"fa-solid fa-check mr-1"},Rs={key:1,class:"fa-solid fa-times mr-1"},Ts={key:0,class:"fa-solid fa-check mr-1"},Os={key:1,class:"fa-solid fa-times mr-1"},js={key:0,class:"fa-solid fa-check mr-1"},Ls={key:1,class:"fa-solid fa-times mr-1"},Ht={__name:"CpfInput",props:{modelValue:{type:String,default:""},label:{type:String,default:""},placeholder:{type:String,default:""},required:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},showValidationInfo:{type:Boolean,default:!1}},emits:["update:modelValue","validation"],setup(r,{emit:S}){const c=r,_=S,m=q(()=>`cpf-${Math.random().toString(36).slice(2,8)}`),k=x(""),v=x(null),y=x(!1),s=x(""),d=x({format:!1,math:!1,antifraude:!1}),$=q(()=>{const p=[];return c.disabled&&p.push("input-wrapper--disabled"),v.value===!1&&p.push("input-wrapper--error"),v.value===!0&&p.push("input-wrapper--success"),p}),U=q(()=>{const p=[];return p.push("input-container--xs"),p.push("input-container--default"),c.disabled&&p.push("input-container--disabled"),v.value===!1&&p.push("input-container--error"),v.value===!0&&p.push("input-container--success"),p});function G(p){const n=p.replace(/\D/g,"");return n.length<=3?n:n.length<=6?`${n.slice(0,3)}.${n.slice(3)}`:n.length<=9?`${n.slice(0,3)}.${n.slice(3,6)}.${n.slice(6)}`:`${n.slice(0,3)}.${n.slice(3,6)}.${n.slice(6,9)}-${n.slice(9,11)}`}function j(p){return p.replace(/\D/g,"")}function H(p){const n=p.replace(/\D/g,"");if(n.length!==11||/^(\d)\1{10}$/.test(n))return!1;let f=0;for(let P=0;P<9;P++)f+=parseInt(n[P])*(10-P);let V=f%11;const A=V<2?0:11-V;if(parseInt(n[9])!==A)return!1;f=0;for(let P=0;P<10;P++)f+=parseInt(n[P])*(11-P);V=f%11;const E=V<2?0:11-V;return parseInt(n[10])===E}function z(p){const n=p.replace(/\D/g,"");if(n.length!==11||["00000000000","11111111111","22222222222","33333333333","44444444444","55555555555","66666666666","77777777777","88888888888","99999999999"].includes(n)||/^(\d{3})\1{2}\d{2}$/.test(n)||/^123456789\d{2}$/.test(n)||/^987654321\d{2}$/.test(n))return!1;let V=!0;for(let A=1;A<11;A++)if(parseInt(n[A])!==parseInt(n[A-1])+1){V=!1;break}if(V)return!1;V=!0;for(let A=1;A<11;A++)if(parseInt(n[A])!==parseInt(n[A-1])-1){V=!1;break}return!V}async function L(p){if(!p.trim())return v.value=null,s.value="",d.value={format:!1,math:!1,antifraude:!1},null;y.value=!0,await new Promise(E=>setTimeout(E,300));const n=j(p),f=/^\d{11}$/.test(n);if(d.value.format=f,!f)return v.value=!1,s.value="CPF deve ter 11 dígitos",y.value=!1,_("validation",{valid:!1,cpf:n,checks:d.value}),!1;const V=H(n);if(d.value.math=V,!V)return v.value=!1,s.value="CPF com dígitos verificadores inválidos",y.value=!1,_("validation",{valid:!1,cpf:n,checks:d.value}),!1;const A=z(n);return d.value.antifraude=A,A?(v.value=!0,s.value="",y.value=!1,_("validation",{valid:!0,cpf:n,checks:d.value}),!0):(v.value=!1,s.value="CPF identificado como inválido ou teste",y.value=!1,_("validation",{valid:!1,cpf:n,checks:d.value}),!1)}function K(p){const n=p.target.value,f=G(n);k.value=f;const V=j(f);_("update:modelValue",V),v.value!==null&&(v.value=null,s.value="")}function ae(){L(k.value)}function R(){s.value=""}return pe(()=>c.modelValue,p=>{p!==j(k.value)&&(k.value=G(p||""))},{immediate:!0}),(p,n)=>(l(),i("div",{class:M(["input-wrapper",$.value])},[r.label?(l(),i("label",{key:0,for:m.value,class:"input-label"},[T(I(r.label)+" ",1),r.required?(l(),i("span",Ps,"*")):w("",!0)],8,Ss)):w("",!0),e("div",{class:M(["input-container",U.value])},[ee(e("input",{id:m.value,"onUpdate:modelValue":n[0]||(n[0]=f=>k.value=f),type:"text",placeholder:r.placeholder||"000.000.000-00",required:r.required,disabled:r.disabled,class:"input-field input-field--xs",onInput:K,onBlur:ae,onFocus:R,maxlength:"14"},null,40,As),[[ue,k.value]]),e("div",Fs,[v.value===!0?(l(),i("i",Es)):v.value===!1?(l(),i("i",Bs)):y.value?(l(),i("i",Us)):w("",!0)])],2),s.value||r.showValidationInfo&&k.value&&v.value!==null?(l(),i("div",Ds,[s.value?(l(),i("p",Ns,I(s.value),1)):w("",!0),r.showValidationInfo&&k.value&&v.value!==null?(l(),i("div",Ms,[e("div",zs,[e("div",{class:M(d.value.format?"text-green-400":"text-red-400")},[d.value.format?(l(),i("i",qs)):(l(),i("i",Rs)),n[1]||(n[1]=T(" Formato válido ",-1))],2),e("div",{class:M(d.value.math?"text-green-400":"text-red-400")},[d.value.math?(l(),i("i",Ts)):(l(),i("i",Os)),n[2]||(n[2]=T(" Dígitos verificadores ",-1))],2),e("div",{class:M(d.value.antifraude?"text-green-400":"text-red-400")},[d.value.antifraude?(l(),i("i",js)):(l(),i("i",Ls)),n[3]||(n[3]=T(" Validação antifraude ",-1))],2)])])):w("",!0)])):w("",!0)],2))}},Gs=["for"],Js={key:0,class:"text-red-500"},Ks=["id","placeholder","required","disabled"],Ws={class:"input-suffix"},Hs={key:0,class:"fa-solid fa-check text-green-500 input-icon"},Xs={key:1,class:"fa-solid fa-times text-red-500 input-icon"},Ys={key:2,class:"fa-solid fa-spinner fa-spin text-slate-400 input-icon"},Qs={key:1,class:"input-help"},Zs={key:0,class:"input-error"},eo={key:1,class:"text-[10px] text-slate-400 mt-1"},to={class:"space-y-0.5"},ao={key:0,class:"fa-solid fa-check mr-1"},lo={key:1,class:"fa-solid fa-times mr-1"},so={key:0,class:"fa-solid fa-check mr-1"},oo={key:1,class:"fa-solid fa-times mr-1"},no={key:0,class:"fa-solid fa-check mr-1"},io={key:1,class:"fa-solid fa-times mr-1"},ma={__name:"CnpjInput",props:{modelValue:{type:String,default:""},label:{type:String,default:""},placeholder:{type:String,default:""},required:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},showValidationInfo:{type:Boolean,default:!1}},emits:["update:modelValue","validation"],setup(r,{emit:S}){const c=r,_=S,m=q(()=>`cnpj-${Math.random().toString(36).slice(2,8)}`),k=x(""),v=x(null),y=x(!1),s=x(""),d=x({format:!1,math:!1,antifraude:!1}),$=q(()=>{const p=[];return c.disabled&&p.push("input-wrapper--disabled"),v.value===!1&&p.push("input-wrapper--error"),v.value===!0&&p.push("input-wrapper--success"),p}),U=q(()=>{const p=[];return p.push("input-container--xs"),p.push("input-container--default"),c.disabled&&p.push("input-container--disabled"),v.value===!1&&p.push("input-container--error"),v.value===!0&&p.push("input-container--success"),p});function G(p){const n=p.replace(/\D/g,"");return n.length<=2?n:n.length<=5?`${n.slice(0,2)}.${n.slice(2)}`:n.length<=8?`${n.slice(0,2)}.${n.slice(2,5)}.${n.slice(5)}`:n.length<=12?`${n.slice(0,2)}.${n.slice(2,5)}.${n.slice(5,8)}/${n.slice(8)}`:`${n.slice(0,2)}.${n.slice(2,5)}.${n.slice(5,8)}/${n.slice(8,12)}-${n.slice(12,14)}`}function j(p){return p.replace(/\D/g,"")}function H(p){const n=p.replace(/\D/g,"");if(n.length!==14||/^(\d)\1{13}$/.test(n))return!1;let f=0;const V=[5,4,3,2,9,8,7,6,5,4,3,2];for(let D=0;D<12;D++)f+=parseInt(n[D])*V[D];let A=f%11;const E=A<2?0:11-A;if(parseInt(n[12])!==E)return!1;f=0;const P=[6,5,4,3,2,9,8,7,6,5,4,3,2];for(let D=0;D<13;D++)f+=parseInt(n[D])*P[D];A=f%11;const F=A<2?0:11-A;return parseInt(n[13])===F}function z(p){const n=p.replace(/\D/g,"");return!(n.length!==14||["00000000000000","11111111111111","22222222222222","33333333333333","44444444444444","55555555555555","66666666666666","77777777777777","88888888888888","99999999999999"].includes(n)||/^123456789012\d{2}$/.test(n)||/^987654321098\d{2}$/.test(n))}async function L(p){if(!p.trim())return v.value=null,s.value="",d.value={format:!1,math:!1,antifraude:!1},null;y.value=!0,await new Promise(E=>setTimeout(E,300));const n=j(p),f=/^\d{14}$/.test(n);if(d.value.format=f,!f)return v.value=!1,s.value="CNPJ deve ter 14 dígitos",y.value=!1,_("validation",{valid:!1,cnpj:n,checks:d.value}),!1;const V=H(n);if(d.value.math=V,!V)return v.value=!1,s.value="CNPJ com dígitos verificadores inválidos",y.value=!1,_("validation",{valid:!1,cnpj:n,checks:d.value}),!1;const A=z(n);return d.value.antifraude=A,A?(v.value=!0,s.value="",y.value=!1,_("validation",{valid:!0,cnpj:n,checks:d.value}),!0):(v.value=!1,s.value="CNPJ identificado como inválido ou teste",y.value=!1,_("validation",{valid:!1,cnpj:n,checks:d.value}),!1)}function K(p){const n=p.target.value,f=G(n);k.value=f;const V=j(f);_("update:modelValue",V),v.value!==null&&(v.value=null,s.value="")}function ae(){L(k.value)}function R(){s.value=""}return pe(()=>c.modelValue,p=>{p!==j(k.value)&&(k.value=G(p||""))},{immediate:!0}),(p,n)=>(l(),i("div",{class:M(["input-wrapper",$.value])},[r.label?(l(),i("label",{key:0,for:m.value,class:"input-label"},[T(I(r.label)+" ",1),r.required?(l(),i("span",Js,"*")):w("",!0)],8,Gs)):w("",!0),e("div",{class:M(["input-container",U.value])},[ee(e("input",{id:m.value,"onUpdate:modelValue":n[0]||(n[0]=f=>k.value=f),type:"text",placeholder:r.placeholder||"00.000.000/0000-00",required:r.required,disabled:r.disabled,class:"input-field input-field--xs",onInput:K,onBlur:ae,onFocus:R,maxlength:"18"},null,40,Ks),[[ue,k.value]]),e("div",Ws,[v.value===!0?(l(),i("i",Hs)):v.value===!1?(l(),i("i",Xs)):y.value?(l(),i("i",Ys)):w("",!0)])],2),s.value||r.showValidationInfo&&k.value&&v.value!==null?(l(),i("div",Qs,[s.value?(l(),i("p",Zs,I(s.value),1)):w("",!0),r.showValidationInfo&&k.value&&v.value!==null?(l(),i("div",eo,[e("div",to,[e("div",{class:M(d.value.format?"text-green-400":"text-red-400")},[d.value.format?(l(),i("i",ao)):(l(),i("i",lo)),n[1]||(n[1]=T(" Formato válido ",-1))],2),e("div",{class:M(d.value.math?"text-green-400":"text-red-400")},[d.value.math?(l(),i("i",so)):(l(),i("i",oo)),n[2]||(n[2]=T(" Dígitos verificadores ",-1))],2),e("div",{class:M(d.value.antifraude?"text-green-400":"text-red-400")},[d.value.antifraude?(l(),i("i",no)):(l(),i("i",io)),n[3]||(n[3]=T(" Validação antifraude ",-1))],2)])])):w("",!0)])):w("",!0)],2))}},ro=["for"],uo={key:0,class:"text-red-500"},co=["id","placeholder","required","disabled"],po={class:"input-suffix"},vo={key:0,class:"fa-solid fa-check text-green-500 input-icon"},fo={key:1,class:"fa-solid fa-times text-red-500 input-icon"},mo={key:2,class:"fa-solid fa-spinner fa-spin text-slate-400 input-icon"},go={key:1,class:"input-help"},bo={key:0,class:"input-error"},ho={key:1,class:"text-[10px] text-slate-400 mt-1"},xo={class:"space-y-0.5"},yo={key:0,class:"fa-solid fa-check mr-1"},$o={key:1,class:"fa-solid fa-times mr-1"},wo={key:0,class:"fa-solid fa-check mr-1"},ko={key:1,class:"fa-solid fa-times mr-1"},_o={key:0,class:"fa-solid fa-check mr-1"},Vo={key:1,class:"fa-solid fa-times mr-1"},Xt={__name:"RgInput",props:{modelValue:{type:String,default:""},label:{type:String,default:""},placeholder:{type:String,default:""},required:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},showValidationInfo:{type:Boolean,default:!1}},emits:["update:modelValue","validation"],setup(r,{emit:S}){const c=r,_=S,m=q(()=>`rg-${Math.random().toString(36).slice(2,8)}`),k=x(""),v=x(null),y=x(!1),s=x(""),d=x({format:!1,length:!1,pattern:!1}),$=q(()=>{const R=[];return c.disabled&&R.push("input-wrapper--disabled"),v.value===!1&&R.push("input-wrapper--error"),v.value===!0&&R.push("input-wrapper--success"),R}),U=q(()=>{const R=[];return R.push("input-container--xs"),R.push("input-container--default"),c.disabled&&R.push("input-container--disabled"),v.value===!1&&R.push("input-container--error"),v.value===!0&&R.push("input-container--success"),R});function G(R){const p=R.replace(/[^\dA-Za-z]/g,"").toUpperCase();return p.length<=2?p:p.length<=5?`${p.slice(0,2)}.${p.slice(2)}`:p.length<=8?`${p.slice(0,2)}.${p.slice(2,5)}.${p.slice(5)}`:`${p.slice(0,2)}.${p.slice(2,5)}.${p.slice(5,8)}-${p.slice(8,9)}`}function j(R){return R.replace(/[^\dA-Za-z]/g,"").toUpperCase()}function H(R){const p=j(R),n=/^[0-9]{8}[0-9A-Z]?$/.test(p),f=p.length>=7&&p.length<=9,V=!/^(\d)\1+$/.test(p)&&p!=="000000000";return{format:n,length:f,pattern:V}}async function z(R){if(!R.trim())return v.value=null,s.value="",d.value={format:!1,length:!1,pattern:!1},null;y.value=!0,await new Promise(V=>setTimeout(V,200));const p=j(R),n=H(R);d.value=n;const f=n.format&&n.length&&n.pattern;return n.length?n.format?n.pattern?(v.value=!0,s.value=""):(v.value=!1,s.value="RG não pode ter todos os dígitos iguais"):(v.value=!1,s.value="Formato de RG inválido"):(v.value=!1,s.value="RG deve ter entre 7 e 9 caracteres"),y.value=!1,_("validation",{valid:f,rg:p,checks:n}),f}function L(R){const p=R.target.value,n=G(p);k.value=n;const f=j(n);_("update:modelValue",f),v.value!==null&&(v.value=null,s.value="")}function K(){z(k.value)}function ae(){s.value=""}return pe(()=>c.modelValue,R=>{R!==j(k.value)&&(k.value=G(R||""))},{immediate:!0}),(R,p)=>(l(),i("div",{class:M(["input-wrapper",$.value])},[r.label?(l(),i("label",{key:0,for:m.value,class:"input-label"},[T(I(r.label)+" ",1),r.required?(l(),i("span",uo,"*")):w("",!0)],8,ro)):w("",!0),e("div",{class:M(["input-container",U.value])},[ee(e("input",{id:m.value,"onUpdate:modelValue":p[0]||(p[0]=n=>k.value=n),type:"text",placeholder:r.placeholder||"00.000.000-0",required:r.required,disabled:r.disabled,class:"input-field input-field--xs",onInput:L,onBlur:K,onFocus:ae,maxlength:"12"},null,40,co),[[ue,k.value]]),e("div",po,[v.value===!0?(l(),i("i",vo)):v.value===!1?(l(),i("i",fo)):y.value?(l(),i("i",mo)):w("",!0)])],2),s.value||r.showValidationInfo&&k.value&&v.value!==null?(l(),i("div",go,[s.value?(l(),i("p",bo,I(s.value),1)):w("",!0),r.showValidationInfo&&k.value&&v.value!==null?(l(),i("div",ho,[e("div",xo,[e("div",{class:M(d.value.format?"text-green-400":"text-red-400")},[d.value.format?(l(),i("i",yo)):(l(),i("i",$o)),p[1]||(p[1]=T(" Formato válido ",-1))],2),e("div",{class:M(d.value.length?"text-green-400":"text-red-400")},[d.value.length?(l(),i("i",wo)):(l(),i("i",ko)),p[2]||(p[2]=T(" Comprimento adequado ",-1))],2),e("div",{class:M(d.value.pattern?"text-green-400":"text-red-400")},[d.value.pattern?(l(),i("i",_o)):(l(),i("i",Vo)),p[3]||(p[3]=T(" Padrão válido ",-1))],2)])])):w("",!0)])):w("",!0)],2))}},Io=["for"],Co={key:0,class:"text-red-500"},So=["id","placeholder","required","disabled"],Po={class:"input-suffix"},Ao={key:0,class:"fa-solid fa-check text-green-500 input-icon"},Fo={key:1,class:"fa-solid fa-times text-red-500 input-icon"},Eo={key:2,class:"fa-solid fa-spinner fa-spin text-slate-400 input-icon"},Bo={key:1,class:"input-help"},Uo={key:0,class:"input-error"},Do={key:1,class:"text-[10px] text-slate-400 mt-1"},No={class:"bg-slate-900/50 p-2 rounded border border-slate-700/40"},Mo={class:"font-medium text-slate-300"},zo={key:2,class:"text-[10px] text-slate-400 mt-1"},qo={class:"space-y-0.5"},Ro={key:0,class:"fa-solid fa-check mr-1"},To={key:1,class:"fa-solid fa-times mr-1"},Oo={key:0,class:"fa-solid fa-check mr-1"},jo={key:1,class:"fa-solid fa-times mr-1"},ga={__name:"CepInput",props:{modelValue:{type:String,default:""},label:{type:String,default:""},placeholder:{type:String,default:""},required:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},showValidationInfo:{type:Boolean,default:!1},autoFetchAddress:{type:Boolean,default:!0}},emits:["update:modelValue","validation","address"],setup(r,{emit:S}){const c=r,_=S,m=q(()=>`cep-${Math.random().toString(36).slice(2,8)}`),k=x(""),v=x(null),y=x(!1),s=x(""),d=x(null),$=x({format:!1,exists:null}),U=q(()=>{const p=[];return c.disabled&&p.push("input-wrapper--disabled"),v.value===!1&&p.push("input-wrapper--error"),v.value===!0&&p.push("input-wrapper--success"),p}),G=q(()=>{const p=[];return p.push("input-container--xs"),c.disabled&&p.push("input-container--disabled"),v.value===!1&&p.push("input-container--error"),v.value===!0&&p.push("input-container--success"),p});function j(p){const n=p.replace(/\D/g,"");return n.length<=5?n:`${n.slice(0,5)}-${n.slice(5,8)}`}function H(p){return p.replace(/\D/g,"")}async function z(p){try{const f=await(await fetch(`https://viacep.com.br/ws/${p}/json/`)).json();return f.erro?null:{cep:f.cep,logradouro:f.logradouro,complemento:f.complemento,bairro:f.bairro,localidade:f.localidade,uf:f.uf,ibge:f.ibge,gia:f.gia,ddd:f.ddd,siafi:f.siafi}}catch(n){return console.warn("Erro ao buscar CEP:",n),null}}async function L(p){if(!p.trim())return v.value=null,s.value="",d.value=null,$.value={format:!1,exists:null},null;y.value=!0;const n=H(p),f=/^\d{8}$/.test(n);if($.value.format=f,!f)return v.value=!1,s.value="CEP deve ter 8 dígitos",d.value=null,$.value.exists=null,y.value=!1,_("validation",{valid:!1,cep:n,checks:$.value}),!1;if(c.autoFetchAddress){const V=await z(n);V?($.value.exists=!0,d.value=V,v.value=!0,s.value="",_("address",V)):($.value.exists=!1,d.value=null,v.value=!1,s.value="CEP não encontrado")}else $.value.exists=!0,v.value=!0,s.value="";return y.value=!1,_("validation",{valid:v.value,cep:n,address:d.value,checks:$.value}),v.value}function K(p){const n=p.target.value,f=j(n);k.value=f;const V=H(f);_("update:modelValue",V),v.value!==null&&(v.value=null,s.value="",d.value=null)}function ae(){L(k.value)}function R(){s.value=""}return pe(()=>c.modelValue,p=>{p!==H(k.value)&&(k.value=j(p||""))},{immediate:!0}),(p,n)=>(l(),i("div",{class:M(["input-wrapper",U.value])},[r.label?(l(),i("label",{key:0,for:m.value,class:"input-label"},[T(I(r.label)+" ",1),r.required?(l(),i("span",Co,"*")):w("",!0)],8,Io)):w("",!0),e("div",{class:M(["input-container",G.value])},[ee(e("input",{id:m.value,"onUpdate:modelValue":n[0]||(n[0]=f=>k.value=f),type:"text",placeholder:r.placeholder||"00000-000",required:r.required,disabled:r.disabled,class:"input-field input-field--xs",onInput:K,onBlur:ae,onFocus:R,maxlength:"9"},null,40,So),[[ue,k.value]]),e("div",Po,[v.value===!0?(l(),i("i",Ao)):v.value===!1?(l(),i("i",Fo)):y.value?(l(),i("i",Eo)):w("",!0)])],2),s.value||d.value||r.showValidationInfo&&k.value&&v.value!==null?(l(),i("div",Bo,[s.value?(l(),i("p",Uo,I(s.value),1)):w("",!0),d.value&&v.value===!0?(l(),i("div",Do,[e("div",No,[e("div",Mo,I(d.value.logradouro),1),e("div",null,I(d.value.bairro)+", "+I(d.value.localidade)+"/"+I(d.value.uf),1)])])):w("",!0),r.showValidationInfo&&k.value&&v.value!==null?(l(),i("div",zo,[e("div",qo,[e("div",{class:M($.value.format?"text-green-400":"text-red-400")},[$.value.format?(l(),i("i",Ro)):(l(),i("i",To)),n[1]||(n[1]=T(" Formato válido ",-1))],2),$.value.exists!==null?(l(),i("div",{key:0,class:M($.value.exists?"text-green-400":"text-red-400")},[$.value.exists?(l(),i("i",Oo)):(l(),i("i",jo)),n[2]||(n[2]=T(" CEP existe ",-1))],2)):w("",!0)])])):w("",!0)])):w("",!0)],2))}},Lo=["for"],Go={key:0,class:"text-red-500"},Jo=["id","placeholder","required","disabled"],Ko={class:"input-suffix"},Wo={key:0,class:"fa-solid fa-check text-green-500 input-icon"},Ho={key:1,class:"fa-solid fa-times text-red-500 input-icon"},Xo={key:2,class:"fa-solid fa-spinner fa-spin text-slate-400 input-icon"},Yo={key:1,class:"input-help"},Qo={key:0,class:"input-error"},Zo={key:1,class:"text-[10px] text-slate-400 mt-1"},en={class:"bg-slate-900/50 p-2 rounded border border-slate-700/40"},tn={class:"flex items-center gap-2 text-slate-300"},an={class:"font-medium"},ln={key:2,class:"text-[10px] text-slate-400 mt-1"},sn={class:"space-y-0.5"},on={key:0,class:"fa-solid fa-check mr-1"},nn={key:1,class:"fa-solid fa-times mr-1"},rn={key:0,class:"fa-solid fa-check mr-1"},dn={key:1,class:"fa-solid fa-times mr-1"},un={key:0,class:"fa-solid fa-check mr-1"},cn={key:1,class:"fa-solid fa-times mr-1"},Yt={__name:"TelefoneInput",props:{modelValue:{type:String,default:""},label:{type:String,default:""},placeholder:{type:String,default:""},required:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},showValidationInfo:{type:Boolean,default:!1}},emits:["update:modelValue","validation"],setup(r,{emit:S}){const c=r,_=S,m=q(()=>`telefone-${Math.random().toString(36).slice(2,8)}`),k=x(""),v=x(null),y=x(!1),s=x(""),d=x(null),$=x({format:!1,ddd:!1,type:!1}),U=q(()=>{const f=[];return c.disabled&&f.push("input-wrapper--disabled"),v.value===!1&&f.push("input-wrapper--error"),v.value===!0&&f.push("input-wrapper--success"),f}),G=q(()=>{const f=[];return f.push("input-container--xs"),f.push("input-container--default"),c.disabled&&f.push("input-container--disabled"),v.value===!1&&f.push("input-container--error"),v.value===!0&&f.push("input-container--success"),f}),j={11:"São Paulo - SP",12:"São José dos Campos - SP",13:"Santos - SP",14:"Bauru - SP",15:"Sorocaba - SP",16:"Ribeirão Preto - SP",17:"São José do Rio Preto - SP",18:"Presidente Prudente - SP",19:"Campinas - SP",21:"Rio de Janeiro - RJ",22:"Campos dos Goytacazes - RJ",24:"Volta Redonda - RJ",27:"Vitória - ES",28:"Cachoeiro de Itapemirim - ES",31:"Belo Horizonte - MG",32:"Juiz de Fora - MG",33:"Governador Valadares - MG",34:"Uberlândia - MG",35:"Poços de Caldas - MG",37:"Divinópolis - MG",38:"Montes Claros - MG",41:"Curitiba - PR",42:"Ponta Grossa - PR",43:"Londrina - PR",44:"Maringá - PR",45:"Cascavel - PR",46:"Francisco Beltrão - PR",47:"Joinville - SC",48:"Florianópolis - SC",49:"Chapecó - SC",51:"Porto Alegre - RS",53:"Pelotas - RS",54:"Caxias do Sul - RS",55:"Santa Maria - RS",61:"Brasília - DF",62:"Goiânia - GO",63:"Palmas - TO",64:"Rio Verde - GO",65:"Cuiabá - MT",66:"Rondonópolis - MT",67:"Campo Grande - MS",68:"Rio Branco - AC",69:"Porto Velho - RO",71:"Salvador - BA",73:"Ilhéus - BA",74:"Juazeiro - BA",75:"Feira de Santana - BA",77:"Vitória da Conquista - BA",79:"Aracaju - SE",81:"Recife - PE",82:"Maceió - AL",83:"João Pessoa - PB",84:"Natal - RN",85:"Fortaleza - CE",86:"Teresina - PI",87:"Petrolina - PE",88:"Juazeiro do Norte - CE",89:"Picos - PI",91:"Belém - PA",92:"Manaus - AM",93:"Santarém - PA",94:"Marabá - PA",95:"Boa Vista - RR",96:"Macapá - AP",97:"Coari - AM",98:"São Luís - MA",99:"Imperatriz - MA"},H=q(()=>d.value&&d.value.type==="Celular"?"fa-solid fa-mobile-screen":"fa-solid fa-phone");function z(f){const V=f.replace(/\D/g,"");return V.length<=2?V:V.length<=6?`(${V.slice(0,2)}) ${V.slice(2)}`:V.length<=10?`(${V.slice(0,2)}) ${V.slice(2,6)}-${V.slice(6)}`:`(${V.slice(0,2)}) ${V.slice(2,7)}-${V.slice(7,11)}`}function L(f){return f.replace(/\D/g,"")}function K(f){const V=L(f);if(V.length<10)return null;const A=parseInt(V.slice(0,2)),E=parseInt(V[2]);if(!j[A])return null;let P="Fixo";return(V.length===11&&E===9||V.length===10&&[6,7,8,9].includes(E))&&(P="Celular"),{type:P,ddd:A.toString().padStart(2,"0"),region:j[A],number:V,formatted:z(V)}}async function ae(f){if(!f.trim())return v.value=null,s.value="",d.value=null,$.value={format:!1,ddd:!1,type:!1},null;y.value=!0,await new Promise(P=>setTimeout(P,200));const V=L(f),A=/^\d{10,11}$/.test(V);if($.value.format=A,!A)return v.value=!1,s.value="Telefone deve ter 10 ou 11 dígitos",d.value=null,$.value.ddd=!1,$.value.type=!1,y.value=!1,_("validation",{valid:!1,phone:V,checks:$.value}),!1;const E=K(V);return E?(v.value=!0,s.value="",d.value=E,$.value.ddd=!0,$.value.type=!0):(v.value=!1,s.value="DDD inválido",d.value=null,$.value.ddd=!1,$.value.type=!1),y.value=!1,_("validation",{valid:v.value,phone:V,info:d.value,checks:$.value}),v.value}function R(f){const V=f.target.value,A=z(V);k.value=A;const E=L(A);_("update:modelValue",E),v.value!==null&&(v.value=null,s.value="",d.value=null)}function p(){ae(k.value)}function n(){s.value=""}return pe(()=>c.modelValue,f=>{f!==L(k.value)&&(k.value=z(f||""))},{immediate:!0}),(f,V)=>(l(),i("div",{class:M(["input-wrapper",U.value])},[r.label?(l(),i("label",{key:0,for:m.value,class:"input-label"},[T(I(r.label)+" ",1),r.required?(l(),i("span",Go,"*")):w("",!0)],8,Lo)):w("",!0),e("div",{class:M(["input-container",G.value])},[ee(e("input",{id:m.value,"onUpdate:modelValue":V[0]||(V[0]=A=>k.value=A),type:"text",placeholder:r.placeholder||"(00) 00000-0000",required:r.required,disabled:r.disabled,class:"input-field input-field--xs",onInput:R,onBlur:p,onFocus:n,maxlength:"15"},null,40,Jo),[[ue,k.value]]),e("div",Ko,[v.value===!0?(l(),i("i",Wo)):v.value===!1?(l(),i("i",Ho)):y.value?(l(),i("i",Xo)):w("",!0)])],2),s.value||d.value||r.showValidationInfo&&k.value&&v.value!==null?(l(),i("div",Yo,[s.value?(l(),i("p",Qo,I(s.value),1)):w("",!0),d.value&&v.value===!0?(l(),i("div",Zo,[e("div",en,[e("div",tn,[e("i",{class:M([H.value,"text-sm"])},null,2),e("span",an,I(d.value.type)+" - "+I(d.value.region),1)])])])):w("",!0),r.showValidationInfo&&k.value&&v.value!==null?(l(),i("div",ln,[e("div",sn,[e("div",{class:M($.value.format?"text-green-400":"text-red-400")},[$.value.format?(l(),i("i",on)):(l(),i("i",nn)),V[1]||(V[1]=T(" Formato válido ",-1))],2),e("div",{class:M($.value.ddd?"text-green-400":"text-red-400")},[$.value.ddd?(l(),i("i",rn)):(l(),i("i",dn)),V[2]||(V[2]=T(" DDD válido ",-1))],2),e("div",{class:M($.value.type?"text-green-400":"text-red-400")},[$.value.type?(l(),i("i",un)):(l(),i("i",cn)),V[3]||(V[3]=T(" Tipo identificado ",-1))],2)])])):w("",!0)])):w("",!0)],2))}},pn={class:"endereco-container space-y-1"},vn={class:"text-[12px] font-medium text-slate-300 mb-1 flex items-center gap-1"},fn={key:0,class:"text-red-500"},mn={class:"space-y-1 mb-2"},gn={key:0,class:"text-red-500"},bn={class:"input-container input-container--xs input-container--default"},hn=["placeholder","required","disabled"],xn={key:0,class:"text-red-500"},yn=["placeholder","required","disabled"],$n=["disabled"],wn={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-1"},kn={class:"input-container input-container--xs input-container--default"},_n=["disabled"],Vn=["disabled"],In=["disabled"],Cn={class:"input-container input-container--xs input-container--default"},Sn=["disabled"],Pn={class:"input-container input-container--xs input-container--default"},An=["disabled"],Fn={class:"address-fields space-y-1"},En={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-1"},Bn={class:"cep-field"},Un=["disabled"],Dn={key:0,class:"text-red-500"},Nn={class:"input-container input-container--xs input-container--default"},Mn=["required","disabled"],zn={key:0,class:"text-red-500"},qn={class:"input-container input-container--xs input-container--default"},Rn=["required","disabled"],Tn={class:"lg:col-span-3 sm:col-span-2"},On={key:0,class:"text-red-500"},jn={class:"input-container input-container--xs input-container--default"},Ln=["required","disabled"],Gn={key:0,class:"text-red-500"},Jn={class:"input-container input-container--xs input-container--default"},Kn=["required","disabled"],Wn={class:"input-container input-container--xs input-container--default"},Hn=["disabled"],Xn={key:0,class:"text-red-500"},Yn={class:"input-container input-container--xs input-container--default"},Qn=["required","disabled"],Zn={class:"mt-3"},ei={class:"input-container input-container--textarea input-container--default"},ti=["disabled"],ai={class:"flex justify-between items-center mt-1"},li={class:"text-xs text-slate-400"},si={__name:"EnderecoInput",props:{modelValue:{type:Object,default:()=>({})},label:{type:String,default:"Endereço"},required:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},autoFillFromCep:{type:Boolean,default:!0}},emits:["update:modelValue","validation","cep-found"],setup(r,{emit:S}){const c=r,_=S,m=Math.random().toString(36).slice(2,8),k=`endereco-documento-${m}`,v=`endereco-nome-${m}`,y=`endereco-email-${m}`,s=`endereco-telefone-${m}`,d=`endereco-telefone2-${m}`,$=`endereco-ie-${m}`,U=`endereco-nascimento-${m}`,G=`endereco-mae-${m}`,j=`endereco-observacoes-${m}`,H=`endereco-cep-${m}`,z=`endereco-logradouro-${m}`,L=`endereco-numero-${m}`,K=`endereco-complemento-${m}`,ae=`endereco-bairro-${m}`,R=`endereco-cidade-${m}`,p=`endereco-uf-${m}`,n=x(""),f=x(null),V=x(""),A=x(""),E=x(null),P=x(""),F=x(null),D=x(""),fe=x(null),Ae=x(""),he=x(null),je=x(!1),dt=x(!0),O=x({documento:"",nome:"",email:"",telefone:"",telefone2:"",inscricaoEstadual:"",dataNascimento:"",nomeMae:"",observacoes:"",cep:"",logradouro:"",numero:"",complemento:"",bairro:"",cidade:"",uf:""}),Q=x({cep:"",logradouro:"",numero:"",complemento:"",bairro:"",cidade:"",uf:""}),X=q(()=>V.value==="PJ"?"CNPJ":V.value==="PF"?"CPF":"Numero Fiscal"),et=q(()=>V.value==="PJ"?"Razão Social":V.value==="PF"?"Nome Completo":"Nome/Razão Social"),ut=q(()=>{const g=[];return c.disabled&&g.push("input-container--disabled"),f.value===!1&&g.push("input-container--error"),f.value===!0&&g.push("input-container--success"),g}),Le=q(()=>{const g=[];return c.disabled&&g.push("input-container--disabled"),E.value===!1&&g.push("input-container--error"),E.value===!0&&g.push("input-container--success"),g}),Z=q(()=>{const g=[];return c.disabled&&g.push("input-container--disabled"),F.value===!1&&g.push("input-container--error"),F.value===!0&&g.push("input-container--success"),g}),wt=q(()=>{const g=[];return c.disabled&&g.push("input-container--disabled"),fe.value===!1&&g.push("input-container--error"),fe.value===!0&&g.push("input-container--success"),g}),ge=q(()=>{const g=[];return c.disabled&&g.push("input-container--disabled"),he.value===!1&&g.push("input-container--error"),he.value===!0&&g.push("input-container--success"),g});function Pe(g){const u=g.replace(/\D/g,"");return u.length===11?"PF":u.length===14||u.length>=12?"PJ":u.length>=1?"PF":""}function Ee(g){const u=g.replace(/\D/g,"");return u.length<=11?u.length<=3?u:u.length<=6?`${u.slice(0,3)}.${u.slice(3)}`:u.length<=9?`${u.slice(0,3)}.${u.slice(3,6)}.${u.slice(6)}`:`${u.slice(0,3)}.${u.slice(3,6)}.${u.slice(6,9)}-${u.slice(9,11)}`:u.length<=2?u:u.length<=5?`${u.slice(0,2)}.${u.slice(2)}`:u.length<=8?`${u.slice(0,2)}.${u.slice(2,5)}.${u.slice(5)}`:u.length<=12?`${u.slice(0,2)}.${u.slice(2,5)}.${u.slice(5,8)}/${u.slice(8)}`:`${u.slice(0,2)}.${u.slice(2,5)}.${u.slice(5,8)}/${u.slice(8,12)}-${u.slice(12,14)}`}function kt(g){if(g=g.replace(/\D/g,""),g.length!==11||/^(\d)\1{10}$/.test(g))return!1;let u=0;for(let ne=0;ne<9;ne++)u+=parseInt(g.charAt(ne))*(10-ne);let C=u*10%11;if((C===10||C===11)&&(C=0),C!==parseInt(g.charAt(9)))return!1;u=0;for(let ne=0;ne<10;ne++)u+=parseInt(g.charAt(ne))*(11-ne);return C=u*10%11,(C===10||C===11)&&(C=0),C===parseInt(g.charAt(10))}function ct(g){if(g=g.replace(/\D/g,""),g.length!==14||/^(\d)\1{13}$/.test(g))return!1;let u=g.length-2,C=g.substring(0,u),ne=g.substring(u),ie=0,be=u-7;for(let Ce=u;Ce>=1;Ce--)ie+=C.charAt(u-Ce)*be--,be<2&&(be=9);let De=ie%11<2?0:11-ie%11;if(De!==parseInt(ne.charAt(0)))return!1;u=u+1,C=g.substring(0,u),ie=0,be=u-7;for(let Ce=u;Ce>=1;Ce--)ie+=C.charAt(u-Ce)*be--,be<2&&(be=9);return De=ie%11<2?0:11-ie%11,De===parseInt(ne.charAt(1))}function tt(g){const u=g.replace(/\D/g,"");return u.length<=5?u:`${u.slice(0,5)}-${u.slice(5,8)}`}async function pt(g){try{const C=await(await fetch(`https://viacep.com.br/ws/${g}/json/`)).json();return C.erro?null:{cep:C.cep,logradouro:C.logradouro,complemento:C.complemento,bairro:C.bairro,cidade:C.localidade,uf:C.uf,ibge:C.ibge,gia:C.gia,ddd:C.ddd,siafi:C.siafi}}catch(u){return console.warn("Erro ao buscar CEP:",u),null}}async function _t(g){if(!g.trim())return he.value=null,Q.value.cep="",me(),null;je.value=!0;const u=g.replace(/\D/g,"");if(!/^\d{8}$/.test(u))return he.value=!1,je.value=!1,Q.value.cep=u,me(),!1;if(c.autoFillFromCep){const C=await pt(u);C?(he.value=!0,Q.value={cep:u,logradouro:C.logradouro,numero:Q.value.numero||"",complemento:C.complemento||Q.value.complemento||"",bairro:C.bairro,cidade:C.cidade,uf:C.uf},me(),_("cep-found",C)):(he.value=!1,Q.value.cep=u,me())}else he.value=!0,Q.value.cep=u,me();return je.value=!1,he.value}function Re(g){const u=g.target.value,C=Ee(u);n.value=C;const ne=Pe(u);V.value!==ne&&(V.value=ne),Ge(C)}function at(){try{Ge(n.value)}catch(g){console.warn("Erro em handleDocumentBlur:",g)}}function vt(){}function Ge(g){try{if(!g||!O.value)return null;const u=g.replace(/\D/g,"");return u.trim()?(V.value==="PF"&&u.length===11?kt(u)?f.value=!0:f.value=!1:V.value==="PJ"&&u.length===14?ct(u)?f.value=!0:f.value=!1:f.value=null,O.value.documento=u,J(),f.value):(f.value=null,O.value.documento="",J(),null)}catch(u){return console.warn("Erro em validateDocument:",u),null}}function Fe(g){const u=g.replace(/\D/g,"");return u.length<=2?u:u.length<=6?`(${u.slice(0,2)}) ${u.slice(2)}`:u.length<=10?`(${u.slice(0,2)}) ${u.slice(2,6)}-${u.slice(6)}`:`(${u.slice(0,2)}) ${u.slice(2,7)}-${u.slice(7,11)}`}function Je(g){const u=g.replace(/\D/g,"");return u.trim()?(u.length>=10&&u.length<=11?E.value=!0:u.length>11?E.value=!1:E.value=null,O.value.telefone=u,J(),E.value):(E.value=null,O.value.telefone="",J(),null)}function Vt(g){const u=g.target.value,C=Fe(u);A.value=C,Je(C)}function It(){Je(A.value)}function Ke(g){const u=g.replace(/\D/g,"");return u.trim()?(u.length>=10&&u.length<=11?F.value=!0:u.length>11?F.value=!1:F.value=null,O.value.telefone2=u,J(),F.value):(F.value=null,O.value.telefone2="",J(),null)}function Ct(g){const u=g.target.value,C=Fe(u);P.value=C,Ke(C)}function St(){Ke(P.value)}function Be(g){const u=g.replace(/\D/g,"");return u.length<=2?u:u.length<=4?`${u.slice(0,2)}/${u.slice(2)}`:`${u.slice(0,2)}/${u.slice(2,4)}/${u.slice(4,8)}`}function We(g){const u=g.replace(/\D/g,"");if(!u.trim())return fe.value=null,O.value.dataNascimento="",J(),null;if(u.length===8){const C=parseInt(u.slice(0,2)),ne=parseInt(u.slice(2,4)),ie=parseInt(u.slice(4,8));if(C>=1&&C<=31&&ne>=1&&ne<=12&&ie>=1900&&ie<=new Date().getFullYear()){const be=new Date(ie,ne-1,C);be.getDate()===C&&be.getMonth()===ne-1&&be.getFullYear()===ie?(fe.value=!0,O.value.dataNascimento=`${u.slice(0,2)}/${u.slice(2,4)}/${u.slice(4,8)}`):(fe.value=!1,O.value.dataNascimento=g)}else fe.value=!1,O.value.dataNascimento=g}else fe.value=null,O.value.dataNascimento=g;return J(),fe.value}function lt(g){const u=g.target.value,C=Be(u);D.value=C,We(C)}function Pt(){We(D.value)}function Ue(g){const u=g.target.value,C=tt(u);Ae.value=C,he.value!==null&&(he.value=null)}function _e(){_t(Ae.value)}function He(){}function J(){try{if(!O.value)return;_("update:modelValue",{...O.value});const g=O.value.documento&&O.value.nome&&O.value.cep&&O.value.logradouro&&O.value.numero&&O.value.bairro&&O.value.cidade&&O.value.uf;_("validation",{valid:g,dados:O.value,tipoPessoa:V.value,tipoDocumento:X.value})}catch(g){console.warn("Erro em updateDadosValue:",g)}}function me(){O.value.cep=Q.value.cep,O.value.logradouro=Q.value.logradouro,O.value.numero=Q.value.numero,O.value.complemento=Q.value.complemento,O.value.bairro=Q.value.bairro,O.value.cidade=Q.value.cidade,O.value.uf=Q.value.uf,J()}return pe(()=>c.modelValue,g=>{if(!(!g||typeof g!="object"))try{O.value={...O.value,...Object.fromEntries(Object.entries(g).filter(([u,C])=>C!=null))},Q.value={cep:g.cep||"",logradouro:g.logradouro||"",numero:g.numero||"",complemento:g.complemento||"",bairro:g.bairro||"",cidade:g.cidade||"",uf:g.uf||""},g.documento&&(n.value=Ee(g.documento),V.value=Pe(g.documento)),g.telefone&&(A.value=Fe(g.telefone)),g.telefone2&&(P.value=Fe(g.telefone2)),g.cep&&(Ae.value=tt(g.cep),dt.value=!0),g.dataNascimento&&(D.value=g.dataNascimento)}catch(u){console.warn("Erro ao atualizar EnderecoInput:",u)}},{immediate:!0,deep:!0}),Ze(()=>{try{const g=c.modelValue;g&&typeof g=="object"&&Object.keys(g).length>0&&(O.value={...O.value,...Object.fromEntries(Object.entries(g).filter(([u,C])=>C!=null))},Q.value={cep:g.cep||"",logradouro:g.logradouro||"",numero:g.numero||"",complemento:g.complemento||"",bairro:g.bairro||"",cidade:g.cidade||"",uf:g.uf||""},g.documento&&(n.value=Ee(g.documento),V.value=Pe(g.documento)),g.telefone&&(A.value=Fe(g.telefone)),g.telefone2&&(P.value=Fe(g.telefone2)),g.cep&&(Ae.value=tt(g.cep)),g.dataNascimento&&(D.value=g.dataNascimento))}catch(g){console.warn("Erro na inicialização do EnderecoInput:",g)}}),(g,u)=>(l(),i("div",pn,[e("div",vn,[u[16]||(u[16]=e("i",{class:"fa-solid fa-building text-blue-400 text-xs"},null,-1)),T(" "+I(r.label||"Qualificação Completa")+" ",1),r.required?(l(),i("span",fn,"*")):w("",!0)]),e("div",mn,[e("div",null,[e("label",{for:v,class:"text-[12px] text-slate-300"},[T(I(et.value)+" ",1),r.required?(l(),i("span",gn,"*")):w("",!0)]),e("div",bn,[ee(e("input",{id:v,"onUpdate:modelValue":u[0]||(u[0]=C=>O.value.nome=C),type:"text",placeholder:et.value==="Nome Completo"?"Nome completo da pessoa...":"Razão social da empresa...",required:r.required,disabled:r.disabled,class:"input-field input-field--xs",onInput:J},null,40,hn),[[ue,O.value.nome]])])]),e("div",{class:M(f.value===!0&&V.value==="PF"?"grid grid-cols-1 md:grid-cols-2 gap-1":"grid grid-cols-1 gap-1")},[e("div",null,[e("label",{for:k,class:"text-[12px] text-slate-300"},[T(I(X.value)+" ",1),r.required?(l(),i("span",xn,"*")):w("",!0)]),e("div",{class:M(["input-container input-container--xs input-container--default",ut.value])},[ee(e("input",{id:k,"onUpdate:modelValue":u[1]||(u[1]=C=>n.value=C),type:"text",placeholder:V.value==="PJ"?"00.000.000/0000-00":V.value==="PF"?"000.000.000-00":"CPF ou CNPJ",required:r.required,disabled:r.disabled,class:"input-field input-field--xs",onInput:Re,onBlur:at,onFocus:vt,maxlength:"18"},null,40,yn),[[ue,n.value]])],2)]),ee(e("div",null,[e("label",{for:U,class:"text-[12px] text-slate-300"},"Data de Nascimento"),e("div",{class:M(["input-container input-container--xs input-container--default",wt.value])},[ee(e("input",{id:U,"onUpdate:modelValue":u[2]||(u[2]=C=>D.value=C),type:"text",placeholder:"dd/mm/aaaa",disabled:r.disabled,class:"input-field input-field--xs",onInput:lt,onBlur:Pt,maxlength:"10"},null,40,$n),[[ue,D.value]])],2)],512),[[jt,f.value===!0&&V.value==="PF"]])],2),e("div",wn,[e("div",null,[e("label",{for:y,class:"text-[12px] text-slate-300"},"E-mail"),e("div",kn,[ee(e("input",{id:y,"onUpdate:modelValue":u[3]||(u[3]=C=>O.value.email=C),type:"email",placeholder:"email@exemplo.com",disabled:r.disabled,class:"input-field input-field--xs",onInput:J},null,40,_n),[[ue,O.value.email]])])]),e("div",null,[e("label",{for:s,class:"text-[12px] text-slate-300"},"Celular"),e("div",{class:M(["input-container input-container--xs input-container--default",Le.value])},[ee(e("input",{id:s,"onUpdate:modelValue":u[4]||(u[4]=C=>A.value=C),type:"text",placeholder:"(00) 00000-0000",disabled:r.disabled,class:"input-field input-field--xs",onInput:Vt,onBlur:It,maxlength:"15"},null,40,Vn),[[ue,A.value]])],2)]),e("div",null,[e("label",{for:d,class:"text-[12px] text-slate-300"},"Fixo"),e("div",{class:M(["input-container input-container--xs input-container--default",Z.value])},[ee(e("input",{id:d,"onUpdate:modelValue":u[5]||(u[5]=C=>P.value=C),type:"text",placeholder:"(00) 00000-0000",disabled:r.disabled,class:"input-field input-field--xs",onInput:Ct,onBlur:St,maxlength:"15"},null,40,In),[[ue,P.value]])],2)]),ee(e("div",null,[e("label",{for:$,class:"text-[12px] text-slate-300"},"Inscrição Estadual"),e("div",Cn,[ee(e("input",{id:$,"onUpdate:modelValue":u[6]||(u[6]=C=>O.value.inscricaoEstadual=C),type:"text",placeholder:"000.000.000.000",disabled:r.disabled,class:"input-field input-field--xs",onInput:J},null,40,Sn),[[ue,O.value.inscricaoEstadual]])])],512),[[jt,V.value==="PJ"]]),ee(e("div",null,[e("label",{for:G,class:"text-[12px] text-slate-300"},"Nome da Mãe"),e("div",Pn,[ee(e("input",{id:G,"onUpdate:modelValue":u[7]||(u[7]=C=>O.value.nomeMae=C),type:"text",placeholder:"Nome completo da mãe...",disabled:r.disabled,class:"input-field input-field--xs",onInput:J},null,40,An),[[ue,O.value.nomeMae]])])],512),[[jt,V.value==="PF"&&f.value===!0]])])]),e("div",Fn,[e("div",En,[e("div",Bn,[e("label",{for:H,class:"text-[12px] text-slate-300"},"CEP"),e("div",{class:M(["input-container input-container--xs input-container--default",ge.value])},[ee(e("input",{id:H,"onUpdate:modelValue":u[8]||(u[8]=C=>Ae.value=C),type:"text",placeholder:"00000-000",disabled:r.disabled,class:"input-field input-field--xs",onInput:Ue,onBlur:_e,onFocus:He,maxlength:"9"},null,40,Un),[[ue,Ae.value]])],2)]),e("div",null,[e("label",{for:R,class:"text-[12px] text-slate-300"},[u[17]||(u[17]=T(" Cidade ",-1)),r.required?(l(),i("span",Dn,"*")):w("",!0)]),e("div",Nn,[ee(e("input",{id:R,"onUpdate:modelValue":u[9]||(u[9]=C=>Q.value.cidade=C),type:"text",placeholder:"São Paulo",required:r.required,disabled:r.disabled,class:"input-field input-field--xs",onInput:me},null,40,Mn),[[ue,Q.value.cidade]])])]),e("div",null,[e("label",{for:p,class:"text-[12px] text-slate-300"},[u[18]||(u[18]=T(" UF ",-1)),r.required?(l(),i("span",zn,"*")):w("",!0)]),e("div",qn,[ee(e("select",{id:p,"onUpdate:modelValue":u[10]||(u[10]=C=>Q.value.uf=C),required:r.required,disabled:r.disabled,class:"input-field input-field--xs",onChange:me},[...u[19]||(u[19]=[wa('<option value="" data-v-84888dee>UF</option><option value="AC" data-v-84888dee>AC</option><option value="AL" data-v-84888dee>AL</option><option value="AP" data-v-84888dee>AP</option><option value="AM" data-v-84888dee>AM</option><option value="BA" data-v-84888dee>BA</option><option value="CE" data-v-84888dee>CE</option><option value="DF" data-v-84888dee>DF</option><option value="ES" data-v-84888dee>ES</option><option value="GO" data-v-84888dee>GO</option><option value="MA" data-v-84888dee>MA</option><option value="MT" data-v-84888dee>MT</option><option value="MS" data-v-84888dee>MS</option><option value="MG" data-v-84888dee>MG</option><option value="PA" data-v-84888dee>PA</option><option value="PB" data-v-84888dee>PB</option><option value="PR" data-v-84888dee>PR</option><option value="PE" data-v-84888dee>PE</option><option value="PI" data-v-84888dee>PI</option><option value="RJ" data-v-84888dee>RJ</option><option value="RN" data-v-84888dee>RN</option><option value="RS" data-v-84888dee>RS</option><option value="RO" data-v-84888dee>RO</option><option value="RR" data-v-84888dee>RR</option><option value="SC" data-v-84888dee>SC</option><option value="SP" data-v-84888dee>SP</option><option value="SE" data-v-84888dee>SE</option><option value="TO" data-v-84888dee>TO</option>',28)])],40,Rn),[[rt,Q.value.uf]])])]),e("div",Tn,[e("label",{for:z,class:"text-[12px] text-slate-300"},[u[20]||(u[20]=T(" Logradouro ",-1)),r.required?(l(),i("span",On,"*")):w("",!0)]),e("div",jn,[ee(e("input",{id:z,"onUpdate:modelValue":u[11]||(u[11]=C=>Q.value.logradouro=C),type:"text",placeholder:"Rua, Avenida...",required:r.required,disabled:r.disabled,class:"input-field input-field--xs",onInput:me},null,40,Ln),[[ue,Q.value.logradouro]])])]),e("div",null,[e("label",{for:L,class:"text-[12px] text-slate-300"},[u[21]||(u[21]=T(" Número ",-1)),r.required?(l(),i("span",Gn,"*")):w("",!0)]),e("div",Jn,[ee(e("input",{id:L,"onUpdate:modelValue":u[12]||(u[12]=C=>Q.value.numero=C),type:"text",placeholder:"123",required:r.required,disabled:r.disabled,class:"input-field input-field--xs",onInput:me},null,40,Kn),[[ue,Q.value.numero]])])]),e("div",null,[e("label",{for:K,class:"text-[12px] text-slate-300"},"Complemento"),e("div",Wn,[ee(e("input",{id:K,"onUpdate:modelValue":u[13]||(u[13]=C=>Q.value.complemento=C),type:"text",placeholder:"Apto, Bloco...",disabled:r.disabled,class:"input-field input-field--xs",onInput:me},null,40,Hn),[[ue,Q.value.complemento]])])]),e("div",null,[e("label",{for:ae,class:"text-[12px] text-slate-300"},[u[22]||(u[22]=T(" Bairro ",-1)),r.required?(l(),i("span",Xn,"*")):w("",!0)]),e("div",Yn,[ee(e("input",{id:ae,"onUpdate:modelValue":u[14]||(u[14]=C=>Q.value.bairro=C),type:"text",placeholder:"Centro...",required:r.required,disabled:r.disabled,class:"input-field input-field--xs",onInput:me},null,40,Qn),[[ue,Q.value.bairro]])])])])]),e("div",Zn,[e("label",{for:j,class:"text-[12px] text-slate-300"},"Observações"),e("div",ei,[ee(e("textarea",{id:j,"onUpdate:modelValue":u[15]||(u[15]=C=>O.value.observacoes=C),placeholder:"Digite suas observações (máximo 500 caracteres)...",disabled:r.disabled,class:"input-field input-field--textarea",rows:"4",maxlength:"500",onInput:J},null,40,ti),[[ue,O.value.observacoes]])]),e("div",ai,[u[23]||(u[23]=e("div",{class:"text-xs text-slate-400"},"Máximo 500 caracteres",-1)),e("div",li,I((O.value.observacoes||"").length)+"/500 ",1)])])]))}},Qt=qe(si,[["__scopeId","data-v-84888dee"]]),oi={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ni={class:"md:col-span-2"},ii={class:"md:col-span-2"},ri={class:"md:col-span-2"},di={class:"md:col-span-2"},ui={class:"flex justify-end space-x-2"},Va={__name:"PessoaFisica",props:{show:{type:Boolean,default:!1},initialData:{type:Object,default:()=>({})}},emits:["close","submit"],setup(r,{emit:S}){const c=r,_=S,m=x({nomeCompleto:"",cpf:"",rg:"",dataNascimento:"",estadoCivil:"",telefone:"",email:"",endereco:{}}),k=[{value:"solteiro",label:"Solteiro(a)"},{value:"casado",label:"Casado(a)"},{value:"divorciado",label:"Divorciado(a)"},{value:"viuvo",label:"Viúvo(a)"},{value:"separado",label:"Separado(a)"},{value:"uniao_estavel",label:"União Estável"}];pe(()=>c.initialData,y=>{y&&Object.keys(y).length>0&&(m.value={...m.value,...y})},{immediate:!0,deep:!0}),pe(()=>c.show,y=>{y&&c.initialData&&Object.keys(c.initialData).length>0&&(m.value={...m.value,...c.initialData})});const v=()=>{if(!m.value.nomeCompleto.trim()){alert("Nome completo é obrigatório");return}if(!m.value.cpf.trim()){alert("CPF é obrigatório");return}_("submit",{...m.value})};return Ze(()=>{c.initialData&&Object.keys(c.initialData).length>0&&(m.value={...m.value,...c.initialData})}),(y,s)=>(l(),de(ze,{"model-value":r.show,title:"Dados da Pessoa Física","container-class":"w-[90vw] max-w-2xl rounded-xl",onClose:s[9]||(s[9]=d=>y.$emit("close"))},{footer:ve(()=>[e("div",ui,[e("button",{type:"button",onClick:s[8]||(s[8]=d=>y.$emit("close")),class:"px-4 py-2 text-sm font-medium text-slate-300 bg-slate-700 hover:bg-slate-600 rounded-lg transition-colors"}," Cancelar "),e("button",{type:"button",onClick:v,class:"px-4 py-2 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded-lg transition-colors"}," Salvar ")])]),default:ve(()=>[e("form",{onSubmit:ke(v,["prevent"]),class:"space-y-4"},[e("div",oi,[e("div",ni,[s[10]||(s[10]=e("label",{class:"block text-sm font-medium text-slate-300 mb-2"}," Nome Completo * ",-1)),Y(Se,{modelValue:m.value.nomeCompleto,"onUpdate:modelValue":s[0]||(s[0]=d=>m.value.nomeCompleto=d),placeholder:"Digite o nome completo",required:""},null,8,["modelValue"])]),e("div",null,[s[11]||(s[11]=e("label",{class:"block text-sm font-medium text-slate-300 mb-2"}," CPF * ",-1)),Y(Ht,{modelValue:m.value.cpf,"onUpdate:modelValue":s[1]||(s[1]=d=>m.value.cpf=d),required:""},null,8,["modelValue"])]),e("div",null,[s[12]||(s[12]=e("label",{class:"block text-sm font-medium text-slate-300 mb-2"}," RG ",-1)),Y(Xt,{modelValue:m.value.rg,"onUpdate:modelValue":s[2]||(s[2]=d=>m.value.rg=d)},null,8,["modelValue"])]),e("div",null,[s[13]||(s[13]=e("label",{class:"block text-sm font-medium text-slate-300 mb-2"}," Data de Nascimento ",-1)),Y(Se,{modelValue:m.value.dataNascimento,"onUpdate:modelValue":s[3]||(s[3]=d=>m.value.dataNascimento=d),type:"date",placeholder:"dd/mm/aaaa"},null,8,["modelValue"])]),e("div",null,[s[14]||(s[14]=e("label",{class:"block text-sm font-medium text-slate-300 mb-2"}," Estado Civil ",-1)),Y(Wt,{modelValue:m.value.estadoCivil,"onUpdate:modelValue":s[4]||(s[4]=d=>m.value.estadoCivil=d),options:k,placeholder:"Selecione o estado civil"},null,8,["modelValue"])]),e("div",ii,[s[15]||(s[15]=e("label",{class:"block text-sm font-medium text-slate-300 mb-2"}," Telefone ",-1)),Y(Yt,{modelValue:m.value.telefone,"onUpdate:modelValue":s[5]||(s[5]=d=>m.value.telefone=d)},null,8,["modelValue"])]),e("div",ri,[s[16]||(s[16]=e("label",{class:"block text-sm font-medium text-slate-300 mb-2"}," Email ",-1)),Y(Se,{modelValue:m.value.email,"onUpdate:modelValue":s[6]||(s[6]=d=>m.value.email=d),type:"email",placeholder:"email@exemplo.com"},null,8,["modelValue"])]),e("div",di,[s[17]||(s[17]=e("label",{class:"block text-sm font-medium text-slate-300 mb-2"}," Endereço ",-1)),Y(Qt,{modelValue:m.value.endereco,"onUpdate:modelValue":s[7]||(s[7]=d=>m.value.endereco=d)},null,8,["modelValue"])])])],32)]),_:1},8,["model-value"]))}},ci={class:"relative"},pi=["disabled"],vi={__name:"PessoaFisicaInput",props:{modelValue:{type:Object,default:()=>({})},placeholder:{type:String,default:"Clique para inserir dados da pessoa física"},disabled:{type:Boolean,default:!1},required:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(r,{emit:S}){const c=r,_=S,m=x(!1),k=q(()=>{if(!c.modelValue||Object.keys(c.modelValue).length===0)return"";const{nomeCompleto:d,cpf:$}=c.modelValue;return d&&$?`${d} - CPF: ${$}`:d||($?`CPF: ${$}`:"Dados preenchidos")}),v=()=>{c.disabled||(m.value=!0)},y=()=>{m.value=!1},s=d=>{_("update:modelValue",d),y()};return(d,$)=>(l(),i("div",ci,[Y(Se,{"model-value":k.value,placeholder:r.placeholder,disabled:r.disabled,required:r.required,readonly:"",onClick:v,class:"cursor-pointer bg-slate-800 hover:bg-slate-700 transition-colors"},{suffix:ve(()=>[e("button",{type:"button",onClick:v,class:"text-slate-400 hover:text-white transition-colors p-1",disabled:r.disabled},[...$[0]||($[0]=[e("i",{class:"fa-solid fa-user text-sm"},null,-1)])],8,pi)]),_:1},8,["model-value","placeholder","disabled","required"]),Y(Va,{show:m.value,"initial-data":r.modelValue||{},onClose:y,onSubmit:s},null,8,["show","initial-data"])]))}},fi={key:0,class:"ff-label"},mi={key:0,class:"text-red-400"},gi={class:"ff-control"},bi={key:1,class:"ff-help"},hi={key:2,class:"ff-error"},xi={__name:"FormField",props:{label:{type:String,default:""},help:{type:String,default:""},error:{type:String,default:""},required:{type:Boolean,default:!1},dense:{type:Boolean,default:!0}},setup(r){const S=r,c=q(()=>[S.dense?"ff-dense":""]);return(_,m)=>(l(),i("div",{class:M(["ff-wrapper",c.value])},[r.label?(l(),i("label",fi,[T(I(r.label)+" ",1),r.required?(l(),i("span",mi,"*")):w("",!0)])):w("",!0),e("div",gi,[$a(_.$slots,"default",{},void 0,!0)]),r.help&&!r.error?(l(),i("p",bi,I(r.help),1)):w("",!0),r.error?(l(),i("p",hi,I(r.error),1)):w("",!0)],2))}},Jt=qe(xi,[["__scopeId","data-v-9e7d3744"]]);function Zt(){const r=x([]),S=x(!1),c=x(null),_=async s=>{if(!te()){console.warn("API disabled, cannot load process files");return}S.value=!0,c.value=null;try{const d=await Ie(`/api/v1/processes/${s}/files`);r.value=d||[]}catch(d){c.value="Erro ao carregar arquivos do processo",console.error("Error loading process files:",d)}finally{S.value=!1}},m=async s=>{if(!te())throw new Error("API disabled");try{return(await Ie("/api/v1/files/download-url",{method:"POST",body:{objectKey:s}})).url}catch{throw new Error("Erro ao gerar URL de download")}};return{files:r,loading:S,error:c,loadProcessFiles:_,downloadFile:async s=>{try{S.value=!0;const d=await m(s.objectKey),$=document.createElement("a");$.href=d,$.download=s.originalName,document.body.appendChild($),$.click(),document.body.removeChild($)}catch(d){c.value="Erro ao fazer download do arquivo",console.error("Download error:",d)}finally{S.value=!1}},formatFileSize:s=>{if(s===0)return"0 Bytes";const d=1024,$=["Bytes","KB","MB","GB"],U=Math.floor(Math.log(s)/Math.log(d));return parseFloat((s/Math.pow(d,U)).toFixed(2))+" "+$[U]},getFileIcon:s=>s.includes("image/")?"fa-solid fa-image text-blue-500":s.includes("pdf")?"fa-solid fa-file-pdf text-red-500":s.includes("word")?"fa-solid fa-file-word text-blue-600":s.includes("excel")||s.includes("spreadsheet")?"fa-solid fa-file-excel text-green-600":s.includes("powerpoint")?"fa-solid fa-file-powerpoint text-orange-500":s.includes("zip")||s.includes("rar")?"fa-solid fa-file-zipper text-yellow-600":"fa-solid fa-file text-slate-500"}}const yi={class:"space-y-4"},$i={class:"flex items-center justify-between bg-slate-900/50 rounded-lg p-3"},wi={class:"text-sm font-medium text-slate-200"},ki={class:"text-xs text-slate-400 mt-1"},_i=["disabled"],Vi={class:"flex items-center gap-2 text-xs"},Ii={key:0,class:"flex items-center justify-center py-8"},Ci={key:1,class:"bg-red-900/20 border border-red-700/50 rounded-lg p-3"},Si={class:"flex items-center gap-2 text-red-400"},Pi={class:"text-sm"},Ai={key:2,class:"text-center py-8"},Fi={class:"text-slate-400 text-sm"},Ei={key:3,class:"space-y-3 max-h-96 overflow-y-auto"},Bi={class:"flex items-start justify-between"},Ui={class:"flex items-start gap-4 min-w-0 flex-1"},Di={class:"flex-shrink-0 mt-1"},Ni={class:"min-w-0 flex-1"},Mi={class:"flex items-center gap-2 mb-2"},zi={class:"text-sm font-medium text-slate-200 truncate"},qi={class:"text-xs text-slate-500 px-2 py-0.5 bg-slate-700 rounded"},Ri={class:"flex items-center gap-4 text-xs text-slate-400 mb-2"},Ti={class:"flex items-center gap-1"},Oi={key:0,class:"flex items-center gap-1"},ji={key:1,class:"flex items-center gap-1"},Li={key:0,class:"text-xs"},Gi={class:"flex items-center gap-2 text-slate-400"},Ji={key:0},Ki={key:0,class:"text-slate-300 mt-1 bg-slate-900/30 rounded p-2"},Wi={class:"flex items-center gap-2 flex-shrink-0 ml-4"},Hi={class:"flex items-center gap-1"},Xi=["onClick","disabled"],Yi=["onClick","disabled"],Qi=["onClick","disabled"],Zi=["onClick","disabled","title"],er=["onClick","title"],tr={key:0,class:"space-y-4"},ar={class:"bg-slate-900/50 rounded-lg p-3"},lr={class:"flex items-center gap-3 mb-3"},sr={class:"text-sm font-medium text-slate-200"},or={class:"grid grid-cols-1 gap-3 text-xs"},nr={class:"flex justify-between"},ir={class:"text-slate-200"},rr={class:"flex justify-between"},dr={class:"text-slate-200"},ur={class:"flex justify-between"},cr={class:"text-slate-200"},pr={class:"flex justify-between"},vr={key:0,class:"flex justify-between"},fr={class:"text-slate-200"},mr={key:1,class:"flex justify-between"},gr={class:"text-slate-200"},br={class:"flex justify-between"},hr={class:"text-slate-200 font-mono text-xs break-all"},xr={class:"flex gap-2"},yr=["disabled"],$r={__name:"ProcessFilesApprovalView",props:{show:{type:Boolean,default:!1},processKey:{type:String,required:!0},files:{type:Array,default:()=>[]}},emits:["close","refresh","approveFile","rejectFile","downloadFile"],setup(r,{emit:S}){const c=r,_=S,{formatFileSize:m,getFileIcon:k}=Zt(),v=x(!1),y=x(null),s=x("all"),d=x(!1),$=x(null),U=q(()=>c.files.map(P=>({...P,approvalStatus:P.approvalStatus||"pending",approvalBy:P.approvalBy||null,approvedAt:P.approvedAt||null,approvalNotes:P.approvalNotes||null}))),G=q(()=>s.value==="all"?U.value:U.value.filter(P=>P.approvalStatus===s.value)),j=q(()=>U.value.filter(P=>P.approvalStatus==="approved").length),H=q(()=>U.value.filter(P=>P.approvalStatus==="rejected").length),z=q(()=>U.value.filter(P=>P.approvalStatus==="pending").length),L=()=>{_("refresh")},K=P=>{y.value=P,v.value=!0},ae=()=>{v.value=!1,y.value=null},R=async P=>{_("downloadFile",{file:P})},p=async(P,F)=>{console.log(`Aprovando arquivo ${P.id} por ${F}`),_("approveFile",{file:P,approvalBy:F})},n=async P=>{console.log(`Reprovando arquivo ${P.id}`),_("rejectFile",{file:P})},f=P=>{switch(P){case"approved":return"text-green-400 bg-green-900/30";case"rejected":return"text-red-400 bg-red-900/30";case"pending":return"text-yellow-400 bg-yellow-900/30";default:return"text-slate-400 bg-slate-900/30"}},V=P=>{switch(P){case"approved":return"Aprovado";case"rejected":return"Reprovado";case"pending":return"Pendente";default:return"Desconhecido"}},A=P=>{switch(P){case"approved":return"border-green-500";case"rejected":return"border-red-500";case"pending":return"border-yellow-500";default:return"border-slate-600"}},E=P=>{try{return new Date(P).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return"Data inválida"}};return(P,F)=>(l(),de(ze,{"model-value":r.show,title:"Arquivos do Processo","container-class":"w-[95vw] max-w-6xl rounded-xl","z-index":80,"onUpdate:modelValue":F[5]||(F[5]=D=>P.$emit("close"))},{default:ve(()=>[e("div",yi,[e("div",$i,[e("div",null,[e("h3",wi,"Processo: "+I(r.processKey),1),e("p",ki,I(r.files.length)+" arquivo"+I(r.files.length!==1?"s":"")+" encontrado"+I(r.files.length!==1?"s":""),1)]),e("button",{onClick:L,disabled:d.value,class:"px-3 py-1 text-xs bg-blue-600 hover:bg-blue-700 disabled:bg-slate-600 text-white rounded-md transition-colors flex items-center gap-2"},[e("i",{class:M(["fa-solid fa-refresh",{"animate-spin":d.value}])},null,2),F[6]||(F[6]=T(" Atualizar ",-1))],8,_i)]),e("div",Vi,[e("button",{onClick:F[0]||(F[0]=D=>s.value="all"),class:M([s.value==="all"?"bg-indigo-600 text-white":"bg-slate-700 text-slate-300 hover:bg-slate-600","px-2 py-1 rounded-md transition-colors"])}," Todos ("+I(r.files.length)+") ",3),e("button",{onClick:F[1]||(F[1]=D=>s.value="approved"),class:M([s.value==="approved"?"bg-green-500 text-white":"bg-slate-700 text-slate-300 hover:bg-slate-600","px-2 py-1 rounded-md transition-colors flex items-center gap-1"])},[F[7]||(F[7]=e("i",{class:"fa-solid fa-check"},null,-1)),T(" Aprovados ("+I(j.value)+") ",1)],2),e("button",{onClick:F[2]||(F[2]=D=>s.value="rejected"),class:M([s.value==="rejected"?"bg-red-500 text-white":"bg-slate-700 text-slate-300 hover:bg-slate-600","px-2 py-1 rounded-md transition-colors flex items-center gap-1"])},[F[8]||(F[8]=e("i",{class:"fa-solid fa-times"},null,-1)),T(" Reprovados ("+I(H.value)+") ",1)],2),e("button",{onClick:F[3]||(F[3]=D=>s.value="pending"),class:M([s.value==="pending"?"bg-yellow-500 text-white":"bg-slate-700 text-slate-300 hover:bg-slate-600","px-2 py-1 rounded-md transition-colors flex items-center gap-1"])},[F[9]||(F[9]=e("i",{class:"fa-solid fa-clock"},null,-1)),T(" Pendentes ("+I(z.value)+") ",1)],2)]),d.value&&r.files.length===0?(l(),i("div",Ii,[...F[10]||(F[10]=[e("div",{class:"flex items-center gap-2 text-slate-400"},[e("i",{class:"fa-solid fa-spinner animate-spin"}),e("span",{class:"text-sm"},"Carregando arquivos...")],-1)])])):w("",!0),$.value?(l(),i("div",Ci,[e("div",Si,[F[11]||(F[11]=e("i",{class:"fa-solid fa-circle-exclamation"},null,-1)),e("span",Pi,I($.value),1)])])):w("",!0),!d.value&&G.value.length===0&&!$.value?(l(),i("div",Ai,[F[12]||(F[12]=e("div",{class:"text-slate-500 mb-2"},[e("i",{class:"fa-solid fa-folder-open text-4xl"})],-1)),e("p",Fi,I(r.files.length===0?"Nenhum arquivo encontrado neste processo":"Nenhum arquivo corresponde ao filtro selecionado"),1)])):w("",!0),G.value.length>0?(l(),i("div",Ei,[(l(!0),i(se,null,ce(G.value,D=>(l(),i("div",{key:D.id,class:M(["bg-slate-800/50 rounded-lg p-4 border-l-4",A(D.approvalStatus)])},[e("div",Bi,[e("div",Ui,[e("div",Di,[e("i",{class:M([oe(k)(D.contentType),"text-lg"])},null,2)]),e("div",Ni,[e("div",Mi,[e("h4",zi,I(D.originalName),1),e("span",qi,I(oe(m)(D.fileSize)),1),e("span",{class:M(["text-xs px-2 py-0.5 rounded-full font-medium",f(D.approvalStatus)])},I(V(D.approvalStatus)),3)]),e("div",Ri,[e("span",Ti,[F[13]||(F[13]=e("i",{class:"fa-solid fa-clock w-3"},null,-1)),T(" "+I(E(D.uploadedAt)),1)]),D.stageId?(l(),i("span",Oi,[F[14]||(F[14]=e("i",{class:"fa-solid fa-layer-group w-3"},null,-1)),T(" Etapa: "+I(D.stageId),1)])):w("",!0),D.proposalId?(l(),i("span",ji,[F[15]||(F[15]=e("i",{class:"fa-solid fa-file-contract w-3"},null,-1)),T(" Proposta: "+I(D.proposalId),1)])):w("",!0)]),D.approvalStatus&&D.approvalStatus!=="pending"?(l(),i("div",Li,[e("div",Gi,[e("i",{class:M(D.approvalBy==="AI"?"fa-solid fa-robot":"fa-solid fa-user")},null,2),e("span",null,[T(I(D.approvalBy==="AI"?"Aprovado por IA":`Aprovado por ${D.approvalBy||"Usuário"}`)+" ",1),D.approvedAt?(l(),i("span",Ji," em "+I(E(D.approvedAt)),1)):w("",!0)])]),D.approvalNotes?(l(),i("p",Ki,I(D.approvalNotes),1)):w("",!0)])):w("",!0)])]),e("div",Wi,[e("div",Hi,[e("button",{onClick:fe=>p(D,"AI"),disabled:d.value||D.approvalStatus==="approved",class:"px-2 py-1 text-xs bg-green-600 hover:bg-green-700 disabled:bg-slate-600 text-white rounded-md transition-colors flex items-center gap-1",title:"Aprovar por IA"},[...F[16]||(F[16]=[e("i",{class:"fa-solid fa-robot text-[10px]"},null,-1),T(" IA ",-1)])],8,Xi),e("button",{onClick:fe=>p(D,"HUMAN"),disabled:d.value||D.approvalStatus==="approved",class:"px-2 py-1 text-xs bg-blue-600 hover:bg-blue-700 disabled:bg-slate-600 text-white rounded-md transition-colors flex items-center gap-1",title:"Aprovar por Humano"},[...F[17]||(F[17]=[e("i",{class:"fa-solid fa-user text-[10px]"},null,-1),T(" Humano ",-1)])],8,Yi),e("button",{onClick:fe=>n(D),disabled:d.value||D.approvalStatus==="rejected",class:"px-2 py-1 text-xs bg-red-600 hover:bg-red-700 disabled:bg-slate-600 text-white rounded-md transition-colors flex items-center gap-1",title:"Reprovar arquivo"},[...F[18]||(F[18]=[e("i",{class:"fa-solid fa-times text-[10px]"},null,-1)])],8,Qi)]),F[21]||(F[21]=e("div",{class:"w-px h-6 bg-slate-600"},null,-1)),e("button",{onClick:fe=>R(D),disabled:d.value,class:"px-2 py-1 text-xs bg-orange-600 hover:bg-orange-700 disabled:bg-slate-600 text-white rounded-md transition-colors flex items-center gap-1",title:`Baixar ${D.originalName}`},[...F[19]||(F[19]=[e("i",{class:"fa-solid fa-download text-[10px]"},null,-1)])],8,Zi),e("button",{onClick:fe=>K(D),class:"px-2 py-1 text-xs bg-slate-600 hover:bg-slate-700 text-white rounded-md transition-colors flex items-center gap-1",title:`Ver detalhes de ${D.originalName}`},[...F[20]||(F[20]=[e("i",{class:"fa-solid fa-info text-[10px]"},null,-1)])],8,er)])])],2))),128))])):w("",!0)]),Y(ze,{"model-value":v.value,title:"Detalhes do Arquivo","container-class":"w-[90vw] max-w-lg rounded-xl","z-index":90,"onUpdate:modelValue":ae},{default:ve(()=>[y.value?(l(),i("div",tr,[e("div",ar,[e("div",lr,[e("i",{class:M([oe(k)(y.value.contentType),"text-2xl"])},null,2),e("h3",sr,I(y.value.originalName),1)]),e("div",or,[e("div",nr,[F[22]||(F[22]=e("span",{class:"text-slate-400"},"Tamanho:",-1)),e("span",ir,I(oe(m)(y.value.fileSize)),1)]),e("div",rr,[F[23]||(F[23]=e("span",{class:"text-slate-400"},"Tipo:",-1)),e("span",dr,I(y.value.contentType),1)]),e("div",ur,[F[24]||(F[24]=e("span",{class:"text-slate-400"},"Upload:",-1)),e("span",cr,I(E(y.value.uploadedAt)),1)]),e("div",pr,[F[25]||(F[25]=e("span",{class:"text-slate-400"},"Status:",-1)),e("span",{class:M(f(y.value.approvalStatus))},I(V(y.value.approvalStatus)),3)]),y.value.stageId?(l(),i("div",vr,[F[26]||(F[26]=e("span",{class:"text-slate-400"},"Etapa:",-1)),e("span",fr,I(y.value.stageId),1)])):w("",!0),y.value.proposalId?(l(),i("div",mr,[F[27]||(F[27]=e("span",{class:"text-slate-400"},"Proposta:",-1)),e("span",gr,I(y.value.proposalId),1)])):w("",!0),e("div",br,[F[28]||(F[28]=e("span",{class:"text-slate-400"},"Chave do objeto:",-1)),e("span",hr,I(y.value.objectKey),1)])])]),e("div",xr,[e("button",{onClick:F[4]||(F[4]=D=>R(y.value)),disabled:d.value,class:"flex-1 px-4 py-2 bg-orange-600 hover:bg-orange-700 disabled:bg-slate-600 text-white rounded-lg transition-colors flex items-center justify-center gap-2"},[...F[29]||(F[29]=[e("i",{class:"fa-solid fa-download"},null,-1),T(" Baixar Arquivo ",-1)])],8,yr)])])):w("",!0)]),_:1},8,["model-value"])]),_:1},8,["model-value"]))}},wr={class:"space-y-4"},kr={class:"text-center border-b border-slate-700/60 pb-4"},_r={class:"text-sm font-medium text-slate-200"},Vr={class:"space-y-3"},Ir={class:"text-left"},Cr={class:"space-y-2"},Sr={class:"flex items-center gap-2 cursor-pointer"},Pr={class:"flex items-center gap-2 cursor-pointer"},Ar={key:0,class:"mt-3 space-y-3"},Fr=["value"],Er={key:0,class:"space-y-1"},Br={class:"flex items-center gap-2"},Ur={class:"w-6 h-6 rounded-full bg-slate-700 flex items-center justify-center text-xs text-slate-300"},Dr={class:"text-sm text-slate-200"},Nr={key:0,class:"text-xs text-indigo-400 bg-indigo-600/20 px-1.5 py-0.5 rounded"},Mr=["onClick"],zr={class:"border-t border-slate-700/40 pt-3"},qr={class:"grid grid-cols-1 gap-2"},Rr={class:"flex items-center gap-4"},Tr={class:"flex items-center gap-1 cursor-pointer"},Or={class:"flex items-center gap-1 cursor-pointer"},jr=["disabled"],Lr={key:0,class:"mt-3 space-y-1"},Gr={class:"flex-1"},Jr={class:"text-sm text-slate-200"},Kr={class:"text-xs text-slate-400"},Wr={class:"flex items-center gap-2 mt-1"},Hr={key:0,class:"inline-flex items-center gap-1 px-1.5 py-0.5 bg-blue-600/20 text-blue-300 rounded text-xs"},Xr={key:1,class:"inline-flex items-center gap-1 px-1.5 py-0.5 bg-green-600/20 text-green-300 rounded text-xs"},Yr=["onClick"],Qr={class:"flex items-center justify-end gap-3 pt-2 border-t border-slate-700/60"},Zr=["disabled"],ed={key:0,class:"fa-solid fa-spinner fa-spin mr-2"},td={__name:"EditAccessModal",props:{modelValue:{type:Boolean,default:!1},proposal:{type:Object,default:null},availableUsers:{type:Array,default:()=>[]}},emits:["update:modelValue","save","close"],setup(r,{emit:S}){const c=r,_=S,m=q({get:()=>c.modelValue,set:p=>_("update:modelValue",p)}),k=x(!1),v=x("public"),y=x([]),s=x(""),d=x([]),$=x({name:"",email:"",phone:"",emailEnabled:!0,whatsappEnabled:!1}),U=q(()=>y.value.map(p=>c.availableUsers.find(f=>f.id===p)||{id:p,name:"Usuário não encontrado",email:""})),G=q(()=>c.availableUsers.filter(p=>!y.value.includes(p.id)));function j(p){return p&&p.trim().split(/\s+/).slice(0,2).map(V=>V[0]?.toUpperCase()).join("")||"U"}pe([m,()=>c.proposal],([p,n])=>{p&&n&&(v.value=n.isPublic?"public":"restricted",y.value=[...n.visibleToUsers||[]],!n.isPublic&&n.createdBy&&!y.value.includes(n.createdBy)&&y.value.unshift(n.createdBy),d.value=[...n.externalNotifications||[]],$.value={name:"",email:"",phone:"",emailEnabled:!0,whatsappEnabled:!1},s.value="")},{immediate:!0});function H(){!s.value||y.value.includes(s.value)||(y.value.push(s.value),s.value="")}function z(p){if(p===c.proposal?.createdBy)return;const n=y.value.indexOf(p);n>-1&&y.value.splice(n,1)}function L(){!$.value.name||!$.value.email||(d.value.push({...$.value}),$.value={name:"",email:"",phone:"",emailEnabled:!0,whatsappEnabled:!1})}function K(p){d.value.splice(p,1)}function ae(){_("close"),_("update:modelValue",!1)}async function R(){if(c.proposal){k.value=!0;try{const p={isPublic:v.value==="public",visibleToUsers:v.value==="restricted"?[...y.value]:[],externalNotifications:[...d.value]};_("save",{proposalId:c.proposal.id,accessData:p}),ae()}catch(p){console.error("Erro ao salvar alterações de acesso:",p)}finally{k.value=!1}}}return(p,n)=>(l(),de(ze,{modelValue:m.value,"onUpdate:modelValue":[n[8]||(n[8]=f=>m.value=f),ae],title:"Controle de Acesso",size:"md"},{default:ve(()=>[e("div",wr,[e("div",kr,[e("div",_r,I(r.proposal?.name),1),n[9]||(n[9]=e("div",{class:"text-xs text-slate-400 mt-1"}," Editando permissões de acesso ",-1))]),e("div",Vr,[e("div",Ir,[n[23]||(n[23]=e("label",{class:"block text-xs text-slate-300 uppercase tracking-wide mb-2"}," Tipo de Acesso ",-1)),e("div",Cr,[e("label",Sr,[ee(e("input",{"onUpdate:modelValue":n[0]||(n[0]=f=>v.value=f),type:"radio",value:"public",class:"w-4 h-4 text-indigo-600 bg-slate-900 border-slate-600 focus:ring-indigo-500"},null,512),[[ia,v.value]]),n[10]||(n[10]=e("span",{class:"text-sm text-slate-200"},"Público (todos da esteira podem ver)",-1))]),e("label",Pr,[ee(e("input",{"onUpdate:modelValue":n[1]||(n[1]=f=>v.value=f),type:"radio",value:"restricted",class:"w-4 h-4 text-indigo-600 bg-slate-900 border-slate-600 focus:ring-indigo-500"},null,512),[[ia,v.value]]),n[11]||(n[11]=e("span",{class:"text-sm text-slate-200"},"Restrito (apenas usuários selecionados)",-1))])]),v.value==="restricted"?(l(),i("div",Ar,[e("div",null,[n[13]||(n[13]=e("label",{class:"block text-xs text-slate-400 mb-1"},"Usuários do Sistema",-1)),ee(e("select",{"onUpdate:modelValue":n[2]||(n[2]=f=>s.value=f),class:"w-full rounded-lg bg-slate-900/80 border border-slate-700/60 text-slate-100 px-3 py-2 text-sm focus:border-indigo-500 focus:outline-none",onChange:H},[n[12]||(n[12]=e("option",{value:""},"Selecionar usuário...",-1)),(l(!0),i(se,null,ce(G.value,f=>(l(),i("option",{key:f.id,value:f.id},I(f.name)+" ("+I(f.email)+") ",9,Fr))),128))],544),[[rt,s.value]])]),y.value.length>0?(l(),i("div",Er,[n[15]||(n[15]=e("label",{class:"block text-xs text-slate-400"},"Usuários com acesso:",-1)),(l(!0),i(se,null,ce(U.value,f=>(l(),i("div",{key:f.id,class:"flex items-center justify-between bg-slate-800/50 rounded-lg px-3 py-2"},[e("div",Br,[e("div",Ur,I(j(f.name)),1),e("span",Dr,I(f.name),1),f.id===r.proposal?.createdBy?(l(),i("span",Nr," Criador ")):w("",!0)]),f.id!==r.proposal?.createdBy?(l(),i("button",{key:0,onClick:V=>z(f.id),class:"text-slate-400 hover:text-red-400 transition-colors"},[...n[14]||(n[14]=[e("i",{class:"fa-solid fa-times text-xs"},null,-1)])],8,Mr)):w("",!0)]))),128))])):w("",!0),e("div",zr,[n[22]||(n[22]=e("label",{class:"block text-xs text-slate-400 mb-2"},"Notificações Externas",-1)),e("div",qr,[Y(Se,{modelValue:$.value.name,"onUpdate:modelValue":n[3]||(n[3]=f=>$.value.name=f),label:"Nome",size:"sm",placeholder:"Nome completo"},null,8,["modelValue"]),Y(Se,{modelValue:$.value.email,"onUpdate:modelValue":n[4]||(n[4]=f=>$.value.email=f),label:"Email",type:"email",size:"sm",placeholder:"email@exemplo.com"},null,8,["modelValue"]),Y(Se,{modelValue:$.value.phone,"onUpdate:modelValue":n[5]||(n[5]=f=>$.value.phone=f),label:"Telefone (opcional)",size:"sm",placeholder:"(11) 99999-9999"},null,8,["modelValue"]),e("div",Rr,[e("label",Tr,[ee(e("input",{"onUpdate:modelValue":n[6]||(n[6]=f=>$.value.emailEnabled=f),type:"checkbox",class:"w-3 h-3 text-indigo-600 bg-slate-900 border-slate-600 rounded focus:ring-indigo-500"},null,512),[[ra,$.value.emailEnabled]]),n[16]||(n[16]=e("span",{class:"text-xs text-slate-300"},"Email",-1))]),e("label",Or,[ee(e("input",{"onUpdate:modelValue":n[7]||(n[7]=f=>$.value.whatsappEnabled=f),type:"checkbox",class:"w-3 h-3 text-indigo-600 bg-slate-900 border-slate-600 rounded focus:ring-indigo-500"},null,512),[[ra,$.value.whatsappEnabled]]),n[17]||(n[17]=e("span",{class:"text-xs text-slate-300"},"WhatsApp",-1))]),e("button",{onClick:L,disabled:!$.value.name||!$.value.email,class:"ml-auto px-2 py-1 bg-indigo-600 hover:bg-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed text-white text-xs rounded transition-colors"}," Adicionar ",8,jr)])]),d.value.length>0?(l(),i("div",Lr,[n[21]||(n[21]=e("label",{class:"block text-xs text-slate-400"},"Contatos externos:",-1)),(l(!0),i(se,null,ce(d.value,(f,V)=>(l(),i("div",{key:V,class:"flex items-center justify-between bg-slate-800/50 rounded-lg px-3 py-2"},[e("div",Gr,[e("div",Jr,I(f.name),1),e("div",Kr,I(f.email),1),e("div",Wr,[f.emailEnabled?(l(),i("span",Hr,[...n[18]||(n[18]=[e("i",{class:"fa-solid fa-envelope text-[8px]"},null,-1),T(" Email ",-1)])])):w("",!0),f.whatsappEnabled?(l(),i("span",Xr,[...n[19]||(n[19]=[e("i",{class:"fa-brands fa-whatsapp text-[8px]"},null,-1),T(" WhatsApp ",-1)])])):w("",!0)])]),e("button",{onClick:A=>K(V),class:"text-slate-400 hover:text-red-400 transition-colors"},[...n[20]||(n[20]=[e("i",{class:"fa-solid fa-times text-xs"},null,-1)])],8,Yr)]))),128))])):w("",!0)])])):w("",!0)])]),e("div",Qr,[e("button",{type:"button",class:"px-4 py-2 text-sm text-slate-300 hover:text-white transition-colors",onClick:ae}," Cancelar "),e("button",{type:"button",class:"px-4 py-2 bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 text-white text-sm font-medium rounded-md transition-colors",onClick:R,disabled:k.value},[k.value?(l(),i("i",ed)):w("",!0),T(" "+I(k.value?"Salvando...":"Salvar Alterações"),1)],8,Zr)])])]),_:1},8,["modelValue"]))}},ad=qe(td,[["__scopeId","data-v-aaa17e5e"]]);async function ld(r,S,c){if(!te())throw new Error("API disabled");return await Ie("/api/v1/files/presign-upload",{method:"POST",body:{filename:r,contentType:S,prefix:c}})}async function Kt(r,S){if(!te())throw new Error("API disabled");try{const{url:c,objectKey:_}=await ld(r.name,r.type||"application/octet-stream",S),m=await fetch(c,{method:"PUT",body:r,headers:{"Content-Type":r.type||"application/octet-stream"}});if(!m.ok)throw new Error(`Upload failed: ${m.status} ${m.statusText}`);return{objectKey:_,name:r.name,type:r.type,size:r.size}}catch(c){throw console.error("Upload error:",c),c}}function sd(){const r=x([]),S=x(!1),c=x(null),_=(s,d=[])=>{const $=[];return s.forms&&Object.keys(s.forms).forEach(U=>{const G=s.forms[U];!G||typeof G!="object"||Object.keys(G).forEach(j=>{const H=G[j];if(typeof H=="string"&&H.includes("/")){const z=H.split("/"),L=z[z.length-1]||H,K=m(L),ae=d.find(p=>p.id===j),R={id:`${s._id}_${U}_${j}`,objectKey:H,fileName:L,originalName:K,fileSize:0,contentType:k(K),uploadedAt:s.updatedAt||s.createdAt||new Date().toISOString(),proposalId:s._id,stageId:U,fieldId:j,fieldLabel:ae?.label||`Campo ${j}`,approvalStatus:"pending"};$.push(R)}})}),$},m=s=>{const d=/^\d+_(.+)$/,$=s.match(d);return $?$[1]:s},k=s=>{switch(s.split(".").pop()?.toLowerCase()){case"pdf":return"application/pdf";case"csv":return"text/csv";case"xlsx":case"xls":return"application/vnd.ms-excel";case"doc":case"docx":return"application/msword";case"png":return"image/png";case"jpg":case"jpeg":return"image/jpeg";case"gif":return"image/gif";case"txt":return"text/plain";default:return"application/octet-stream"}};return{files:r,loading:S,error:c,extractFilesFromProposal:_,formatFileSize:s=>{if(s===0)return"0 Bytes";const d=1024,$=["Bytes","KB","MB","GB"],U=Math.floor(Math.log(s)/Math.log(d));return parseFloat((s/Math.pow(d,U)).toFixed(2))+" "+$[U]},getFileIcon:s=>s.includes("image/")?"fa-solid fa-image text-blue-500":s.includes("pdf")?"fa-solid fa-file-pdf text-red-500":s.includes("word")?"fa-solid fa-file-word text-blue-600":s.includes("excel")||s.includes("spreadsheet")||s.includes("csv")?"fa-solid fa-file-excel text-green-600":s.includes("powerpoint")?"fa-solid fa-file-powerpoint text-orange-500":s.includes("zip")||s.includes("rar")?"fa-solid fa-file-zipper text-yellow-600":"fa-solid fa-file text-slate-500"}}function od(){const r=x([]),S=x(!1);async function c(){if(!te()){r.value=[];return}S.value=!0;try{const _=await Ie("/api/v1/users",{silent:!0});r.value=(_||[]).map(m=>({id:m.id,name:m.name||"Sem nome",email:m.email||"",roles:Array.isArray(m.roles)?m.roles:[],organizationId:m.organizationId}))}catch(_){console.warn("Erro ao buscar usuários da organização:",_),r.value=[]}finally{S.value=!1}}return{users:r,loading:S,fetchUsers:c}}function Ia(){const{user:r}=ea();async function S(y,s,d){const $={};return r.value?.id&&($["X-User-ID"]=r.value.id),r.value?.organizationId&&($["X-Organization-ID"]=r.value.organizationId),await Ie(`/api/v1/processes/${y}/proposals/${s}/access`,{method:"PUT",body:d,headers:$})}async function c(y,s){const d={};return r.value?.id&&(d["X-User-ID"]=r.value.id),r.value?.organizationId&&(d["X-Organization-ID"]=r.value.organizationId),await Ie(`/api/v1/processes/${y}/proposals/${s}/access`,{headers:d})}function _(y,s){return!y.createdBy&&y.isPublic===void 0||y.createdBy===s.id||(s.superUser||s.roles?.includes("admin"))&&y.organizationId===s.organizationId||y.isPublic?!0:!y.isPublic&&y.visibleToUsers?y.visibleToUsers.includes(s.id):!1}function m(y,s){return!!(y.createdBy===s.id||(s.superUser||s.roles?.includes("admin"))&&y.organizationId===s.organizationId)}function k(y,s){return y.filter(d=>_(d,s))}function v(y){if(y.isPublic)return{type:"public",label:"Público",description:"Todos da esteira podem ver",icon:"fa-solid fa-globe",color:"text-green-400"};const s=y.visibleToUsers?.length||0,d=y.externalNotifications?.length||0;return{type:"restricted",label:"Restrito",description:`${s} usuário(s)${d>0?` + ${d} externo(s)`:""}`,icon:"fa-solid fa-lock",color:"text-amber-400"}}return{canViewProposal:_,canEditProposal:m,filterVisibleProposals:k,getAccessInfo:v,updateProposalAccess:S,getProposalAccess:c}}function nd(){const r=x(!1),S=x(null);function c(s){S.value=s,r.value=!0}function _(){r.value=!1,S.value=null}async function m(s,d){const{success:$,error:U}=Ve(),{updateProposalAccess:G}=Ia();try{return await G(s,d.proposalId,d.accessData),$("Permissões de acesso atualizadas com sucesso!"),{proposalId:d.proposalId,updates:d.accessData}}catch(j){throw console.error("Erro ao salvar alterações de acesso:",j),U("Erro ao atualizar permissões. Tente novamente."),j}}function k(s,d,$){return s.map(U=>U.id===d?{...U,isPublic:$.isPublic,visibleToUsers:$.visibleToUsers,externalNotifications:$.externalNotifications}:U)}function v(s){if(s.isPublic)return{icon:"fa-solid fa-globe",color:"text-green-400",tooltip:"Público - Todos podem ver"};const d=s.visibleToUsers?.length||0,$=s.externalNotifications?.length||0;return{icon:"fa-solid fa-lock",color:"text-amber-400",tooltip:`Restrito - ${d} usuário(s)${$>0?` + ${$} externo(s)`:""}`}}function y(s,d){return!!(s.createdBy===d?.id||(d?.superUser||d?.roles?.includes("admin"))&&s.organizationId===d?.organizationId)}return{isEditAccessModalOpen:r,editingProposal:S,openEditAccessModal:c,closeEditAccessModal:_,saveAccessChanges:m,updateLocalProposal:k,getAccessIcon:v,canEditAccess:y}}const id={class:"min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900"},rd={class:"app-header relative bg-slate-900/80 backdrop-blur-xl border-b border-slate-700/50 px-4 py-4"},dd={class:"relative w-full flex items-center justify-between gap-3 flex-wrap"},ud={class:"flex items-center gap-4"},cd={class:"flex items-center gap-2"},pd={class:"bg-slate-800/80 p-0.5 rounded-md flex items-center"},vd={class:"bg-slate-800/80 rounded-md flex items-center"},fd={class:"p-3 sm:p-6"},md={key:0,class:"overflow-x-auto kanban-scroll"},gd=["onDragover","onDragenter","onDragleave","onDropCapture","onDrop"],bd={class:"flex items-center justify-between mb-1.5"},hd={class:"flex items-center gap-2"},xd=["draggable","onDragstart"],yd={class:"font-semibold text-xs"},$d={key:0,class:"text-[10px] px-1.5 py-0.5 rounded-full bg-slate-700 text-slate-300 border border-slate-600/60"},wd={class:"text-[11px] text-slate-400"},kd={key:1,class:"text-[10px] font-bold text-emerald-400"},_d={class:"space-y-2.5 min-h-10"},Vd=["draggable","onDragstart","onClick"],Id={class:"absolute top-1 right-1 z-10"},Cd=["onClick"],Sd={class:"mb-3 pr-4"},Pd={class:"font-medium leading-tight text-sm text-white"},Ad={key:0,class:"text-xs text-slate-300 mt-1"},Fd={class:"flex items-center justify-between"},Ed={class:"flex items-center gap-1"},Bd={key:0,class:"inline-flex items-center gap-1 rounded px-1.5 py-0.5 text-[8px] font-medium bg-red-900/60 text-red-300"},Ud=["onClick"],Dd={class:"truncate"},Nd={key:0,class:"text-sm text-slate-400"},Md={key:1,class:"bg-slate-800 rounded-lg"},zd={class:"sm:hidden"},qd={class:"divide-y divide-slate-700"},Rd={class:"absolute top-3 right-3 z-10"},Td=["onClick"],Od={class:"space-y-3 pr-6"},jd={class:"font-medium text-sm text-white"},Ld={key:0,class:"mt-1 text-xs text-slate-300"},Gd={class:"flex items-center justify-between"},Jd={class:"text-[8px] text-slate-500"},Kd=["onClick"],Wd={class:"truncate"},Hd={key:0,class:"p-3 text-slate-400 text-sm"},Xd={class:"hidden sm:block overflow-x-auto"},Yd={class:"w-full text-sm text-left"},Qd={class:"bg-slate-700/60 text-xs text-slate-300 uppercase"},Zd={key:0,class:"px-3 sm:px-6 py-2 sm:py-3"},eu={class:"px-3 sm:px-6 py-2 sm:py-3"},tu={key:0,class:"px-3 sm:px-6 py-2 sm:py-3"},au={class:"px-3 sm:px-6 py-2 sm:py-3"},lu={class:"px-3 sm:px-6 py-2 sm:py-3"},su=["onClick"],ou={class:"truncate"},nu={class:"px-3 sm:px-6 py-2 sm:py-3"},iu={class:"flex items-center gap-2 justify-end text-slate-300"},ru=["onClick"],du=["onClick"],uu=["onClick"],cu=["onClick"],pu={key:1,class:"flex flex-col items-center justify-center py-20 px-6 text-center text-slate-300 gap-3"},vu={class:"space-y-2"},fu={class:"bg-slate-800/30 rounded-lg p-4 border border-slate-700/40"},mu={class:"text-xs text-slate-400"},gu={class:"inline-flex items-center gap-2"},bu={class:"bg-slate-800/30 rounded-lg p-4 border border-slate-700/40"},hu={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3"},xu={key:0},yu={key:8,class:"text-[11px] text-red-400 mt-1"},$u={class:"space-y-3 mt-4 pt-4 border-t border-slate-700/40"},wu={key:0,class:"w-full"},ku={key:0,class:"text-[11px] text-red-400 mt-1"},_u={class:"space-y-3 mt-4"},Vu={key:0,class:"w-full"},Iu={key:0,class:"text-[11px] text-red-400 mt-1"},Cu={key:1,class:"w-full"},Su={key:0,class:"text-[11px] text-red-400 mt-1"};const Pu={class:"space-y-2"},Au={class:"flex items-center justify-between"},Fu={class:"grid grid-cols-1 md:grid-cols-2 gap-2 flex-1"},Eu={class:"text-[12px] text-slate-100"},Bu={class:"text-xs"},Uu={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3"},Du={key:0},Nu={class:"space-y-3"},Mu={key:0,class:"w-full"},zu={key:1,class:"w-full"},qu={key:2,class:"w-full"},Ru={class:"flex items-center gap-2"},Tu=["onClick"],Ou={key:0,class:"text-[12px] text-green-300"},ju={key:1,class:"text-[12px] text-slate-300"},Lu={class:"flex items-center justify-between gap-2"},Gu={class:"flex items-center gap-2"},Ju={class:"relative"},Ku=["value"],Wu={class:"flex items-center gap-2"},Hu={class:"relative p-2"},Xu={class:"space-y-0.5"},Yu=["disabled","onClick"],yt="application/x-stage-id",ba="consoria_chat_history",Qu={__name:"index",props:{pipelineKey:{type:String,default:"quotaequity"}},setup(r){vl({title:"Esteira"});const S=r,c=q(()=>S.pipelineKey||"quotaequity"),_=x(null),m=q(()=>{const o=_.value||{};return typeof o.type=="string"?o.type.trim().toUpperCase():o.isFinanceiro?"FINANCIAL":"GENERIC"}),k=q(()=>m.value==="FINANCIAL"),v=q(()=>m.value==="LEAD_QUALIFICATION"),y=q(()=>{const o=_.value?.allowedUserIds;return Array.isArray(o)?o.filter(a=>typeof a=="string").map(a=>a.trim()).filter(Boolean):[]}),s=q(()=>{const o=y.value;if(!o.length)return!0;const a=K.value;return a?.id?a.superUser?!0:o.includes(a.id):!1}),d=x(null);let $;const U=x([]);let G="";const j=()=>{U.value=[],G=""},H=async(o=!1)=>{if(!v.value||!te()){j();return}const a=c.value||"";if(!(!o&&G===a&&U.value.length))try{const{fetchLeadsApi:b}=await xt(async()=>{const{fetchLeadsApi:h}=await import("./B3Fs0kR7.js");return{fetchLeadsApi:h}},__vite__mapDeps([0,1,2]),import.meta.url),t=await b();U.value=Array.isArray(t)?t.map(h=>({id:h.id,name:h.name||"",email:h.email||"",phone:h.phone||""})):[],G=a}catch(b){console.error("Failed to load leads for modal:",b),j()}};pe(()=>[c.value,v.value],([,o])=>{if(!o){j();return}H()},{immediate:!0});const z=async()=>{if(c.value)try{const{getProcessInfo:o}=await xt(async()=>{const{getProcessInfo:a}=await import("./3xuymguz.js").then(b=>b.p);return{getProcessInfo:a}},__vite__mapDeps([3,4,1,2,5,6]),import.meta.url);_.value=await o(c.value)}catch(o){console.error("Error loading process info:",o)}},{openModal:L}=xl(),{user:K,load:ae}=ea(),{users:R,fetchUsers:p}=od(),{filterVisibleProposals:n}=Ia(),{isEditAccessModalOpen:f,editingProposal:V,openEditAccessModal:A,closeEditAccessModal:E,saveAccessChanges:P,updateLocalProposal:F,canEditAccess:D}=nd(),fe=async o=>{try{const a=await P(c.value,o);a&&(Z.value=F(Z.value,a.proposalId,a.updates),it(c.value,Z.value),E(),Pe())}catch(a){console.error("Erro ao salvar alterações de acesso:",a)}},Ae=x(!1),he=x("");sd();const{files:je,loadProcessFiles:dt,downloadFile:O}=Zt(),Q=x(!1);Ze(()=>{try{Q.value="ontouchstart"in window||navigator&&(navigator.maxTouchPoints||0)>0}catch{Q.value=!1}});const X=x([]),et=x(0);async function ut(){try{const{fetchStagesApi:o}=await xt(async()=>{const{fetchStagesApi:b}=await import("./3xuymguz.js").then(t=>t.o);return{fetchStagesApi:b}},__vite__mapDeps([3,4,1,2,5,6]),import.meta.url),{isApiEnabled:a}=await xt(async()=>{const{isApiEnabled:b}=await import("./BH6je_ft.js");return{isApiEnabled:b}},__vite__mapDeps([4,1,2,5]),import.meta.url);if(a()){const b=await o(c.value);if(Array.isArray(b)){X.value=b.map(t=>({id:t.id||t.key||t._id||(t.title||"").toLowerCase().replace(/\s+/g,"_"),title:t.title||t.name||"Etapa",slaDays:Number(t.slaDays??0),color:t.color||"sky",status:"Offline",defaultStatus:typeof t.defaultStatus=="string"?t.defaultStatus:typeof t.default_status=="string"?t.default_status:""}));return}}}catch{}try{const o=localStorage.getItem(`pipeline_config__${c.value}`);if(o){const a=JSON.parse(o);if(Array.isArray(a)){const b=Object.fromEntries(X.value.map(t=>[t.id,t.status]));X.value=a.map(t=>({id:t.id,title:t.title,slaDays:t.slaDays??0,color:t.color||"sky",status:b[t.id]||"Offline",defaultStatus:typeof t.defaultStatus=="string"?t.defaultStatus:typeof t.default_status=="string"?t.default_status:""}))}}}catch{}ct()}async function Le(){if(te())try{const o=await Lt(c.value);Array.isArray(o)&&(ge.value=o)}catch{}}Ze(async()=>{try{ae()}catch{}ut(),z(),Le();try{window.addEventListener("focus",Le)}catch{}try{At.value=await kl(),xe.value=await ua("ESTEIRA"),fl(()=>{console.log("Status colors loaded (ESTEIRA category):",xe.value.length,"items")})}catch(o){console.error("Failed to load status options:",o),At.value=["Api Offline"],xe.value=[]}}),ml(()=>{try{window.removeEventListener("focus",Le)}catch{}}),gl(()=>{Le()}),pe(()=>c.value,()=>{ut(),z(),sa(),qt(),te()&&Lt(c.value).then(o=>{Array.isArray(o)&&(ge.value=o)}).catch(()=>{})});const{proposals:Z,refresh:wt}=Cl(c.value),ge=q(()=>!K.value||!Z.value?Z.value||[]:te()?n(Z.value,K.value):Z.value),Pe=()=>{te()&&wt()};pe(()=>Z.value,()=>{$&&clearTimeout($),$=setTimeout(()=>{k.value&&d.value&&d.value.refresh()},300)},{deep:!0}),pe(()=>c.value,o=>{const a=$t(o);Z.value=Array.isArray(a)?a:[],te()&&Lt(o).then(b=>{Array.isArray(b)&&(Z.value=b)}).catch(()=>{})});const Ee=()=>{try{it(c.value,Z.value)}catch{}};function kt(o){try{return String(o||"").replace(/_/g," ").replace(/\b\w/g,b=>b.toUpperCase())}catch{return o}}function ct(){const o=new Set(X.value.map(b=>b.id)),a=new Set;for(const b of ge.value)b?.stageId&&!o.has(b.stageId)&&a.add(b.stageId);if(a.size){const b=Array.from(a).map(t=>({id:t,title:kt(t),slaDays:0,status:"Offline",color:"sky",defaultStatus:"",auto:!0}));X.value=X.value.concat(b)}}pe(()=>Z.value.map(o=>o.stageId).join("|"),()=>ct());const tt=x(""),pt=x(""),_t=x(!1),Re=x("kanban"),at=x("default"),vt=o=>{const a=[...o];switch(at.value){case"name-asc":return a.sort((b,t)=>b.name.localeCompare(t.name));case"name-desc":return a.sort((b,t)=>t.name.localeCompare(b.name));case"amount-asc":return a.sort((b,t)=>(b.amount||0)-(t.amount||0));case"amount-desc":return a.sort((b,t)=>(t.amount||0)-(b.amount||0));case"date-newest":return a.sort((b,t)=>new Date(t.stageEnteredAt||t.createdAt||0)-new Date(b.stageEnteredAt||b.createdAt||0));case"date-oldest":return a.sort((b,t)=>new Date(b.stageEnteredAt||b.createdAt||0)-new Date(t.stageEnteredAt||t.createdAt||0));default:return a}},Ge=q(()=>n(ge.value,K.value||{}).filter(a=>{const b=a.name.toLowerCase().includes(tt.value.toLowerCase()),t=!pt.value||a.status===pt.value,h=_t.value?!0:!a.isArchived;return b&&t&&h})),Fe=q(()=>vt(Ge.value));async function Je(o){_e.value=o;try{He.value=await da(String(o.stageId))}catch{He.value=[]}if(J.value={},te())try{const a=await Vl(c.value,String(o.id));J.value=a&&a[String(o.stageId)]?{...a[String(o.stageId)]}:{}}catch{}try{o.processExternalId&&await dt(o.processExternalId)}catch(a){console.warn("Failed to load process files:",a)}Ne.value=o.status||"Offline";try{xe.value=await ua("ESTEIRA"),console.log("Status options refreshed on card open (ESTEIRA category):",xe.value.length,"items")}catch(a){console.error("Failed to refresh status options:",a)}Ue.value=!0}async function Vt(){const o=_e.value;if(!o){Ue.value=!1;return}try{te()&&await pa(c.value,String(o.id),String(o.stageId),J.value)}catch{}Ue.value=!1}function It(o){g.value=o,me.value=!0}function Ke(){me.value=!1,g.value=null}async function Ct(){const o=g.value;if(!o)return Ke();const a=Z.value.slice();Z.value=Z.value.filter(b=>b.id!==o.id);try{te()?await Il(c.value,String(o.id))?Pe():Z.value=a:Ee()}catch{ge.value=a}Ke()}async function St(){const o=_e.value;if(!o)return;const a=o.status,{success:b,error:t}=Ve();o.status=Ne.value;const h=ge.value.findIndex(B=>B.id===o.id);h!==-1&&(ge.value[h].status=Ne.value);try{te()?(await Gt(c.value,String(o.id),{status:Ne.value}),b("Status atualizado com sucesso!"),Pe()):(Ee(),b("Status atualizado!"))}catch(B){console.error("Failed to update proposal status:",B),t("Erro ao atualizar status. Tente novamente."),o.status=a;const N=ge.value.findIndex(we=>we.id===o.id);N!==-1&&(ge.value[N].status=a)}}function Be(o,a=.2){const b=parseInt(o.slice(1,3),16),t=parseInt(o.slice(3,5),16),h=parseInt(o.slice(5,7),16);return`rgba(${b}, ${t}, ${h}, ${a})`}function We(o){if(!o||!xe.value.length)return null;const a=xe.value.find(t=>t.name===o);if(a?.color)return Be(a.color,.6);const b=xe.value.find(t=>t.name?.toLowerCase()===o.toLowerCase());return b?.color?Be(b.color,.2):null}function lt(o){if(!o||!xe.value.length)return"";const a=xe.value.find(b=>b.name===o);if(a?.color){const b=a.color;return`
      background: linear-gradient(135deg, ${Be(b,.15)}, ${Be(b,.05)});
      color: ${b};
      border: 1px solid ${Be(b,.3)};
      box-shadow: 0 2px 8px ${Be(b,.15)};
      backdrop-filter: blur(4px);
    `.replace(/\s+/g," ").trim()}return`
    background: linear-gradient(135deg, rgba(156, 163, 175, 0.15), rgba(156, 163, 175, 0.05));
    color: #9ca3af;
    border: 1px solid rgba(156, 163, 175, 0.3);
    box-shadow: 0 2px 8px rgba(156, 163, 175, 0.15);
    backdrop-filter: blur(4px);
  `.replace(/\s+/g," ").trim()}function Pt(o){Je(o)}const Ue=x(!1),_e=x(null),He=x([]),J=x({}),me=x(!1),g=x(null),u=x(!1),C=x(null),ne=x(!1),ie=x(null),be=x({top:0,left:0}),De=x(!1),Ce=x(!1),Ne=x(""),At=x([]),xe=x([]);Zt();const Ca=q(()=>je.value.length),ft=o=>{const a=Ge.value.filter(b=>b.stageId===o);return vt(a)},Ft=o=>X.value.find(a=>a.id===o)?.title||o,Sa=o=>k.value?ft(o).reduce((b,t)=>b+(Number(t.amount)||0),0):0,ta=o=>{const a=Sa(o);return a===0?"":new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL",minimumFractionDigits:0,maximumFractionDigits:0}).format(a)},Et=o=>{if(We(o))return"ring-1 ring-inset transition-colors";if(!o)return"bg-slate-700 text-slate-300 ring-1 ring-inset ring-slate-500/20"},Bt={sky:{border:"border-sky-500",strip:"bg-sky-500",badge:"bg-sky-900/50 text-sky-300 ring-1 ring-inset ring-sky-500/20"},indigo:{border:"border-indigo-500",strip:"bg-indigo-500",badge:"bg-indigo-900/50 text-indigo-300 ring-1 ring-inset ring-indigo-500/20"},amber:{border:"border-amber-500",strip:"bg-amber-500",badge:"bg-amber-900/50 text-amber-300 ring-1 ring-inset ring-amber-500/20"},rose:{border:"border-rose-500",strip:"bg-rose-500",badge:"bg-rose-900/50 text-rose-300 ring-1 ring-inset ring-rose-500/20"},green:{border:"border-green-500",strip:"bg-green-500",badge:"bg-green-900/50 text-green-300 ring-1 ring-inset ring-green-500/20"},purple:{border:"border-purple-500",strip:"bg-purple-500",badge:"bg-purple-900/50 text-purple-300 ring-1 ring-inset ring-purple-500/20"},blue:{border:"border-blue-500",strip:"bg-blue-500",badge:"bg-blue-900/50 text-blue-300 ring-1 ring-inset ring-blue-500/20"},orange:{border:"border-indigo-500",strip:"bg-indigo-600",badge:"bg-indigo-900/50 text-indigo-300 ring-1 ring-inset ring-indigo-500/20"},teal:{border:"border-teal-500",strip:"bg-teal-500",badge:"bg-teal-900/50 text-teal-300 ring-1 ring-inset ring-teal-500/20"},cyan:{border:"border-cyan-500",strip:"bg-cyan-500",badge:"bg-cyan-900/50 text-cyan-300 ring-1 ring-inset ring-cyan-500/20"},lime:{border:"border-lime-500",strip:"bg-lime-500",badge:"bg-lime-900/50 text-lime-300 ring-1 ring-inset ring-lime-500/20"},emerald:{border:"border-emerald-500",strip:"bg-emerald-500",badge:"bg-emerald-900/50 text-emerald-300 ring-1 ring-inset ring-emerald-500/20"},fuchsia:{border:"border-fuchsia-500",strip:"bg-fuchsia-500",badge:"bg-fuchsia-900/50 text-fuchsia-300 ring-1 ring-inset ring-fuchsia-500/20"},violet:{border:"border-violet-500",strip:"bg-violet-500",badge:"bg-violet-900/50 text-violet-300 ring-1 ring-inset ring-violet-500/20"},pink:{border:"border-pink-500",strip:"bg-pink-500",badge:"bg-pink-900/50 text-pink-300 ring-1 ring-inset ring-pink-500/20"},red:{border:"border-red-500",strip:"bg-red-500",badge:"bg-red-900/50 text-red-300 ring-1 ring-inset ring-red-500/20"},yellow:{border:"border-yellow-500",strip:"bg-yellow-500",badge:"bg-yellow-900/50 text-yellow-300 ring-1 ring-inset ring-yellow-500/20"},slate:{border:"border-slate-500",strip:"bg-slate-500",badge:"bg-slate-900/50 text-slate-300 ring-1 ring-inset ring-slate-500/20"},stone:{border:"border-stone-500",strip:"bg-stone-500",badge:"bg-stone-900/50 text-stone-300 ring-1 ring-inset ring-stone-500/20"},zinc:{border:"border-zinc-500",strip:"bg-zinc-500",badge:"bg-zinc-900/50 text-zinc-300 ring-1 ring-inset ring-zinc-500/20"}},Pa=o=>{const a=X.value.find(b=>b.id===o);return a&&Bt[a.color]?.border||"border-slate-500"},Aa=o=>{const a=X.value.find(b=>b.id===o);return a&&Bt[a.color]?.strip||"bg-slate-500"},Fa=o=>{const a=X.value.find(b=>b.id===o);return a&&Bt[a.color]?.badge||"bg-slate-700 text-slate-300 ring-1 ring-inset ring-slate-500/20"},Ut=o=>{const b=X.value.find(re=>re.id===o.stageId)?.slaDays??0;if(!b||!o.stageEnteredAt)return{days:0,sla:b,remaining:0,status:"ok"};const t=new Date(o.stageEnteredAt),h=new Date,B=1440*60*1e3,N=Math.max(0,Math.ceil((h.getTime()-t.getTime())/B)),we=b-N;let W="ok";return N>b?W="overdue":N>=Math.max(1,Math.floor(b*.8))&&(W="warning"),{days:N,sla:b,remaining:we,status:W}},Ea=o=>{const{status:a}=Ut(o);return a==="overdue"?"bg-red-900/60 text-red-300":a==="warning"?"bg-amber-900/60 text-amber-300":"bg-slate-700 text-slate-300"},Ba=o=>{const{days:a,sla:b}=Ut(o);return b?`${a}/${b}d`:"SLA N/A"},st=x(null),ot=x(""),Xe=x(""),Dt=x(-1),nt=q(()=>!!Xe.value),Ua=(o,a)=>{st.value=a.id,o?.dataTransfer&&(o.dataTransfer.effectAllowed="move",o.dataTransfer.setData("text/plain",String(a.id)))},mt=()=>{st.value=null,ot.value=""},Da=o=>{nt.value||(ot.value=o)},Na=o=>{nt.value||ot.value===o&&(ot.value="")},Ma=o=>{if(nt.value||!st.value)return;const a=Z.value.findIndex(N=>N.id===st.value);if(a===-1)return mt();const b=X.value.find(N=>N.id===o);if(!b)return mt();const t=b.defaultStatus&&b.defaultStatus.trim()!==""?b.defaultStatus:Z.value[a].status||"Offline",h={...Z.value[a],stageId:o,status:t,stageEnteredAt:new Date().toISOString()},B=Z.value.slice();if(B[a]=h,Z.value=B,te()){const N=String(h.id),we=Z.value[a];Gt(c.value,N,{stageId:o,status:t}).then(()=>{}).catch(()=>{const W=Z.value.slice();W[a]={...we},Z.value=W})}else Ee();mt()};function za(o,a,b){if(Xe.value=a.id,o?.dataTransfer){o.dataTransfer.effectAllowed="move";try{o.dataTransfer.setData(yt,a.id)}catch{}}}function Nt(){Xe.value="",Dt.value=-1}function qa(o,a){!Xe.value||!Array.from(o?.dataTransfer?.types||[]).includes(yt)||(o.preventDefault(),Dt.value=a)}function Ra(){if(te()){const{success:o,error:a}=Ve(),b=X.value.map(t=>({id:t.id,title:t.title}));wl(c.value,b,X.value).then(t=>{if(Array.isArray(t)&&t.length){const B={};try{X.value.forEach(N=>{B[N.title]=N.status||"Offline"})}catch{}X.value=t.map(N=>({id:N.id,title:N.title,slaDays:N.slaDays,color:N.color,status:B[N.title]||"Offline"}))}const h=Date.now();h-et.value>1500&&(o("Colunas atualizadas"),et.value=h)}).catch(()=>a("Falha ao salvar colunas"));return}try{localStorage.setItem(`pipeline_config__${c.value}`,JSON.stringify(X.value))}catch{}}function Ta(o,a){if(!Array.from(o?.dataTransfer?.types||[]).includes(yt))return;o.preventDefault(),o.stopPropagation();const t=o.dataTransfer.getData(yt)||Xe.value,h=X.value.findIndex(we=>we.id===t);if(h<0||a<0||h===a){Nt();return}const B=X.value.slice(),[N]=B.splice(h,1);B.splice(a,0,N),X.value=B,Ra(),Nt()}const Mt=x(!1),Zu=["AC","AL","AP","AM","BA","CE","DF","ES","GO","MA","MT","MS","MG","PA","PB","PR","PE","PI","RJ","RN","RS","RO","RR","SC","SP","SE","TO"],ec=["TOCO","LANCE","AMAURI","Tramonta","Fraga & Bitello","SI","Larban","DW Consórcios"],tc=["CREMONA","SAVEL","FOUR CAPITAL","VALOR","LARBAN"],ac=["ConsorEquity","Fundo Inter","Flex","Outro"],lc=["Itaú","HS","Bradesco"],sc=["Imóvel","Veículo","Aplicação","Outro"],oc=["Compra de imóvel","Reforma","Capital de giro","Outros"],Oa=["Sem representante","Ana","Bruno","Carlos"],ja=["Sem gerente","Juliana Rezende","Rafael Santos","Carla Lima"],Te=x({name:"",cpf:"",cep:"",city:"",state:"",administrator:"",bank:"",fund:"",productType:"",summary:"",startDate:"",amountDesired:0,guaranteeValue:0,guaranteeType:"",objective:"",representative:Oa[0],manager:ja[0],stageId:X.value[0]?.id||"dados_basicos"}),La=x({name:"",cpf:"",amountDesired:""}),Ga=async()=>{if(!s.value){const{warning:a}=Ve();a("Você não tem permissão para criar registros nesta esteira.");return}X.value[0]?.id,qt(),v.value&&await H(!0),await p(),L({stages:X.value,stageFields:ye.value,pipelineKey:c.value,isFinancial:k.value,leadOptions:v.value?U.value:[],showAccessControl:!0,availableUsers:R.value,onSave:a=>{Ya(a)}});const{info:o}=Ve();ye.value.length>0?o(`Carregados ${ye.value.length} campos da primeira etapa: ${X.value[0]?.title||"Primeira Etapa"}`):o(`Abrindo formulário da primeira etapa: ${X.value[0]?.title||"Primeira Etapa"}`)},Ja=()=>{Ce.value=!0},Ka=async()=>{if(_e.value&&_e.value.processExternalId)try{await dt(_e.value.processExternalId)}catch(o){console.warn("Failed to refresh process files:",o)}},Wa=({file:o,approvalBy:a})=>{console.log(`Aprovando arquivo ${o.id} por ${a}`);const{success:b}=Ve();b(`Arquivo "${o.originalName}" aprovado por ${a}`)},Ha=({file:o})=>{console.log(`Reprovando arquivo ${o.id}`);const{warning:a}=Ve();a(`Arquivo "${o.originalName}" reprovado`)},Xa=async({file:o})=>{try{await O(o)}catch(a){const{error:b}=Ve();b(`Erro ao baixar arquivo "${o.originalName}"`),console.error("Download error:",a)}},Ya=o=>{const{success:a,error:b}=Ve();X.value.find(B=>B.id===o.stageId);const t=Date.now().toString(),h={id:t,name:o.name,amount:o.amount,stageId:o.stageId,status:o.status,isArchived:!1,stageEnteredAt:new Date().toISOString(),stageValues:o.fieldValues||{},files:o.fieldFiles||{},details:o.leadId?{leadId:o.leadId}:void 0,createdBy:K.value?.id,organizationId:K.value?.organizationId,isPublic:o.isPublic,visibleToUsers:o.visibleToUsers||[],externalNotifications:o.externalNotifications||[]};if(Z.value.push(h),it(c.value,Z.value),te()){const B={name:o.name,amount:o.amount,stageId:o.stageId,status:o.status,createdBy:K.value?.id,organizationId:K.value?.organizationId,isPublic:o.isPublic,visibleToUsers:o.visibleToUsers||[],externalNotifications:o.externalNotifications||[]};o.leadId&&(B.details={leadId:o.leadId}),console.log("Creating proposal via API with payload:",B),ca(c.value,B).then(async N=>{if(N?.id){const we=String(N.id),W=Z.value.findIndex(re=>re.id===t);W>=0&&(Z.value[W].id=we,Z.value[W].details=N.details||Z.value[W].details,it(c.value,Z.value),Pe());for(const[re,Ye]of Object.entries(o.fieldFiles||{}))if(Ye&&Ye.length>0)try{await Kt(we,Ye[0])}catch(Oe){console.warn(`Erro ao fazer upload do arquivo ${re}:`,Oe)}}a("Registro criado com sucesso!")}).catch(N=>{console.error("Erro ao criar registro via API:",N),N("Erro ao salvar registro na API, mantido localmente")})}else a("Registro criado com sucesso!")},aa=()=>{Mt.value=!1},Qa=()=>(La.value={name:"",cpf:"",amountDesired:""},!0),Za=()=>{const{warning:o}=Ve();Qa(),$e.value={};let a=!0;for(const W of ye.value)W?.required&&(W.type==="file"?ht.value?.[W.id]?.length||($e.value[W.id]="Obrigatório",a=!1):(le.value?.[W.id]??"").toString().trim()||($e.value[W.id]="Obrigatório",a=!1));if(!a){el.value=!0,o("Preencha os campos obrigatórios da etapa");return}const b=X.value.find(W=>W.id===Te.value.stageId);console.log("Creating new card - Stage found:",b,"defaultStatus:",b?.defaultStatus);const t=W=>{const re=String(W||"").trim();if(!re)return 0;const Ye=re.replace(/\./g,"").replace(/,/g,"."),Oe=Number(Ye);return isNaN(Oe)?0:Oe},h=()=>{for(const re of ye.value)if((re.label||"").toLowerCase().includes("nome")){const Oe=(le.value?.[re.id]||"").toString().trim();if(Oe)return Oe}const W=ye.value.find(re=>re.type==="text");return(W?(le.value?.[W.id]||"").toString().trim():"")||"Registro"},B=()=>{for(const W of ye.value)if(W.type==="number"){const re=(W.label||"").toLowerCase();if(re.includes("valor")||re.includes("amount")||re.includes("preço")||re.includes("preco"))return t(le.value?.[W.id])}return 0},N={name:h(),amount:B(),stageId:Te.value.stageId,status:b?.defaultStatus||"Offline"},we=(()=>{const W={};try{for(const re of ye.value)W[re.id]=le.value?.[re.id]??""}catch{}return W})();if(te())ca(c.value,N).then(async W=>{if(W){try{await pa(c.value,String(W.id),String(W.stageId),we)}catch{}ge.value=[W,...ge.value],Pe()}}).catch(()=>{});else{const W=Date.now();ge.value.unshift({id:W,name:N.name,amount:N.amount,stageId:N.stageId,status:N.status,isArchived:!1,stageEnteredAt:new Date().toISOString(),details:void 0}),Ee(),Pe()}aa()},zt=x(!1),gt=x(""),el=x(!1),la=x("");pe(()=>Te.value.cep,o=>{const a=String(o||"").replace(/\D/g,"");a.length===8&&a!==la.value&&!zt.value&&(la.value=a,tl()),a.length<8&&(gt.value="")});const tl=async()=>{gt.value="";const o=(Te.value.cep||"").replace(/\D/g,"");if(o.length!==8){gt.value="Informe 8 dígitos";return}zt.value=!0;try{const a=await $fetch("/api/cep?cep="+o);a&&(Te.value.city=a.city||"",Te.value.state=a.state||"")}catch(a){gt.value=a?.statusMessage||"Erro ao buscar CEP"}finally{zt.value=!1}},nc=x([]),bt=x({}),ye=x([]),le=x({}),ht=x({}),$e=x({});function sa(){try{const o=localStorage.getItem(`pipeline_stage_forms__${c.value}`);o&&(bt.value=JSON.parse(o)||{})}catch{bt.value={}}}function qt(){const o=Te.value.stageId,a=()=>{const t=Array.isArray(bt.value[o])?bt.value[o]:[];ye.value=t;const h={};t.forEach(B=>{B.type!=="file"&&(h[B.id]="")}),le.value=h,ht.value={},$e.value={}},b=typeof o=="string"&&/^[a-fA-F0-9]{24}$/.test(o);te()&&b?da(o).then(t=>{const h=Array.isArray(t)?t.map(N=>({id:N.id||N.label,label:N.label,type:N.type,required:!!N.required,placeholder:N.placeholder||"",options:Array.isArray(N.options)?N.options:[]})):[];ye.value=h;const B={};h.forEach(N=>{N.type!=="file"&&(B[N.id]="")}),le.value=B,ht.value={},$e.value={}}).catch(()=>a()):a()}function al(o,a){ht.value[o]=a;try{if(te()){const b=Array.from(a||[]);console.log("Uploading files:",b.map(t=>t.name)),Promise.all(b.map(t=>Kt(t,"proposals/tmp"))).then(t=>{console.log("Upload success:",t);const h=t.map(B=>B.objectKey);le.value[o]=b.length<=1?h[0]:h}).catch(t=>{console.error("Upload failed:",t);const h=b.map(B=>B.name);le.value[o]=b.length<=1?h[0]:h})}}catch(b){console.error("onExtraFile error:",b)}}function ll(o,a){try{if(te()){const b=Array.from(a||[]);Promise.all(b.map(t=>Kt(t,`proposals/${_e.value?.id||"unknown"}`))).then(t=>{const h=t.map(B=>B.objectKey);J.value[o]=b.length<=1?h[0]:h}).catch(()=>{})}}catch{}}function Rt(o,a){a.stopPropagation();const b=a.target.getBoundingClientRect(),t=140,h=160;let B=b.bottom+window.scrollY+8,N=b.left+window.scrollX;window.innerWidth<768?(N=Math.max(16,(window.innerWidth-t)/2),B=b.bottom+window.scrollY+12):(N+t>window.innerWidth&&(N=b.right+window.scrollX-t),B+h>window.innerHeight+window.scrollY&&(B=b.top+window.scrollY-h-8),N=Math.max(16,Math.min(N,window.innerWidth-t-16)),B=Math.max(16,B)),be.value={top:B,left:N},ie.value=o,ne.value=!0}async function sl(o){if(!ie.value||De.value)return;De.value=!0;const a=ie.value.status;try{const b=ie.value;if(b.status=o,te())await Gt(c.value,b.id,{status:o});else{const h=await $t(),B=h.findIndex(N=>N.id===b.id);B!==-1&&(h[B]={...h[B],status:o,updatedAt:new Date().toISOString()},await it(h))}const t=X.value.find(h=>h.proposals?.some(B=>B.id===b.id));if(t){const h=t.proposals.findIndex(B=>B.id===b.id);h!==-1&&(t.proposals[h]={...t.proposals[h],status:o,updatedAt:new Date().toISOString()})}oa(),Ve().add({title:"Status atualizado!",description:`Status alterado para "${o}"`,color:"green"})}catch(b){console.error("Erro ao atualizar status:",b),ie.value.status=a;const t=X.value.find(h=>h.proposals?.some(B=>B.id===ie.value.id));if(t){const h=t.proposals.findIndex(B=>B.id===ie.value.id);h!==-1&&(t.proposals[h].status=a)}Ve().add({title:"Erro",description:"Não foi possível atualizar o status. Tente novamente.",color:"red"})}finally{De.value=!1}}function oa(){ne.value=!1,ie.value=null}Ze(()=>{sa(),qt()});const Tt=x(!1),Me=x([{role:"assistant",content:"Olá! Eu sou a ConsorIA. Como posso ajudar hoje?"}]),Ot=x(!1),ol=()=>{try{const o=localStorage.getItem(ba);if(o){const a=JSON.parse(o);Array.isArray(a)&&a.every(b=>b&&typeof b.role=="string")&&(Me.value=a)}}catch{}Tt.value=!0},nl=o=>{C.value=o,u.value=!0},na=()=>{u.value=!1},il=async o=>{try{C.value&&(J.value[C.value]=o),na(),C.value=null}catch(a){console.error("Erro ao salvar qualificação:",a)}},rl=async({text:o,attachments:a})=>{Me.value.push({role:"user",content:o,attachments:a}),Ot.value=!0;try{const b=Me.value.slice(-8).map(h=>({role:h.role,content:h.content})),t=await $fetch("/api/ai",{method:"POST",body:{text:o,attachments:a,history:b}});Me.value.push({role:"assistant",content:t?.text||t?.message||"Sem resposta."})}catch{Me.value.push({role:"assistant",content:"Falha ao obter resposta da IA. Verifique sua configuração."})}finally{Ot.value=!1}};return pe(()=>Me.value.length,()=>{try{localStorage.setItem(ba,JSON.stringify(Me.value.slice(-50)))}catch{}}),(o,a)=>{const b=yl("AiSearch");return l(),i("div",id,[s.value?(l(),i(se,{key:0},[e("header",rd,[a[40]||(a[40]=e("div",{class:"absolute inset-0 bg-white/[0.02] backdrop-blur-3xl"},null,-1)),e("div",dd,[e("div",ud,[Y(Ol,{"pipeline-key":c.value,"is-financial-process":k.value,proposals:ge.value,ref_key:"financialStatsRef",ref:d},null,8,["pipeline-key","is-financial-process","proposals"])]),e("div",cd,[e("div",pd,[e("button",{onClick:a[0]||(a[0]=t=>Re.value="kanban"),class:M([Re.value==="kanban"?"bg-indigo-600 text-white":"text-slate-300 hover:bg-slate-700/80","px-2 py-0.5 rounded-md text-[11px] font-medium transition-colors flex items-center gap-1"])},[...a[35]||(a[35]=[e("i",{class:"fa-solid fa-grip-vertical"},null,-1),T(" Kanban ",-1)])],2),e("button",{onClick:a[1]||(a[1]=t=>Re.value="list"),class:M([Re.value==="list"?"bg-indigo-600 text-white":"text-slate-300 hover:bg-slate-700/80","px-2 py-0.5 rounded-md text-[11px] font-medium transition-colors flex items-center gap-1"])},[...a[36]||(a[36]=[e("i",{class:"fa-solid fa-list"},null,-1),T(" Lista ",-1)])],2)]),e("div",vd,[ee(e("select",{"onUpdate:modelValue":a[2]||(a[2]=t=>at.value=t),class:"bg-transparent border-none text-slate-300 text-[11px] px-2 py-1 rounded-md focus:outline-none focus:ring-0 cursor-pointer"},[...a[37]||(a[37]=[wa('<option value="default" class="bg-slate-800 text-slate-300" data-v-6989ece0> Padrão </option><option value="name-asc" class="bg-slate-800 text-slate-300" data-v-6989ece0> Nome (A-Z) </option><option value="name-desc" class="bg-slate-800 text-slate-300" data-v-6989ece0> Nome (Z-A) </option><option value="amount-asc" class="bg-slate-800 text-slate-300" data-v-6989ece0> Valor (Menor) </option><option value="amount-desc" class="bg-slate-800 text-slate-300" data-v-6989ece0> Valor (Maior) </option><option value="date-newest" class="bg-slate-800 text-slate-300" data-v-6989ece0> Mais Recente </option><option value="date-oldest" class="bg-slate-800 text-slate-300" data-v-6989ece0> Mais Antigo </option>',7)])],512),[[rt,at.value]])]),e("button",{onClick:ol,class:"consoria-btn bg-gradient-to-r from-purple-600 to-indigo-600 hover:from-purple-500 hover:to-indigo-500 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-purple-400 text-white font-medium px-2.5 py-1 rounded-md transition-all duration-300 flex items-center gap-1.5 text-xs relative overflow-hidden group"},[...a[38]||(a[38]=[e("div",{class:"absolute inset-0 -translate-x-full bg-gradient-to-r from-transparent via-white/20 to-transparent group-hover:translate-x-full transition-transform duration-700"},null,-1),e("div",{class:"w-2 h-2 bg-emerald-400 rounded-full animate-pulse"},null,-1),e("i",{class:"fa-solid fa-robot text-[11px] group-hover:scale-110 transition-transform duration-300"},null,-1),e("span",{class:"hidden sm:inline relative z-10"},"ConsorIA",-1)])]),e("button",{onClick:Ga,class:"bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 text-white font-medium px-2.5 py-1 rounded-md transition-colors flex items-center gap-1 text-xs"},[...a[39]||(a[39]=[e("i",{class:"fa-solid fa-plus text-[10px]"},null,-1),e("span",{class:"hidden sm:inline"},"Novo Registro",-1)])])])])]),e("main",fd,[Re.value==="kanban"?(l(),i("div",md,[Y(bl,{name:"kanban-col",tag:"div",class:"grid grid-flow-col auto-cols-[14rem] sm:auto-cols-[15rem] md:auto-cols-[16rem] gap-3 min-h-[10rem] pb-2"},{default:ve(()=>[(l(!0),i(se,null,ce(X.value,(t,h)=>(l(),i("div",{key:t.id,class:M(["w-full bg-slate-800 rounded-md p-1.5 transition-colors",[ot.value===t.id?"ring-2 ring-blue-400 ring-offset-0":"",nt.value&&Dt.value===h?"ring-2 ring-indigo-400":"",nt.value&&Xe.value===t.id?"opacity-90":""]]),onDragover:ke(B=>qa(B,h),["prevent"]),onDragenter:ke(B=>Da(t.id),["prevent"]),onDragleave:B=>Na(t.id),onDropCapture:B=>Ta(B,h),onDrop:B=>Ma(t.id)},[e("div",{class:M(["h-1 rounded-md mb-2",Aa(t.id)])},null,2),e("div",bd,[e("div",hd,[e("button",{class:"text-slate-300/80 hover:text-white px-1 py-0.5 rounded",title:"Reordenar coluna",draggable:!Q.value,onDragstart:B=>za(B,t,h),onDragend:Nt},[...a[41]||(a[41]=[e("i",{class:"fa-solid fa-grip-vertical"},null,-1)])],40,xd),e("h3",yd,I(t.title),1),t.auto?(l(),i("span",$d,"auto")):w("",!0),e("span",wd,"SLA "+I(t.slaDays)+"d",1),k.value&&ta(t.id)?(l(),i("span",kd,I(ta(t.id)),1)):w("",!0)]),e("span",{class:M(["text-[10px] font-semibold px-2 py-0.5 rounded-full",Fa(t.id)])},I(ft(t.id).length),3)]),e("div",_d,[(l(!0),i(se,null,ce(ft(t.id),B=>(l(),i("div",{key:B.id,class:M(["group relative bg-slate-700 rounded-lg p-3 shadow-sm cursor-move border-l-4 hover:bg-slate-600/50 transition-colors",[st.value===B.id?"opacity-60":"",Pa(B.stageId)]]),draggable:!Q.value,onDragstart:N=>Ua(N,B),onClick:N=>Je(B),onDragend:mt},[e("div",Id,[oe(D)(B,oe(K))?(l(),i("button",{key:0,class:"opacity-0 group-hover:opacity-70 hover:!opacity-100 transition-opacity duration-200 text-slate-400 hover:text-white text-xs p-1 rounded",title:"Editar controle de acesso",onClick:ke(N=>oe(A)(B),["stop"])},[...a[42]||(a[42]=[e("i",{class:"fa-solid fa-ellipsis text-[10px]"},null,-1)])],8,Cd)):w("",!0)]),e("div",Sd,[e("div",Pd,I(B.name),1),k.value?(l(),i("div",Ad," R$ "+I(B.amount.toLocaleString("pt-BR")),1)):w("",!0)]),e("div",Fd,[e("div",Ed,[e("span",{class:M(["inline-flex items-center gap-1 rounded px-1.5 py-0.5 text-[8px] font-medium",Ea(B)])},[a[43]||(a[43]=e("i",{class:"fa-regular fa-calendar text-[7px]"},null,-1)),T(" "+I(Ba(B)),1)],2),Ut(B).status==="overdue"?(l(),i("span",Bd,[...a[44]||(a[44]=[e("i",{class:"fa-solid fa-flag text-[7px]"},null,-1),T(" Atraso ",-1)])])):w("",!0)]),e("span",{class:M([Et(B.status),"inline-flex items-center gap-1 text-[9px] font-medium px-2 py-0.5 rounded-md transition-all duration-300 hover:scale-105 whitespace-nowrap cursor-pointer hover:brightness-110"]),style:Qe(lt(B.status)),onClick:N=>Rt(B,N),title:"Clique para alterar o status"},[a[45]||(a[45]=e("div",{class:"w-1 h-1 rounded-full bg-current opacity-70 flex-shrink-0"},null,-1)),e("span",Dd,I(B.status),1)],14,Ud)])],42,Vd))),128)),ft(t.id).length===0?(l(),i("div",Nd," Sem propostas ")):w("",!0)])],42,gd))),128))]),_:1})])):(l(),i("div",Md,[e("div",zd,[e("ul",qd,[(l(!0),i(se,null,ce(Fe.value,t=>(l(),i("li",{key:t.id,class:"group relative p-4"},[e("div",Rd,[oe(D)(t,oe(K))?(l(),i("button",{key:0,class:"opacity-0 group-hover:opacity-70 hover:!opacity-100 transition-opacity duration-200 text-slate-400 hover:text-white text-sm p-1 rounded",title:"Editar controle de acesso",onClick:ke(h=>oe(A)(t),["stop"])},[...a[46]||(a[46]=[e("i",{class:"fa-solid fa-ellipsis text-[11px]"},null,-1)])],8,Td)):w("",!0)]),e("div",Od,[e("div",null,[e("div",jd,I(t.name),1),k.value?(l(),i("div",Ld," R$ "+I(t.amount.toLocaleString("pt-BR")),1)):w("",!0)]),e("div",Gd,[e("div",Jd,[a[47]||(a[47]=e("i",{class:"fa-solid fa-layer-group text-[7px]"},null,-1)),T(" "+I(Ft(t.stageId)),1)]),e("span",{class:M([Et(t.status),"inline-flex items-center gap-1 text-[9px] font-medium px-2 py-0.5 rounded-md transition-all duration-300 hover:scale-105 whitespace-nowrap cursor-pointer hover:brightness-110"]),style:Qe(lt(t.status)),onClick:h=>Rt(t,h),title:"Clique para alterar o status"},[a[48]||(a[48]=e("div",{class:"w-1 h-1 rounded-full bg-current opacity-70 flex-shrink-0"},null,-1)),e("span",Wd,I(t.status),1)],14,Kd)])])]))),128))]),Ge.value.length===0?(l(),i("div",Hd," Sem registros ")):w("",!0)]),e("div",Xd,[e("table",Yd,[e("thead",Qd,[e("tr",null,[a[49]||(a[49]=e("th",{class:"px-3 sm:px-6 py-2 sm:py-3"},"Cliente",-1)),k.value?(l(),i("th",Zd,"Valor")):w("",!0),a[50]||(a[50]=e("th",{class:"px-3 sm:px-6 py-2 sm:py-3"},"Etapa",-1)),a[51]||(a[51]=e("th",{class:"px-3 sm:px-6 py-2 sm:py-3"},"Status",-1)),a[52]||(a[52]=e("th",{class:"px-3 sm:px-6 py-2 sm:py-3 text-right"},"Ações",-1))])]),e("tbody",null,[(l(!0),i(se,null,ce(Fe.value,t=>(l(),i("tr",{key:t.id,class:"group border-b border-slate-700 hover:bg-slate-700/50"},[e("td",eu,I(t.name),1),k.value?(l(),i("td",tu," R$ "+I(t.amount.toLocaleString("pt-BR")),1)):w("",!0),e("td",au,I(Ft(t.stageId)),1),e("td",lu,[e("span",{class:M([Et(t.status),"inline-flex items-center gap-1.5 text-xs font-semibold px-2.5 py-1.5 rounded-lg transition-all duration-300 hover:scale-105 whitespace-nowrap cursor-pointer hover:brightness-110"]),style:Qe(lt(t.status)),onClick:h=>Rt(t,h),title:"Clique para alterar o status"},[a[53]||(a[53]=e("div",{class:"w-2 h-2 rounded-full bg-current opacity-70 flex-shrink-0"},null,-1)),e("span",ou,I(t.status),1)],14,su)]),e("td",nu,[e("div",iu,[oe(D)(t,oe(K))?(l(),i("button",{key:0,class:"opacity-0 group-hover:opacity-70 hover:!opacity-100 transition-opacity duration-200 text-slate-400 hover:text-white",title:"Editar controle de acesso",onClick:h=>oe(A)(t)},[...a[54]||(a[54]=[e("i",{class:"fa-solid fa-ellipsis text-sm"},null,-1)])],8,ru)):w("",!0),e("button",{class:"hover:text-white",title:"Ver/Editar",onClick:h=>Je(t)},[...a[55]||(a[55]=[e("i",{class:"fa-regular fa-pen-to-square"},null,-1)])],8,du),e("button",{class:"hover:text-white",title:"Mover",onClick:h=>Pt(t)},[...a[56]||(a[56]=[e("i",{class:"fa-solid fa-arrow-right-arrow-left"},null,-1)])],8,uu),e("button",{class:"text-red-400 hover:text-red-300",title:"Excluir",onClick:h=>It(t)},[...a[57]||(a[57]=[e("i",{class:"fa-regular fa-trash-can"},null,-1)])],8,cu)])])]))),128))])])])]))])],64)):(l(),i("div",pu,[...a[58]||(a[58]=[e("div",{class:"w-16 h-16 rounded-full bg-slate-800/70 border border-slate-700/60 flex items-center justify-center"},[e("i",{class:"fa-solid fa-lock text-2xl text-slate-400"})],-1),e("h2",{class:"text-lg font-semibold text-slate-100"}," Acesso restrito a esta esteira ",-1),e("p",{class:"max-w-md text-sm text-slate-400"}," Você ainda não foi adicionado aos usuários autorizados para acompanhar este processo. Solicite acesso a um administrador para visualizar o fluxo desta esteira. ",-1)])])),Y(ze,{modelValue:Mt.value,"onUpdate:modelValue":a[22]||(a[22]=t=>Mt.value=t),title:"Novo Registro",size:"xxl","body-class":"new-proposal-modal"},{footer:ve(()=>[e("div",{class:"flex items-center justify-end gap-2"},[e("button",{class:"bg-slate-700 hover:bg-slate-600 text-white px-2 py-1 rounded-md text-xs",onClick:aa}," Cancelar "),e("button",{class:"bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 text-white px-2 py-1 rounded-md text-xs",onClick:Za},[...a[65]||(a[65]=[e("i",{class:"fa-solid fa-check mr-1"},null,-1),T("Salvar ",-1)])])])]),default:ve(()=>[e("div",vu,[e("div",fu,[a[59]||(a[59]=e("h4",{class:"text-sm font-semibold text-slate-200 mb-3"}," Nova Proposta ",-1)),e("div",mu,[e("span",gu,[e("span",{class:M(["w-2 h-4 rounded-full",o.getStageColor(X.value[0]?.id)])},null,2),T(" Etapa: "+I(X.value[0]?.title||"Primeira Etapa"),1)])])]),e("div",bu,[a[60]||(a[60]=e("h4",{class:"text-sm font-semibold text-slate-200 mb-3"}," Campos do Processo ",-1)),e("div",hu,[(l(!0),i(se,null,ce(ye.value,t=>(l(),i(se,{key:t.id},[t.type!=="file"&&t.type!=="endereco"&&t.type!=="pessoa_fisica"?(l(),i("div",xu,[t.type==="text"||t.type==="number"?(l(),de(Se,{key:0,modelValue:le.value[t.id],"onUpdate:modelValue":h=>le.value[t.id]=h,type:(t.type==="number","text"),numeric:t.type==="number",label:t.label,size:"xs",placeholder:t.placeholder||""},null,8,["modelValue","onUpdate:modelValue","type","numeric","label","placeholder"])):t.type==="cpf"?(l(),de(Ht,{key:1,modelValue:le.value[t.id],"onUpdate:modelValue":h=>le.value[t.id]=h,label:t.label,placeholder:t.placeholder||"000.000.000-00",required:t.required,"show-validation-info":!0},null,8,["modelValue","onUpdate:modelValue","label","placeholder","required"])):t.type==="cnpj"?(l(),de(ma,{key:2,modelValue:le.value[t.id],"onUpdate:modelValue":h=>le.value[t.id]=h,label:t.label,placeholder:t.placeholder||"00.000.000/0000-00",required:t.required,"show-validation-info":!0},null,8,["modelValue","onUpdate:modelValue","label","placeholder","required"])):t.type==="rg"?(l(),de(Xt,{key:3,modelValue:le.value[t.id],"onUpdate:modelValue":h=>le.value[t.id]=h,label:t.label,placeholder:t.placeholder||"00.000.000-0",required:t.required,"show-validation-info":!0},null,8,["modelValue","onUpdate:modelValue","label","placeholder","required"])):t.type==="cep"?(l(),de(ga,{key:4,modelValue:le.value[t.id],"onUpdate:modelValue":h=>le.value[t.id]=h,label:t.label,placeholder:t.placeholder||"00000-000",required:t.required,"show-validation-info":!0,"auto-fetch-address":!0},null,8,["modelValue","onUpdate:modelValue","label","placeholder","required"])):t.type==="telefone"?(l(),de(Yt,{key:5,modelValue:le.value[t.id],"onUpdate:modelValue":h=>le.value[t.id]=h,label:t.label,placeholder:t.placeholder||"(00) 00000-0000",required:t.required,"show-validation-info":!0},null,8,["modelValue","onUpdate:modelValue","label","placeholder","required"])):t.type==="date"?(l(),de(Se,{key:6,modelValue:le.value[t.id],"onUpdate:modelValue":h=>le.value[t.id]=h,type:"date",label:t.label,size:"xs"},null,8,["modelValue","onUpdate:modelValue","label"])):t.type==="select"?(l(),de(Wt,{key:7,modelValue:le.value[t.id],"onUpdate:modelValue":h=>le.value[t.id]=h,label:t.label,size:"xs",options:(t.options||[]).map(h=>({label:h,value:h}))},null,8,["modelValue","onUpdate:modelValue","label","options"])):w("",!0),$e.value[t.id]?(l(),i("div",yu,I($e.value[t.id]),1)):w("",!0)])):w("",!0)],64))),128))]),e("div",$u,[(l(!0),i(se,null,ce(ye.value,t=>(l(),i(se,{key:t.id},[t.type==="file"?(l(),i("div",wu,[Y(Jt,{label:t.label,dense:!0},{default:ve(()=>[Y(fa,{onFiles:h=>al(t.id,h)},null,8,["onFiles"])]),_:2},1032,["label"]),$e.value[t.id]?(l(),i("div",ku,I($e.value[t.id]),1)):w("",!0)])):w("",!0)],64))),128))]),e("div",_u,[(l(!0),i(se,null,ce(ye.value,t=>(l(),i(se,{key:t.id},[t.type==="endereco"?(l(),i("div",Vu,[Y(Qt,{modelValue:le.value[t.id],"onUpdate:modelValue":h=>le.value[t.id]=h,label:t.label,required:t.required},null,8,["modelValue","onUpdate:modelValue","label","required"]),$e.value[t.id]?(l(),i("div",Iu,I($e.value[t.id]),1)):w("",!0)])):t.type==="pessoa_fisica"?(l(),i("div",Cu,[Y(vi,{modelValue:le.value[t.id],"onUpdate:modelValue":h=>le.value[t.id]=h,label:t.label,required:t.required},null,8,["modelValue","onUpdate:modelValue","label","required"]),$e.value[t.id]?(l(),i("div",Su,I($e.value[t.id]),1)):w("",!0)])):w("",!0)],64))),128))])]),w("",!0),w("",!0),w("",!0),w("",!0),w("",!0)])]),_:1},8,["modelValue"]),Y(ze,{modelValue:me.value,"onUpdate:modelValue":a[23]||(a[23]=t=>me.value=t),title:"Excluir Registro",size:"sm","z-index":80},{footer:ve(()=>[e("div",{class:"flex items-center justify-end gap-2"},[e("button",{class:"bg-slate-700 hover:bg-slate-600 text-white px-2 py-1 rounded-md text-xs",onClick:Ke}," Cancelar "),e("button",{class:"bg-red-600 hover:bg-red-700 text-white px-2 py-1 rounded-md text-xs",onClick:Ct}," Excluir ")])]),default:ve(()=>[a[66]||(a[66]=e("p",{class:"text-sm text-slate-200"}," Tem certeza que deseja excluir este registro? ",-1))]),_:1},8,["modelValue"]),Y(ze,{modelValue:Ue.value,"onUpdate:modelValue":a[26]||(a[26]=t=>Ue.value=t),title:"Formulário da Etapa",size:"max","z-index":70},{footer:ve(()=>[e("div",Lu,[e("div",Gu,[a[69]||(a[69]=e("label",{class:"text-xs text-slate-300"},"Status:",-1)),e("div",Ju,[ee(e("select",{"onUpdate:modelValue":a[24]||(a[24]=t=>Ne.value=t),class:"bg-slate-800/70 border border-slate-700/60 text-slate-200 rounded-md px-2 py-1 text-xs min-w-[120px] pr-8",onChange:St},[(l(!0),i(se,null,ce(xe.value.length?xe.value:At.value.map(t=>({name:t})),t=>(l(),i("option",{key:t.name||t,value:t.name||t},I(t.name||t),9,Ku))),128))],544),[[rt,Ne.value]]),We(Ne.value)?(l(),i("div",{key:0,class:"absolute right-2 top-1/2 transform -translate-y-1/2 w-2 h-2 rounded-full pointer-events-none",style:Qe({backgroundColor:We(Ne.value)})},null,4)):w("",!0)])]),e("div",Wu,[e("button",{class:"bg-slate-700 hover:bg-slate-600 text-white px-2 py-1 rounded-md text-xs",onClick:a[25]||(a[25]=t=>Ue.value=!1)}," Fechar "),e("button",{class:"bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 text-white px-2 py-1 rounded-md text-xs",onClick:Vt}," Salvar ")])])]),default:ve(()=>[e("div",Pu,[e("div",Au,[e("div",Fu,[a[67]||(a[67]=e("div",{class:"text-[12px] text-slate-300"},"Etapa atual",-1)),e("div",Eu,I(Ft(_e.value?.stageId)),1)]),_e.value?(l(),i("button",{key:0,onClick:Ja,class:"text-slate-400 hover:text-slate-200 flex items-center gap-2 px-2 py-1 rounded-md hover:bg-slate-700/50 transition-colors text-sm ml-4",title:"Ver arquivos do processo"},[a[68]||(a[68]=e("i",{class:"fa-solid fa-folder-open text-sm"},null,-1)),e("span",Bu,I(Ca.value),1)])):w("",!0)]),e("div",Uu,[(l(!0),i(se,null,ce(He.value,t=>(l(),i(se,{key:t.id},[t.type!=="file"&&t.type!=="endereco"&&t.type!=="pessoa_fisica"?(l(),i("div",Du,[t.type==="text"||t.type==="number"?(l(),de(Se,{key:0,modelValue:J.value[t.id],"onUpdate:modelValue":h=>J.value[t.id]=h,type:(t.type==="number","text"),numeric:t.type==="number",label:t.label,size:"xs",placeholder:t.placeholder||""},null,8,["modelValue","onUpdate:modelValue","type","numeric","label","placeholder"])):t.type==="cpf"?(l(),de(Ht,{key:1,modelValue:J.value[t.id],"onUpdate:modelValue":h=>J.value[t.id]=h,label:t.label,placeholder:t.placeholder||"000.000.000-00",required:t.required,"show-validation-info":!0},null,8,["modelValue","onUpdate:modelValue","label","placeholder","required"])):t.type==="cnpj"?(l(),de(ma,{key:2,modelValue:J.value[t.id],"onUpdate:modelValue":h=>J.value[t.id]=h,label:t.label,placeholder:t.placeholder||"00.000.000/0000-00",required:t.required,"show-validation-info":!0},null,8,["modelValue","onUpdate:modelValue","label","placeholder","required"])):t.type==="rg"?(l(),de(Xt,{key:3,modelValue:J.value[t.id],"onUpdate:modelValue":h=>J.value[t.id]=h,label:t.label,placeholder:t.placeholder||"00.000.000-0",required:t.required,"show-validation-info":!0},null,8,["modelValue","onUpdate:modelValue","label","placeholder","required"])):t.type==="cep"?(l(),de(ga,{key:4,modelValue:J.value[t.id],"onUpdate:modelValue":h=>J.value[t.id]=h,label:t.label,placeholder:t.placeholder||"00000-000",required:t.required,"show-validation-info":!0,"auto-fetch-address":!0},null,8,["modelValue","onUpdate:modelValue","label","placeholder","required"])):t.type==="telefone"?(l(),de(Yt,{key:5,modelValue:J.value[t.id],"onUpdate:modelValue":h=>J.value[t.id]=h,label:t.label,placeholder:t.placeholder||"(00) 00000-0000",required:t.required,"show-validation-info":!0},null,8,["modelValue","onUpdate:modelValue","label","placeholder","required"])):t.type==="date"?(l(),de(Se,{key:6,modelValue:J.value[t.id],"onUpdate:modelValue":h=>J.value[t.id]=h,type:"date",label:t.label,size:"xs"},null,8,["modelValue","onUpdate:modelValue","label"])):t.type==="select"?(l(),de(Wt,{key:7,modelValue:J.value[t.id],"onUpdate:modelValue":h=>J.value[t.id]=h,label:t.label,size:"xs",options:(t.options||[]).map(h=>({label:h,value:h}))},null,8,["modelValue","onUpdate:modelValue","label","options"])):w("",!0)])):w("",!0)],64))),128))]),e("div",Nu,[(l(!0),i(se,null,ce(He.value,t=>(l(),i(se,{key:t.id},[t.type==="file"?(l(),i("div",Mu,[Y(Jt,{label:t.label,dense:!0},{default:ve(()=>[Y(fa,{onFiles:h=>ll(t.id,h)},null,8,["onFiles"])]),_:2},1032,["label"])])):t.type==="endereco"?(l(),i("div",zu,[Y(Qt,{modelValue:J.value[t.id],"onUpdate:modelValue":h=>J.value[t.id]=h,label:t.label,required:t.required,"auto-fill-from-cep":!0},null,8,["modelValue","onUpdate:modelValue","label","required"])])):t.type==="pessoa_fisica"?(l(),i("div",qu,[Y(Jt,{label:t.label,dense:!0},{default:ve(()=>[e("div",Ru,[e("button",{type:"button",class:"bg-slate-700 hover:bg-slate-600 text-white px-2 py-1 rounded-md text-xs",onClick:h=>nl(t.id)}," Preencher Pessoa Física ",8,Tu),J.value[t.id]?(l(),i("span",Ou,"Preenchido")):(l(),i("span",ju,"Não preenchido"))])]),_:2},1032,["label"])])):w("",!0)],64))),128))])])]),_:1},8,["modelValue"]),Y(ps,{show:Tt.value,"onUpdate:show":a[27]||(a[27]=t=>Tt.value=t),messages:Me.value,typing:Ot.value,title:"ConsorIA",size:"sm",onSend:rl},null,8,["show","messages","typing"]),Y(ze,{modelValue:Ae.value,"onUpdate:modelValue":a[29]||(a[29]=t=>Ae.value=t),title:"Pesquisar",size:"sm","z-index":80},{default:ve(()=>[Y(b,{modelValue:he.value,"onUpdate:modelValue":a[28]||(a[28]=t=>he.value=t),"persist-on-click":!1},null,8,["modelValue"])]),_:1},8,["modelValue"]),Y(Va,{show:u.value,initialData:C.value?J.value[C.value]||{}:{},onClose:na,onSubmit:il},null,8,["show","initialData"]),Y($r,{show:Ce.value,"process-key":_e.value?.processExternalId||c.value,files:oe(je),onClose:a[30]||(a[30]=t=>Ce.value=!1),onRefresh:Ka,onApproveFile:Wa,onRejectFile:Ha,onDownloadFile:Xa},null,8,["show","process-key","files"]),Y(ad,{modelValue:oe(f),"onUpdate:modelValue":a[31]||(a[31]=t=>hl(f)?f.value=t:null),proposal:oe(V),"available-users":oe(R),onSave:fe,onClose:oe(E)},null,8,["modelValue","proposal","available-users","onClose"]),(l(),de(xa,{to:"body"},[Y(ha,{"enter-active-class":"transition-all duration-300 ease-out","enter-from-class":"opacity-0 scale-95 translate-y-2","enter-to-class":"opacity-100 scale-100 translate-y-0","leave-active-class":"transition-all duration-200 ease-in","leave-from-class":"opacity-100 scale-100 translate-y-0","leave-to-class":"opacity-0 scale-95 translate-y-2"},{default:ve(()=>[ne.value?(l(),i("div",{key:0,class:"fixed inset-0 z-50",onClick:oa},[e("div",{class:"absolute bg-slate-900/90 backdrop-blur-xl border border-white/20 rounded-lg shadow-xl w-auto min-w-[140px] touch-manipulation",style:Qe({top:be.value.top+"px",left:be.value.left+"px"}),onClick:a[33]||(a[33]=ke(()=>{},["stop"])),onTouchstartPassive:a[34]||(a[34]=()=>{})},[a[70]||(a[70]=e("div",{class:"absolute inset-0 bg-gradient-to-br from-slate-800/40 to-slate-900/60 rounded-lg"},null,-1)),e("div",Hu,[e("div",Xu,[(l(!0),i(se,null,ce(xe.value,t=>(l(),i("button",{key:t.name,disabled:t.name===ie.value?.status||De.value,class:M(["group relative w-full px-2 py-1.5 rounded transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed touch-manipulation min-h-[32px] active:scale-95 flex items-center justify-start",[t.name===ie.value?.status?"bg-white/10 cursor-not-allowed":"hover:bg-white/10 active:bg-white/15"]]),onClick:h=>sl(t.name),onTouchstartPassive:a[32]||(a[32]=()=>{})},[e("div",{class:"w-2 h-2 rounded-full mr-2 flex-shrink-0 transition-all duration-300",style:Qe({backgroundColor:t.color,boxShadow:`0 0 6px ${t.color}, 0 0 12px ${t.color}40, inset 0 0 3px ${t.color}80`})},null,4),e("span",{class:M(["text-[9px] font-medium text-white whitespace-nowrap",t.name===ie.value?.status?"opacity-60":""])},I(t.name),3)],42,Yu))),128))])])],36)])):w("",!0)]),_:1})]))])}}},gc=qe(Qu,[["__scopeId","data-v-6989ece0"]]);export{gc as default};
